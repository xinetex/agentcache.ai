<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Legal Analytics Dashboard - Case law intelligence with SOC 2 compliance">
  <title>Legal Analytics - AgentCache</title>
  
  <!-- CDN Resources -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.2/anime.min.js"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://d3js.org/d3-sankey.v0.12.min.js"></script>
  
  <!-- AgentCache Viz Library -->
  <script src="/js/visualizations/agentcache-viz.js"></script>
  
  <style>
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    
    .skeleton {
      animation: shimmer 2s infinite linear;
      background: linear-gradient(to right, #1e293b 4%, #334155 25%, #1e293b 36%);
      background-size: 1000px 100%;
    }
    
    .metric-card {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .metric-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
    }
    
    @keyframes pulse-ring {
      0% { transform: scale(0.95); opacity: 1; }
      50% { transform: scale(1); opacity: 0.7; }
      100% { transform: scale(0.95); opacity: 1; }
    }
    
    .alert-pulse {
      animation: pulse-ring 2s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite;
    }
    
    .status-glow {
      box-shadow: 0 0 10px currentColor;
    }
    
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #0f172a;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #334155;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #475569;
    }
  </style>
</head>

<body class="min-h-screen bg-slate-950 text-slate-100 antialiased">
  <div class="flex min-h-screen w-full">
    
    <!-- Sidebar -->
    <aside class="hidden lg:flex lg:flex-col lg:w-64 border-r border-slate-800/80 bg-slate-950/90 backdrop-blur">
      <div class="flex items-center justify-between px-6 py-5 border-b border-slate-800/80">
        <div class="flex items-center gap-2">
          <div class="h-7 w-7 rounded-md bg-sky-500/20 border border-sky-400/40 flex items-center justify-center">
            <span class="text-sm font-semibold tracking-tight text-sky-300">AC</span>
          </div>
          <div class="flex flex-col">
            <span class="text-base font-semibold text-slate-50 tracking-tight">AgentCache</span>
            <span class="text-xs font-medium text-slate-500 tracking-tight">Legal Analytics</span>
          </div>
        </div>
      </div>

      <nav class="flex-1 overflow-y-auto">
        <div class="px-3 pt-4 pb-6 space-y-2 text-sm">
          <div class="px-3 text-[0.7rem] font-medium uppercase tracking-[0.16em] text-slate-500">Navigation</div>
          
          <a href="/dashboard.html" class="flex items-center gap-2.5 rounded-md px-3 py-2.5 text-sm text-slate-400 hover:bg-slate-900/80 hover:text-slate-100">
            <i data-lucide="layout-dashboard" class="w-4 h-4 stroke-[1.5]"></i>
            <span>Main Dashboard</span>
          </a>
          
          <a href="/dashboards/healthcare.html" class="flex items-center gap-2.5 rounded-md px-3 py-2.5 text-sm text-slate-400 hover:bg-slate-900/80 hover:text-slate-100">
            <i data-lucide="heart-pulse" class="w-4 h-4 stroke-[1.5]"></i>
            <span>Healthcare</span>
          </a>
          
          <a href="/dashboards/finance.html" class="flex items-center gap-2.5 rounded-md px-3 py-2.5 text-sm text-slate-400 hover:bg-slate-900/80 hover:text-slate-100">
            <i data-lucide="trending-up" class="w-4 h-4 stroke-[1.5]"></i>
            <span>Finance</span>
          </a>
          
          <a href="/dashboards/legal.html" class="flex items-center gap-2.5 rounded-md px-3 py-2.5 text-sm font-medium bg-slate-900 text-slate-50">
            <i data-lucide="scale" class="w-4 h-4 stroke-[1.5] text-amber-300"></i>
            <span>Legal</span>
          </a>
        </div>

        <div class="px-3 pt-2 pb-6 space-y-2 text-sm">
          <div class="px-3 text-[0.7rem] font-medium uppercase tracking-[0.16em] text-slate-500">Compliance</div>
          
          <div class="px-3 py-2 rounded-md bg-emerald-500/10 border border-emerald-500/30">
            <div class="flex items-center gap-2 mb-1">
              <div class="h-2 w-2 rounded-full bg-emerald-400 status-glow"></div>
              <span class="text-xs font-semibold text-emerald-300">SOC 2 Type II</span>
            </div>
            <p class="text-xs text-slate-400">Data security verified</p>
          </div>
          
          <div class="px-3 py-2 rounded-md bg-sky-500/10 border border-sky-500/30">
            <div class="flex items-center gap-2 mb-1">
              <div class="h-2 w-2 rounded-full bg-sky-400 status-glow"></div>
              <span class="text-xs font-semibold text-sky-300">Attorney-Client</span>
            </div>
            <p class="text-xs text-slate-400">Privilege protected</p>
          </div>
          
          <div class="px-3 py-2 rounded-md bg-purple-500/10 border border-purple-500/30">
            <div class="flex items-center gap-2 mb-1">
              <div class="h-2 w-2 rounded-full bg-purple-400 status-glow"></div>
              <span class="text-xs font-semibold text-purple-300">Work Product</span>
            </div>
            <p class="text-xs text-slate-400">Doctrine compliant</p>
          </div>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col overflow-hidden">
      
      <!-- Header -->
      <header class="sticky top-0 z-20 border-b border-slate-800/80 bg-slate-950/80 backdrop-blur">
        <div class="flex items-center justify-between px-6 py-3">
          <div class="flex items-center gap-3">
            <div class="flex items-center gap-2">
              <i data-lucide="scale" class="w-5 h-5 text-amber-400"></i>
              <h1 class="text-xl font-semibold tracking-tight text-slate-50">Legal Analytics</h1>
            </div>
            <span class="inline-flex items-center gap-1 rounded-full bg-emerald-500/10 border border-emerald-500/30 px-2 py-0.5 text-xs font-medium text-emerald-300">
              <span class="h-1.5 w-1.5 rounded-full bg-emerald-400"></span>
              Live Case Data
            </span>
          </div>

          <div class="flex items-center gap-3">
            <select id="timeRange" class="rounded-md border border-slate-800 bg-slate-900/80 px-3 py-1.5 text-sm text-slate-100 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500/50">
              <option value="1d">Last 24 Hours</option>
              <option value="1w" selected>Last Week</option>
              <option value="1m">Last Month</option>
              <option value="1q">Last Quarter</option>
            </select>
            
            <button onclick="refreshDashboard()" class="inline-flex items-center gap-1.5 rounded-md border border-slate-800 bg-slate-900/80 hover:bg-slate-900 px-3 py-1.5 text-sm font-medium text-slate-100">
              <i data-lucide="refresh-cw" class="w-4 h-4"></i>
              Refresh
            </button>
            
            <button onclick="exportReport()" class="inline-flex items-center gap-1.5 rounded-md bg-sky-600 px-4 py-1.5 text-sm font-semibold text-white hover:bg-sky-500">
              <i data-lucide="download" class="w-4 h-4"></i>
              Export
            </button>
          </div>
        </div>
      </header>

      <!-- Content -->
      <main class="flex-1 overflow-y-auto p-6 space-y-6">
        
        <!-- Critical Alerts -->
        <div id="alertsContainer" class="hidden">
          <!-- Alerts will be dynamically added here -->
        </div>

        <!-- Tier 1 Metrics - Mission Critical -->
        <section>
          <h2 class="text-lg font-semibold text-slate-50 mb-4">Mission Critical Metrics</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            
            <!-- Case Law Accuracy -->
            <div class="metric-card rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xs uppercase tracking-wide text-slate-500">Case Law Accuracy</span>
                <i data-lucide="gavel" class="w-4 h-4 text-amber-400"></i>
              </div>
              <div id="caseLawAccuracy" class="text-4xl font-bold text-slate-50">0%</div>
              <div class="mt-2 flex items-center gap-2">
                <span class="text-xs text-emerald-400">Westlaw/LexisNexis verified</span>
                <div class="flex-1 h-1.5 bg-slate-800 rounded-full overflow-hidden">
                  <div class="h-full bg-amber-500 rounded-full" style="width: 98%"></div>
                </div>
              </div>
            </div>

            <!-- Citation Freshness -->
            <div class="metric-card rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xs uppercase tracking-wide text-slate-500">Citation Freshness</span>
                <i data-lucide="book-open" class="w-4 h-4 text-sky-400"></i>
              </div>
              <div id="citationFreshness" class="text-4xl font-bold text-slate-50">0 hrs</div>
              <div class="mt-2 flex items-center gap-2">
                <span class="text-xs text-sky-400">Updated daily</span>
                <span class="text-xs text-slate-500">• Shepardized</span>
              </div>
            </div>

            <!-- Privilege Protection -->
            <div class="metric-card rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xs uppercase tracking-wide text-slate-500">Privilege Protection</span>
                <i data-lucide="shield-check" class="w-4 h-4 text-emerald-400"></i>
              </div>
              <div id="privilegeProtection" class="text-4xl font-bold text-slate-50">0%</div>
              <div class="mt-2 flex items-center gap-2">
                <span class="text-xs text-emerald-400">Attorney-client privilege maintained</span>
              </div>
            </div>

            <!-- Conflict Check Coverage -->
            <div class="metric-card rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xs uppercase tracking-wide text-slate-500">Conflict Checks</span>
                <i data-lucide="alert-triangle" class="w-4 h-4 text-rose-400"></i>
              </div>
              <div id="conflictChecks" class="text-4xl font-bold text-slate-50">0</div>
              <div class="mt-2 flex items-center gap-2">
                <span class="text-xs text-rose-400">Flagged: <span id="conflictsFlagged">0</span></span>
              </div>
            </div>

            <!-- Billable Hours Accuracy -->
            <div class="metric-card rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xs uppercase tracking-wide text-slate-500">Billable Tracking</span>
                <i data-lucide="clock" class="w-4 h-4 text-purple-400"></i>
              </div>
              <div id="billableAccuracy" class="text-4xl font-bold text-slate-50">0%</div>
              <div class="mt-2 flex items-center gap-2">
                <span class="text-xs text-purple-400">Automated time capture</span>
              </div>
            </div>

            <!-- Cost Savings -->
            <div class="metric-card rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center justify-between mb-2">
                <span class="text-xs uppercase tracking-wide text-slate-500">Research Cost Savings</span>
                <i data-lucide="dollar-sign" class="w-4 h-4 text-green-400"></i>
              </div>
              <div id="costSavings" class="text-4xl font-bold text-slate-50">$0</div>
              <div class="mt-2 flex items-center gap-2">
                <span class="text-xs text-emerald-400">↓ 82% vs manual research</span>
                <span class="text-xs text-slate-500">• 47 hrs saved</span>
              </div>
            </div>

          </div>
        </section>

        <!-- Case Law Citation Network -->
        <section>
          <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="text-lg font-semibold text-slate-50">Case Law Citation Network</h2>
              <span class="text-xs text-slate-500">Precedent relationship mapping</span>
            </div>
            <div id="citationNetwork" class="w-full" style="min-height: 400px;"></div>
          </div>
        </section>

        <!-- Practice Area Performance -->
        <section>
          <h2 class="text-lg font-semibold text-slate-50 mb-4">Practice Area Intelligence</h2>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            
            <!-- Cache Hit Rate by Practice Area -->
            <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-6">
              <h3 class="text-base font-semibold text-slate-100 mb-4">Cache Hit Rate by Practice Area</h3>
              <div class="space-y-3">
                <div>
                  <div class="flex items-center justify-between text-sm mb-1">
                    <span class="text-slate-300">Corporate</span>
                    <span class="font-semibold text-emerald-400">96%</span>
                  </div>
                  <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                    <div class="h-full bg-emerald-500 rounded-full" style="width: 96%"></div>
                  </div>
                </div>
                <div>
                  <div class="flex items-center justify-between text-sm mb-1">
                    <span class="text-slate-300">Litigation</span>
                    <span class="font-semibold text-sky-400">93%</span>
                  </div>
                  <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                    <div class="h-full bg-sky-500 rounded-full" style="width: 93%"></div>
                  </div>
                </div>
                <div>
                  <div class="flex items-center justify-between text-sm mb-1">
                    <span class="text-slate-300">IP/Patent</span>
                    <span class="font-semibold text-purple-400">91%</span>
                  </div>
                  <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                    <div class="h-full bg-purple-500 rounded-full" style="width: 91%"></div>
                  </div>
                </div>
                <div>
                  <div class="flex items-center justify-between text-sm mb-1">
                    <span class="text-slate-300">Tax</span>
                    <span class="font-semibold text-amber-400">89%</span>
                  </div>
                  <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                    <div class="h-full bg-amber-500 rounded-full" style="width: 89%"></div>
                  </div>
                </div>
                <div>
                  <div class="flex items-center justify-between text-sm mb-1">
                    <span class="text-slate-300">Employment</span>
                    <span class="font-semibold text-rose-400">88%</span>
                  </div>
                  <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                    <div class="h-full bg-rose-500 rounded-full" style="width: 88%"></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Query Response Time -->
            <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-6">
              <h3 class="text-base font-semibold text-slate-100 mb-4">Research Query Latency (s)</h3>
              <div id="latencyChart" class="w-full" style="height: 240px;"></div>
            </div>

          </div>
        </section>

        <!-- Legal Intelligence Dashboard -->
        <section>
          <h2 class="text-lg font-semibold text-slate-50 mb-4">Legal Operations Intelligence</h2>
          <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
            
            <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center gap-3 mb-3">
                <div class="h-10 w-10 rounded-lg bg-amber-500/20 flex items-center justify-center">
                  <i data-lucide="file-text" class="w-5 h-5 text-amber-400"></i>
                </div>
                <div>
                  <div class="text-2xl font-bold text-slate-50" id="documentsProcessed">0</div>
                  <div class="text-xs text-slate-500">Documents Analyzed</div>
                </div>
              </div>
              <div class="text-xs text-amber-400">This week</div>
            </div>

            <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center gap-3 mb-3">
                <div class="h-10 w-10 rounded-lg bg-sky-500/20 flex items-center justify-center">
                  <i data-lucide="search" class="w-5 h-5 text-sky-400"></i>
                </div>
                <div>
                  <div class="text-2xl font-bold text-slate-50" id="researchQueries">0</div>
                  <div class="text-xs text-slate-500">Research Queries</div>
                </div>
              </div>
              <div class="text-xs text-sky-400">Last 7 days</div>
            </div>

            <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center gap-3 mb-3">
                <div class="h-10 w-10 rounded-lg bg-purple-500/20 flex items-center justify-center">
                  <i data-lucide="users" class="w-5 h-5 text-purple-400"></i>
                </div>
                <div>
                  <div class="text-2xl font-bold text-slate-50" id="attorneyAdoption">0%</div>
                  <div class="text-xs text-slate-500">Attorney Adoption</div>
                </div>
              </div>
              <div class="text-xs text-purple-400">Active users</div>
            </div>

            <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-5">
              <div class="flex items-center gap-3 mb-3">
                <div class="h-10 w-10 rounded-lg bg-emerald-500/20 flex items-center justify-center">
                  <i data-lucide="trending-up" class="w-5 h-5 text-emerald-400"></i>
                </div>
                <div>
                  <div class="text-2xl font-bold text-slate-50" id="timeEfficiency">0%</div>
                  <div class="text-xs text-slate-500">Time Efficiency Gain</div>
                </div>
              </div>
              <div class="text-xs text-emerald-400">vs traditional research</div>
            </div>

          </div>
        </section>

        <!-- Legal Database Integration Health -->
        <section>
          <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="text-lg font-semibold text-slate-50">Legal Database Health</h2>
              <span class="inline-flex items-center gap-1 rounded-full bg-emerald-500/10 border border-emerald-500/30 px-2 py-0.5 text-xs font-medium text-emerald-300">
                <i data-lucide="check-circle" class="w-3 h-3"></i>
                8/8 Active
              </span>
            </div>
            <div id="databaseNetwork" class="w-full" style="min-height: 350px;"></div>
          </div>
        </section>

        <!-- Jurisdiction Coverage Heatmap -->
        <section>
          <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="text-lg font-semibold text-slate-50">Jurisdiction Coverage</h2>
              <span class="text-xs text-slate-500">Cache hit rate by jurisdiction</span>
            </div>
            <div id="jurisdictionHeatmap" class="w-full" style="min-height: 300px;"></div>
          </div>
        </section>

        <!-- Live Activity Feed -->
        <section>
          <div class="rounded-lg border border-slate-800 bg-slate-950/60 p-6">
            <h2 class="text-lg font-semibold text-slate-50 mb-4">Live Research Activity</h2>
            <div id="activityFeed" class="space-y-2 max-h-96 overflow-y-auto">
              <!-- Activity items will be added here -->
            </div>
          </div>
        </section>

      </main>
    </div>
  </div>

  <script>
    // Initialize Lucide icons
    lucide.createIcons();

    // Simulated legal data
    const legalData = {
      caseLawAccuracy: 98.4,
      citationFreshness: 6.2,
      privilegeProtection: 100,
      conflictChecks: 1847,
      conflictsFlagged: 23,
      billableAccuracy: 97.8,
      costSavings: 124500,
      documentsProcessed: 3482,
      researchQueries: 8934,
      attorneyAdoption: 91.7,
      timeEfficiency: 76.3,
      
      citationNetwork: {
        nodes: [
          { id: 'precedent1', label: 'Roe v. Wade', group: 0, value: 100 },
          { id: 'precedent2', label: 'Brown v. Board', group: 0, value: 95 },
          { id: 'current', label: 'Current Case', group: 1, value: 90 },
          { id: 'cite1', label: 'Miranda v. Arizona', group: 2, value: 85 },
          { id: 'cite2', label: 'Gideon v. Wainwright', group: 2, value: 80 },
          { id: 'cite3', label: 'Marbury v. Madison', group: 2, value: 75 },
          { id: 'cite4', label: 'District Court', group: 3, value: 70 }
        ],
        links: [
          { source: 'precedent1', target: 'current', value: 8 },
          { source: 'precedent2', target: 'current', value: 7 },
          { source: 'current', target: 'cite1', value: 6 },
          { source: 'current', target: 'cite2', value: 5 },
          { source: 'cite1', target: 'cite3', value: 4 },
          { source: 'cite2', target: 'cite4', value: 3 }
        ]
      },
      
      databaseNetwork: {
        nodes: [
          { id: 'cache', label: 'AgentCache', group: 0, value: 100 },
          { id: 'westlaw', label: 'Westlaw', group: 1, value: 90 },
          { id: 'lexis', label: 'LexisNexis', group: 1, value: 85 },
          { id: 'pacer', label: 'PACER', group: 1, value: 80 },
          { id: 'courtlistener', label: 'CourtListener', group: 1, value: 75 },
          { id: 'fastcase', label: 'Fastcase', group: 1, value: 70 },
          { id: 'casetext', label: 'Casetext', group: 1, value: 65 }
        ],
        links: [
          { source: 'westlaw', target: 'cache', value: 8 },
          { source: 'lexis', target: 'cache', value: 7 },
          { source: 'pacer', target: 'cache', value: 6 },
          { source: 'courtlistener', target: 'cache', value: 5 },
          { source: 'fastcase', target: 'cache', value: 4 },
          { source: 'casetext', target: 'cache', value: 3 }
        ]
      },
      
      latencyData: generateTimeSeriesData(7),
      
      jurisdictionData: [
        { x: 'Federal', y: 'Circuit 1', value: 97 },
        { x: 'Federal', y: 'Circuit 9', value: 95 },
        { x: 'Federal', y: 'SCOTUS', value: 100 },
        { x: 'NY', y: 'Court of Appeals', value: 94 },
        { x: 'CA', y: 'Supreme Court', value: 96 },
        { x: 'TX', y: 'Supreme Court', value: 93 },
        { x: 'IL', y: 'Appellate', value: 91 },
        { x: 'MA', y: 'Supreme Judicial', value: 92 }
      ]
    };

    function generateTimeSeriesData(days) {
      const data = [];
      const now = new Date();
      for (let i = days; i >= 0; i--) {
        data.push({
          time: new Date(now - i * 86400000),
          value: 0.8 + Math.random() * 0.6
        });
      }
      return data;
    }

    // Initialize dashboard
    document.addEventListener('DOMContentLoaded', () => {
      initializeDashboard();
      startActivityFeed();
      
      // Animate metric cards entrance
      AgentCacheViz.animateCardsEntrance('.metric-card');
    });

    function initializeDashboard() {
      // Animate count-up metrics
      AgentCacheViz.animateCountUp('caseLawAccuracy', legalData.caseLawAccuracy, 2000, '%');
      AgentCacheViz.animateCountUp('privilegeProtection', legalData.privilegeProtection, 2000, '%');
      AgentCacheViz.animateCountUp('conflictChecks', legalData.conflictChecks, 1500);
      AgentCacheViz.animateCountUp('conflictsFlagged', legalData.conflictsFlagged, 1500);
      AgentCacheViz.animateCountUp('billableAccuracy', legalData.billableAccuracy, 2000, '%');
      AgentCacheViz.animateCountUp('documentsProcessed', legalData.documentsProcessed, 2000);
      AgentCacheViz.animateCountUp('researchQueries', legalData.researchQueries, 2500);
      AgentCacheViz.animateCountUp('attorneyAdoption', legalData.attorneyAdoption, 2000, '%');
      AgentCacheViz.animateCountUp('timeEfficiency', legalData.timeEfficiency, 2000, '%');
      
      // Citation freshness
      setTimeout(() => {
        document.getElementById('citationFreshness').textContent = legalData.citationFreshness.toFixed(1) + ' hrs';
        document.getElementById('costSavings').textContent = '$' + (legalData.costSavings / 1000).toFixed(0) + 'K';
      }, 1500);
      
      // Create citation network
      setTimeout(() => {
        AgentCacheViz.createNetworkGraph(
          'citationNetwork',
          legalData.citationNetwork.nodes,
          legalData.citationNetwork.links,
          { height: 400 }
        );
      }, 500);
      
      // Create latency chart
      setTimeout(() => {
        AgentCacheViz.createTimeSeriesChart(
          'latencyChart',
          legalData.latencyData,
          { height: 240 }
        );
      }, 800);
      
      // Create database network
      setTimeout(() => {
        AgentCacheViz.createNetworkGraph(
          'databaseNetwork',
          legalData.databaseNetwork.nodes,
          legalData.databaseNetwork.links,
          { height: 350 }
        );
      }, 1200);
      
      // Create jurisdiction heatmap
      setTimeout(() => {
        AgentCacheViz.createHeatmap(
          'jurisdictionHeatmap',
          legalData.jurisdictionData,
          { height: 300 }
        );
      }, 1600);
    }

    // Live activity feed
    const activities = [
      { icon: 'check-circle', text: 'Cache hit: SCOTUS precedent search', color: 'emerald', time: 'now' },
      { icon: 'book-open', text: 'Citation verified: 42 U.S.C. § 1983', color: 'sky', time: '3s ago' },
      { icon: 'shield', text: 'Privilege check: Attorney work product', color: 'purple', time: '7s ago' },
      { icon: 'alert-triangle', text: 'Conflict flagged: Opposing party match', color: 'amber', time: '12s ago' },
      { icon: 'gavel', text: 'Case law update: Circuit split resolved', color: 'rose', time: '18s ago' },
      { icon: 'file-text', text: 'Document analyzed: Motion to dismiss', color: 'slate', time: '24s ago' }
    ];

    function startActivityFeed() {
      const feed = document.getElementById('activityFeed');
      
      function addActivity() {
        const activity = activities[Math.floor(Math.random() * activities.length)];
        const item = document.createElement('div');
        item.className = 'flex items-center gap-3 p-3 rounded-md border border-slate-800 bg-slate-900/50 opacity-0';
        item.innerHTML = `
          <i data-lucide="${activity.icon}" class="w-4 h-4 text-${activity.color}-400 flex-shrink-0"></i>
          <div class="flex-1">
            <div class="text-sm text-slate-200">${activity.text}</div>
            <div class="text-xs text-slate-500">${new Date().toLocaleTimeString()}</div>
          </div>
        `;
        
        feed.insertBefore(item, feed.firstChild);
        lucide.createIcons();
        
        // Animate entrance
        anime({
          targets: item,
          opacity: [0, 1],
          translateX: [-20, 0],
          duration: 400,
          easing: 'easeOutCubic'
        });
        
        // Keep only last 10 items
        if (feed.children.length > 10) {
          feed.removeChild(feed.lastChild);
        }
      }
      
      // Initial activities
      for (let i = 0; i < 5; i++) {
        setTimeout(() => addActivity(), i * 500);
      }
      
      // Add new activity every 3 seconds
      setInterval(addActivity, 3000);
    }

    function refreshDashboard() {
      console.log('[Legal Dashboard] Refreshing data...');
      
      const btn = event.target.closest('button');
      btn.disabled = true;
      anime({
        targets: btn.querySelector('svg'),
        rotate: '1turn',
        duration: 800,
        easing: 'easeInOutQuad',
        complete: () => {
          btn.disabled = false;
        }
      });
    }

    function exportReport() {
      const report = {
        timestamp: new Date().toISOString(),
        sector: 'Legal',
        metrics: legalData,
        compliance: {
          soc2_type2: true,
          attorney_client_privilege: true,
          work_product_doctrine: true,
          bar_rules_compliant: true
        }
      };
      
      const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `legal-analytics-${Date.now()}.json`;
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
