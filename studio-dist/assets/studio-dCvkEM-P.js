import{u as Oc,R as X,r as Lc,a as F,j as h,M as zc,b as Bc,c as Gc,U as Hc,S as Vc,d as $o,e as Wc,C as fn,V as Xo,f as $c,g as Tr,I as Xc,h as Yc,B as $a,i as qc,T as Kc,L as Di,k as Zc,l as Ri,D as Jc,P as Yo,m as Qc,_ as el,n as tl,o as nl,O as rl,p as Xa,A as Ya,q as ol}from"./Stars-DKHvTZY6.js";function We(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let o=0,a;o<e.length;o++)(a=We(e[o]))!==""&&(t+=(t&&" ")+a);else for(let o in e)e[o]&&(t+=(t&&" ")+o);return t}const il={},Ii=e=>{let t;const o=new Set,a=(u,d)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const p=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),o.forEach(y=>y(t,p))}},r=()=>t,s={setState:a,getState:r,getInitialState:()=>l,subscribe:u=>(o.add(u),()=>o.delete(u)),destroy:()=>{(il?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),o.clear()}},l=t=e(a,r,s);return s},al=e=>e?Ii(e):Ii,{useDebugValue:sl}=X,{useSyncExternalStoreWithSelector:cl}=Oc,ll=e=>e;function qa(e,t=ll,o){const a=cl(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,o);return sl(a),a}const Ui=(e,t)=>{const o=al(e),a=(r,n=t)=>qa(o,r,n);return Object.assign(a,o),a},ul=(e,t)=>e?Ui(e,t):Ui;function Be(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[a,r]of e)if(!Object.is(r,t.get(a)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const a of e)if(!t.has(a))return!1;return!0}const o=Object.keys(e);if(o.length!==Object.keys(t).length)return!1;for(const a of o)if(!Object.prototype.hasOwnProperty.call(t,a)||!Object.is(e[a],t[a]))return!1;return!0}var dl={value:()=>{}};function Lr(){for(var e=0,t=arguments.length,o={},a;e<t;++e){if(!(a=arguments[e]+"")||a in o||/[\s.]/.test(a))throw new Error("illegal type: "+a);o[a]=[]}return new Sr(o)}function Sr(e){this._=e}function fl(e,t){return e.trim().split(/^|\s+/).map(function(o){var a="",r=o.indexOf(".");if(r>=0&&(a=o.slice(r+1),o=o.slice(0,r)),o&&!t.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:a}})}Sr.prototype=Lr.prototype={constructor:Sr,on:function(e,t){var o=this._,a=fl(e+"",o),r,n=-1,i=a.length;if(arguments.length<2){for(;++n<i;)if((r=(e=a[n]).type)&&(r=hl(o[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++n<i;)if(r=(e=a[n]).type)o[r]=ji(o[r],e.name,t);else if(t==null)for(r in o)o[r]=ji(o[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var o in t)e[o]=t[o].slice();return new Sr(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var o=new Array(r),a=0,r,n;a<r;++a)o[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(n=this._[e],a=0,r=n.length;a<r;++a)n[a].value.apply(t,o)},apply:function(e,t,o){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],r=0,n=a.length;r<n;++r)a[r].value.apply(t,o)}};function hl(e,t){for(var o=0,a=e.length,r;o<a;++o)if((r=e[o]).name===t)return r.value}function ji(e,t,o){for(var a=0,r=e.length;a<r;++a)if(e[a].name===t){e[a]=dl,e=e.slice(0,a).concat(e.slice(a+1));break}return o!=null&&e.push({name:t,value:o}),e}var Eo="http://www.w3.org/1999/xhtml";const Fi={svg:"http://www.w3.org/2000/svg",xhtml:Eo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function zr(e){var t=e+="",o=t.indexOf(":");return o>=0&&(t=e.slice(0,o))!=="xmlns"&&(e=e.slice(o+1)),Fi.hasOwnProperty(t)?{space:Fi[t],local:e}:e}function pl(e){return function(){var t=this.ownerDocument,o=this.namespaceURI;return o===Eo&&t.documentElement.namespaceURI===Eo?t.createElement(e):t.createElementNS(o,e)}}function gl(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ka(e){var t=zr(e);return(t.local?gl:pl)(t)}function ml(){}function qo(e){return e==null?ml:function(){return this.querySelector(e)}}function yl(e){typeof e!="function"&&(e=qo(e));for(var t=this._groups,o=t.length,a=new Array(o),r=0;r<o;++r)for(var n=t[r],i=n.length,c=a[r]=new Array(i),s,l,u=0;u<i;++u)(s=n[u])&&(l=e.call(s,s.__data__,u,n))&&("__data__"in s&&(l.__data__=s.__data__),c[u]=l);return new Je(a,this._parents)}function vl(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function xl(){return[]}function Za(e){return e==null?xl:function(){return this.querySelectorAll(e)}}function _l(e){return function(){return vl(e.apply(this,arguments))}}function bl(e){typeof e=="function"?e=_l(e):e=Za(e);for(var t=this._groups,o=t.length,a=[],r=[],n=0;n<o;++n)for(var i=t[n],c=i.length,s,l=0;l<c;++l)(s=i[l])&&(a.push(e.call(s,s.__data__,l,i)),r.push(s));return new Je(a,r)}function Ja(e){return function(){return this.matches(e)}}function Qa(e){return function(t){return t.matches(e)}}var wl=Array.prototype.find;function Sl(e){return function(){return wl.call(this.children,e)}}function Cl(){return this.firstElementChild}function El(e){return this.select(e==null?Cl:Sl(typeof e=="function"?e:Qa(e)))}var Nl=Array.prototype.filter;function kl(){return Array.from(this.children)}function Al(e){return function(){return Nl.call(this.children,e)}}function Tl(e){return this.selectAll(e==null?kl:Al(typeof e=="function"?e:Qa(e)))}function Ml(e){typeof e!="function"&&(e=Ja(e));for(var t=this._groups,o=t.length,a=new Array(o),r=0;r<o;++r)for(var n=t[r],i=n.length,c=a[r]=[],s,l=0;l<i;++l)(s=n[l])&&e.call(s,s.__data__,l,n)&&c.push(s);return new Je(a,this._parents)}function es(e){return new Array(e.length)}function Pl(){return new Je(this._enter||this._groups.map(es),this._parents)}function Mr(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Mr.prototype={constructor:Mr,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Dl(e){return function(){return e}}function Rl(e,t,o,a,r,n){for(var i=0,c,s=t.length,l=n.length;i<l;++i)(c=t[i])?(c.__data__=n[i],a[i]=c):o[i]=new Mr(e,n[i]);for(;i<s;++i)(c=t[i])&&(r[i]=c)}function Il(e,t,o,a,r,n,i){var c,s,l=new Map,u=t.length,d=n.length,f=new Array(u),p;for(c=0;c<u;++c)(s=t[c])&&(f[c]=p=i.call(s,s.__data__,c,t)+"",l.has(p)?r[c]=s:l.set(p,s));for(c=0;c<d;++c)p=i.call(e,n[c],c,n)+"",(s=l.get(p))?(a[c]=s,s.__data__=n[c],l.delete(p)):o[c]=new Mr(e,n[c]);for(c=0;c<u;++c)(s=t[c])&&l.get(f[c])===s&&(r[c]=s)}function Ul(e){return e.__data__}function jl(e,t){if(!arguments.length)return Array.from(this,Ul);var o=t?Il:Rl,a=this._parents,r=this._groups;typeof e!="function"&&(e=Dl(e));for(var n=r.length,i=new Array(n),c=new Array(n),s=new Array(n),l=0;l<n;++l){var u=a[l],d=r[l],f=d.length,p=Fl(e.call(u,u&&u.__data__,l,a)),y=p.length,m=c[l]=new Array(y),v=i[l]=new Array(y),_=s[l]=new Array(f);o(u,d,m,v,_,p,t);for(var w=0,C=0,x,A;w<y;++w)if(x=m[w]){for(w>=C&&(C=w+1);!(A=v[C])&&++C<y;);x._next=A||null}}return i=new Je(i,a),i._enter=c,i._exit=s,i}function Fl(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ol(){return new Je(this._exit||this._groups.map(es),this._parents)}function Ll(e,t,o){var a=this.enter(),r=this,n=this.exit();return typeof e=="function"?(a=e(a),a&&(a=a.selection())):a=a.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),o==null?n.remove():o(n),a&&r?a.merge(r).order():r}function zl(e){for(var t=e.selection?e.selection():e,o=this._groups,a=t._groups,r=o.length,n=a.length,i=Math.min(r,n),c=new Array(r),s=0;s<i;++s)for(var l=o[s],u=a[s],d=l.length,f=c[s]=new Array(d),p,y=0;y<d;++y)(p=l[y]||u[y])&&(f[y]=p);for(;s<r;++s)c[s]=o[s];return new Je(c,this._parents)}function Bl(){for(var e=this._groups,t=-1,o=e.length;++t<o;)for(var a=e[t],r=a.length-1,n=a[r],i;--r>=0;)(i=a[r])&&(n&&i.compareDocumentPosition(n)^4&&n.parentNode.insertBefore(i,n),n=i);return this}function Gl(e){e||(e=Hl);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var o=this._groups,a=o.length,r=new Array(a),n=0;n<a;++n){for(var i=o[n],c=i.length,s=r[n]=new Array(c),l,u=0;u<c;++u)(l=i[u])&&(s[u]=l);s.sort(t)}return new Je(r,this._parents).order()}function Hl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Vl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Wl(){return Array.from(this)}function $l(){for(var e=this._groups,t=0,o=e.length;t<o;++t)for(var a=e[t],r=0,n=a.length;r<n;++r){var i=a[r];if(i)return i}return null}function Xl(){let e=0;for(const t of this)++e;return e}function Yl(){return!this.node()}function ql(e){for(var t=this._groups,o=0,a=t.length;o<a;++o)for(var r=t[o],n=0,i=r.length,c;n<i;++n)(c=r[n])&&e.call(c,c.__data__,n,r);return this}function Kl(e){return function(){this.removeAttribute(e)}}function Zl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Jl(e,t){return function(){this.setAttribute(e,t)}}function Ql(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function eu(e,t){return function(){var o=t.apply(this,arguments);o==null?this.removeAttribute(e):this.setAttribute(e,o)}}function tu(e,t){return function(){var o=t.apply(this,arguments);o==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,o)}}function nu(e,t){var o=zr(e);if(arguments.length<2){var a=this.node();return o.local?a.getAttributeNS(o.space,o.local):a.getAttribute(o)}return this.each((t==null?o.local?Zl:Kl:typeof t=="function"?o.local?tu:eu:o.local?Ql:Jl)(o,t))}function ts(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ru(e){return function(){this.style.removeProperty(e)}}function ou(e,t,o){return function(){this.style.setProperty(e,t,o)}}function iu(e,t,o){return function(){var a=t.apply(this,arguments);a==null?this.style.removeProperty(e):this.style.setProperty(e,a,o)}}function au(e,t,o){return arguments.length>1?this.each((t==null?ru:typeof t=="function"?iu:ou)(e,t,o??"")):ln(this.node(),e)}function ln(e,t){return e.style.getPropertyValue(t)||ts(e).getComputedStyle(e,null).getPropertyValue(t)}function su(e){return function(){delete this[e]}}function cu(e,t){return function(){this[e]=t}}function lu(e,t){return function(){var o=t.apply(this,arguments);o==null?delete this[e]:this[e]=o}}function uu(e,t){return arguments.length>1?this.each((t==null?su:typeof t=="function"?lu:cu)(e,t)):this.node()[e]}function ns(e){return e.trim().split(/^|\s+/)}function Ko(e){return e.classList||new rs(e)}function rs(e){this._node=e,this._names=ns(e.getAttribute("class")||"")}rs.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function os(e,t){for(var o=Ko(e),a=-1,r=t.length;++a<r;)o.add(t[a])}function is(e,t){for(var o=Ko(e),a=-1,r=t.length;++a<r;)o.remove(t[a])}function du(e){return function(){os(this,e)}}function fu(e){return function(){is(this,e)}}function hu(e,t){return function(){(t.apply(this,arguments)?os:is)(this,e)}}function pu(e,t){var o=ns(e+"");if(arguments.length<2){for(var a=Ko(this.node()),r=-1,n=o.length;++r<n;)if(!a.contains(o[r]))return!1;return!0}return this.each((typeof t=="function"?hu:t?du:fu)(o,t))}function gu(){this.textContent=""}function mu(e){return function(){this.textContent=e}}function yu(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function vu(e){return arguments.length?this.each(e==null?gu:(typeof e=="function"?yu:mu)(e)):this.node().textContent}function xu(){this.innerHTML=""}function _u(e){return function(){this.innerHTML=e}}function bu(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function wu(e){return arguments.length?this.each(e==null?xu:(typeof e=="function"?bu:_u)(e)):this.node().innerHTML}function Su(){this.nextSibling&&this.parentNode.appendChild(this)}function Cu(){return this.each(Su)}function Eu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Nu(){return this.each(Eu)}function ku(e){var t=typeof e=="function"?e:Ka(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Au(){return null}function Tu(e,t){var o=typeof e=="function"?e:Ka(e),a=t==null?Au:typeof t=="function"?t:qo(t);return this.select(function(){return this.insertBefore(o.apply(this,arguments),a.apply(this,arguments)||null)})}function Mu(){var e=this.parentNode;e&&e.removeChild(this)}function Pu(){return this.each(Mu)}function Du(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ru(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Iu(e){return this.select(e?Ru:Du)}function Uu(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ju(e){return function(t){e.call(this,t,this.__data__)}}function Fu(e){return e.trim().split(/^|\s+/).map(function(t){var o="",a=t.indexOf(".");return a>=0&&(o=t.slice(a+1),t=t.slice(0,a)),{type:t,name:o}})}function Ou(e){return function(){var t=this.__on;if(t){for(var o=0,a=-1,r=t.length,n;o<r;++o)n=t[o],(!e.type||n.type===e.type)&&n.name===e.name?this.removeEventListener(n.type,n.listener,n.options):t[++a]=n;++a?t.length=a:delete this.__on}}}function Lu(e,t,o){return function(){var a=this.__on,r,n=ju(t);if(a){for(var i=0,c=a.length;i<c;++i)if((r=a[i]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=n,r.options=o),r.value=t;return}}this.addEventListener(e.type,n,o),r={type:e.type,name:e.name,value:t,listener:n,options:o},a?a.push(r):this.__on=[r]}}function zu(e,t,o){var a=Fu(e+""),r,n=a.length,i;if(arguments.length<2){var c=this.node().__on;if(c){for(var s=0,l=c.length,u;s<l;++s)for(r=0,u=c[s];r<n;++r)if((i=a[r]).type===u.type&&i.name===u.name)return u.value}return}for(c=t?Lu:Ou,r=0;r<n;++r)this.each(c(a[r],t,o));return this}function as(e,t,o){var a=ts(e),r=a.CustomEvent;typeof r=="function"?r=new r(t,o):(r=a.document.createEvent("Event"),o?(r.initEvent(t,o.bubbles,o.cancelable),r.detail=o.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Bu(e,t){return function(){return as(this,e,t)}}function Gu(e,t){return function(){return as(this,e,t.apply(this,arguments))}}function Hu(e,t){return this.each((typeof t=="function"?Gu:Bu)(e,t))}function*Vu(){for(var e=this._groups,t=0,o=e.length;t<o;++t)for(var a=e[t],r=0,n=a.length,i;r<n;++r)(i=a[r])&&(yield i)}var ss=[null];function Je(e,t){this._groups=e,this._parents=t}function Jn(){return new Je([[document.documentElement]],ss)}function Wu(){return this}Je.prototype=Jn.prototype={constructor:Je,select:yl,selectAll:bl,selectChild:El,selectChildren:Tl,filter:Ml,data:jl,enter:Pl,exit:Ol,join:Ll,merge:zl,selection:Wu,order:Bl,sort:Gl,call:Vl,nodes:Wl,node:$l,size:Xl,empty:Yl,each:ql,attr:nu,style:au,property:uu,classed:pu,text:vu,html:wu,raise:Cu,lower:Nu,append:ku,insert:Tu,remove:Pu,clone:Iu,datum:Uu,on:zu,dispatch:Hu,[Symbol.iterator]:Vu};function Qe(e){return typeof e=="string"?new Je([[document.querySelector(e)]],[document.documentElement]):new Je([[e]],ss)}function $u(e){let t;for(;t=e.sourceEvent;)e=t;return e}function at(e,t){if(e=$u(e),t===void 0&&(t=e.currentTarget),t){var o=t.ownerSVGElement||t;if(o.createSVGPoint){var a=o.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,a=a.matrixTransform(t.getScreenCTM().inverse()),[a.x,a.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Xu={passive:!1},Vn={capture:!0,passive:!1};function fo(e){e.stopImmediatePropagation()}function an(e){e.preventDefault(),e.stopImmediatePropagation()}function cs(e){var t=e.document.documentElement,o=Qe(e).on("dragstart.drag",an,Vn);"onselectstart"in t?o.on("selectstart.drag",an,Vn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ls(e,t){var o=e.document.documentElement,a=Qe(e).on("dragstart.drag",null);t&&(a.on("click.drag",an,Vn),setTimeout(function(){a.on("click.drag",null)},0)),"onselectstart"in o?a.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}const ur=e=>()=>e;function No(e,{sourceEvent:t,subject:o,target:a,identifier:r,active:n,x:i,y:c,dx:s,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:o,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:n,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:s,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}No.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Yu(e){return!e.ctrlKey&&!e.button}function qu(){return this.parentNode}function Ku(e,t){return t??{x:e.x,y:e.y}}function Zu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ju(){var e=Yu,t=qu,o=Ku,a=Zu,r={},n=Lr("start","drag","end"),i=0,c,s,l,u,d=0;function f(x){x.on("mousedown.drag",p).filter(a).on("touchstart.drag",v).on("touchmove.drag",_,Xu).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(x,A){if(!(u||!e.call(this,x,A))){var D=C(this,t.call(this,x,A),x,A,"mouse");D&&(Qe(x.view).on("mousemove.drag",y,Vn).on("mouseup.drag",m,Vn),cs(x.view),fo(x),l=!1,c=x.clientX,s=x.clientY,D("start",x))}}function y(x){if(an(x),!l){var A=x.clientX-c,D=x.clientY-s;l=A*A+D*D>d}r.mouse("drag",x)}function m(x){Qe(x.view).on("mousemove.drag mouseup.drag",null),ls(x.view,l),an(x),r.mouse("end",x)}function v(x,A){if(e.call(this,x,A)){var D=x.changedTouches,S=t.call(this,x,A),P=D.length,I,j;for(I=0;I<P;++I)(j=C(this,S,x,A,D[I].identifier,D[I]))&&(fo(x),j("start",x,D[I]))}}function _(x){var A=x.changedTouches,D=A.length,S,P;for(S=0;S<D;++S)(P=r[A[S].identifier])&&(an(x),P("drag",x,A[S]))}function w(x){var A=x.changedTouches,D=A.length,S,P;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),S=0;S<D;++S)(P=r[A[S].identifier])&&(fo(x),P("end",x,A[S]))}function C(x,A,D,S,P,I){var j=n.copy(),H=at(I||D,A),T,U,g;if((g=o.call(x,new No("beforestart",{sourceEvent:D,target:f,identifier:P,active:i,x:H[0],y:H[1],dx:0,dy:0,dispatch:j}),S))!=null)return T=g.x-H[0]||0,U=g.y-H[1]||0,function k(E,B,G){var N=H,R;switch(E){case"start":r[P]=k,R=i++;break;case"end":delete r[P],--i;case"drag":H=at(G||B,A),R=i;break}j.call(E,x,new No(E,{sourceEvent:B,subject:g,target:f,identifier:P,active:R,x:H[0]+T,y:H[1]+U,dx:H[0]-N[0],dy:H[1]-N[1],dispatch:j}),S)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:ur(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:ur(x),f):t},f.subject=function(x){return arguments.length?(o=typeof x=="function"?x:ur(x),f):o},f.touchable=function(x){return arguments.length?(a=typeof x=="function"?x:ur(!!x),f):a},f.on=function(){var x=n.on.apply(n,arguments);return x===n?f:x},f.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,f):Math.sqrt(d)},f}function Zo(e,t,o){e.prototype=t.prototype=o,o.constructor=e}function us(e,t){var o=Object.create(e.prototype);for(var a in t)o[a]=t[a];return o}function Qn(){}var Wn=.7,Pr=1/Wn,sn="\\s*([+-]?\\d+)\\s*",$n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ht="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Qu=/^#([0-9a-f]{3,8})$/,ed=new RegExp(`^rgb\\(${sn},${sn},${sn}\\)$`),td=new RegExp(`^rgb\\(${ht},${ht},${ht}\\)$`),nd=new RegExp(`^rgba\\(${sn},${sn},${sn},${$n}\\)$`),rd=new RegExp(`^rgba\\(${ht},${ht},${ht},${$n}\\)$`),od=new RegExp(`^hsl\\(${$n},${ht},${ht}\\)$`),id=new RegExp(`^hsla\\(${$n},${ht},${ht},${$n}\\)$`),Oi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Zo(Qn,Xn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Li,formatHex:Li,formatHex8:ad,formatHsl:sd,formatRgb:zi,toString:zi});function Li(){return this.rgb().formatHex()}function ad(){return this.rgb().formatHex8()}function sd(){return ds(this).formatHsl()}function zi(){return this.rgb().formatRgb()}function Xn(e){var t,o;return e=(e+"").trim().toLowerCase(),(t=Qu.exec(e))?(o=t[1].length,t=parseInt(t[1],16),o===6?Bi(t):o===3?new Ye(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):o===8?dr(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):o===4?dr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ed.exec(e))?new Ye(t[1],t[2],t[3],1):(t=td.exec(e))?new Ye(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=nd.exec(e))?dr(t[1],t[2],t[3],t[4]):(t=rd.exec(e))?dr(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=od.exec(e))?Vi(t[1],t[2]/100,t[3]/100,1):(t=id.exec(e))?Vi(t[1],t[2]/100,t[3]/100,t[4]):Oi.hasOwnProperty(e)?Bi(Oi[e]):e==="transparent"?new Ye(NaN,NaN,NaN,0):null}function Bi(e){return new Ye(e>>16&255,e>>8&255,e&255,1)}function dr(e,t,o,a){return a<=0&&(e=t=o=NaN),new Ye(e,t,o,a)}function cd(e){return e instanceof Qn||(e=Xn(e)),e?(e=e.rgb(),new Ye(e.r,e.g,e.b,e.opacity)):new Ye}function ko(e,t,o,a){return arguments.length===1?cd(e):new Ye(e,t,o,a??1)}function Ye(e,t,o,a){this.r=+e,this.g=+t,this.b=+o,this.opacity=+a}Zo(Ye,ko,us(Qn,{brighter(e){return e=e==null?Pr:Math.pow(Pr,e),new Ye(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Wn:Math.pow(Wn,e),new Ye(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ye(jt(this.r),jt(this.g),jt(this.b),Dr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gi,formatHex:Gi,formatHex8:ld,formatRgb:Hi,toString:Hi}));function Gi(){return`#${It(this.r)}${It(this.g)}${It(this.b)}`}function ld(){return`#${It(this.r)}${It(this.g)}${It(this.b)}${It((isNaN(this.opacity)?1:this.opacity)*255)}`}function Hi(){const e=Dr(this.opacity);return`${e===1?"rgb(":"rgba("}${jt(this.r)}, ${jt(this.g)}, ${jt(this.b)}${e===1?")":`, ${e})`}`}function Dr(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function jt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function It(e){return e=jt(e),(e<16?"0":"")+e.toString(16)}function Vi(e,t,o,a){return a<=0?e=t=o=NaN:o<=0||o>=1?e=t=NaN:t<=0&&(e=NaN),new st(e,t,o,a)}function ds(e){if(e instanceof st)return new st(e.h,e.s,e.l,e.opacity);if(e instanceof Qn||(e=Xn(e)),!e)return new st;if(e instanceof st)return e;e=e.rgb();var t=e.r/255,o=e.g/255,a=e.b/255,r=Math.min(t,o,a),n=Math.max(t,o,a),i=NaN,c=n-r,s=(n+r)/2;return c?(t===n?i=(o-a)/c+(o<a)*6:o===n?i=(a-t)/c+2:i=(t-o)/c+4,c/=s<.5?n+r:2-n-r,i*=60):c=s>0&&s<1?0:i,new st(i,c,s,e.opacity)}function ud(e,t,o,a){return arguments.length===1?ds(e):new st(e,t,o,a??1)}function st(e,t,o,a){this.h=+e,this.s=+t,this.l=+o,this.opacity=+a}Zo(st,ud,us(Qn,{brighter(e){return e=e==null?Pr:Math.pow(Pr,e),new st(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Wn:Math.pow(Wn,e),new st(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,o=this.l,a=o+(o<.5?o:1-o)*t,r=2*o-a;return new Ye(ho(e>=240?e-240:e+120,r,a),ho(e,r,a),ho(e<120?e+240:e-120,r,a),this.opacity)},clamp(){return new st(Wi(this.h),fr(this.s),fr(this.l),Dr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Dr(this.opacity);return`${e===1?"hsl(":"hsla("}${Wi(this.h)}, ${fr(this.s)*100}%, ${fr(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Wi(e){return e=(e||0)%360,e<0?e+360:e}function fr(e){return Math.max(0,Math.min(1,e||0))}function ho(e,t,o){return(e<60?t+(o-t)*e/60:e<180?o:e<240?t+(o-t)*(240-e)/60:t)*255}const fs=e=>()=>e;function dd(e,t){return function(o){return e+o*t}}function fd(e,t,o){return e=Math.pow(e,o),t=Math.pow(t,o)-e,o=1/o,function(a){return Math.pow(e+a*t,o)}}function hd(e){return(e=+e)==1?hs:function(t,o){return o-t?fd(t,o,e):fs(isNaN(t)?o:t)}}function hs(e,t){var o=t-e;return o?dd(e,o):fs(isNaN(e)?t:e)}const $i=(function e(t){var o=hd(t);function a(r,n){var i=o((r=ko(r)).r,(n=ko(n)).r),c=o(r.g,n.g),s=o(r.b,n.b),l=hs(r.opacity,n.opacity);return function(u){return r.r=i(u),r.g=c(u),r.b=s(u),r.opacity=l(u),r+""}}return a.gamma=e,a})(1);function kt(e,t){return e=+e,t=+t,function(o){return e*(1-o)+t*o}}var Ao=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,po=new RegExp(Ao.source,"g");function pd(e){return function(){return e}}function gd(e){return function(t){return e(t)+""}}function md(e,t){var o=Ao.lastIndex=po.lastIndex=0,a,r,n,i=-1,c=[],s=[];for(e=e+"",t=t+"";(a=Ao.exec(e))&&(r=po.exec(t));)(n=r.index)>o&&(n=t.slice(o,n),c[i]?c[i]+=n:c[++i]=n),(a=a[0])===(r=r[0])?c[i]?c[i]+=r:c[++i]=r:(c[++i]=null,s.push({i,x:kt(a,r)})),o=po.lastIndex;return o<t.length&&(n=t.slice(o),c[i]?c[i]+=n:c[++i]=n),c.length<2?s[0]?gd(s[0].x):pd(t):(t=s.length,function(l){for(var u=0,d;u<t;++u)c[(d=s[u]).i]=d.x(l);return c.join("")})}var Xi=180/Math.PI,To={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ps(e,t,o,a,r,n){var i,c,s;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(s=e*o+t*a)&&(o-=e*s,a-=t*s),(c=Math.sqrt(o*o+a*a))&&(o/=c,a/=c,s/=c),e*a<t*o&&(e=-e,t=-t,s=-s,i=-i),{translateX:r,translateY:n,rotate:Math.atan2(t,e)*Xi,skewX:Math.atan(s)*Xi,scaleX:i,scaleY:c}}var hr;function yd(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?To:ps(t.a,t.b,t.c,t.d,t.e,t.f)}function vd(e){return e==null||(hr||(hr=document.createElementNS("http://www.w3.org/2000/svg","g")),hr.setAttribute("transform",e),!(e=hr.transform.baseVal.consolidate()))?To:(e=e.matrix,ps(e.a,e.b,e.c,e.d,e.e,e.f))}function gs(e,t,o,a){function r(l){return l.length?l.pop()+" ":""}function n(l,u,d,f,p,y){if(l!==d||u!==f){var m=p.push("translate(",null,t,null,o);y.push({i:m-4,x:kt(l,d)},{i:m-2,x:kt(u,f)})}else(d||f)&&p.push("translate("+d+t+f+o)}function i(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(r(d)+"rotate(",null,a)-2,x:kt(l,u)})):u&&d.push(r(d)+"rotate("+u+a)}function c(l,u,d,f){l!==u?f.push({i:d.push(r(d)+"skewX(",null,a)-2,x:kt(l,u)}):u&&d.push(r(d)+"skewX("+u+a)}function s(l,u,d,f,p,y){if(l!==d||u!==f){var m=p.push(r(p)+"scale(",null,",",null,")");y.push({i:m-4,x:kt(l,d)},{i:m-2,x:kt(u,f)})}else(d!==1||f!==1)&&p.push(r(p)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),n(l.translateX,l.translateY,u.translateX,u.translateY,d,f),i(l.rotate,u.rotate,d,f),c(l.skewX,u.skewX,d,f),s(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(p){for(var y=-1,m=f.length,v;++y<m;)d[(v=f[y]).i]=v.x(p);return d.join("")}}}var xd=gs(yd,"px, ","px)","deg)"),_d=gs(vd,", ",")",")"),bd=1e-12;function Yi(e){return((e=Math.exp(e))+1/e)/2}function wd(e){return((e=Math.exp(e))-1/e)/2}function Sd(e){return((e=Math.exp(2*e))-1)/(e+1)}const Cd=(function e(t,o,a){function r(n,i){var c=n[0],s=n[1],l=n[2],u=i[0],d=i[1],f=i[2],p=u-c,y=d-s,m=p*p+y*y,v,_;if(m<bd)_=Math.log(f/l)/t,v=function(S){return[c+S*p,s+S*y,l*Math.exp(t*S*_)]};else{var w=Math.sqrt(m),C=(f*f-l*l+a*m)/(2*l*o*w),x=(f*f-l*l-a*m)/(2*f*o*w),A=Math.log(Math.sqrt(C*C+1)-C),D=Math.log(Math.sqrt(x*x+1)-x);_=(D-A)/t,v=function(S){var P=S*_,I=Yi(A),j=l/(o*w)*(I*Sd(t*P+A)-wd(A));return[c+j*p,s+j*y,l*I/Yi(t*P+A)]}}return v.duration=_*1e3*t/Math.SQRT2,v}return r.rho=function(n){var i=Math.max(.001,+n),c=i*i,s=c*c;return e(i,c,s)},r})(Math.SQRT2,2,4);var un=0,Fn=0,Mn=0,ms=1e3,Rr,On,Ir=0,zt=0,Br=0,Yn=typeof performance=="object"&&performance.now?performance:Date,ys=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Jo(){return zt||(ys(Ed),zt=Yn.now()+Br)}function Ed(){zt=0}function Ur(){this._call=this._time=this._next=null}Ur.prototype=vs.prototype={constructor:Ur,restart:function(e,t,o){if(typeof e!="function")throw new TypeError("callback is not a function");o=(o==null?Jo():+o)+(t==null?0:+t),!this._next&&On!==this&&(On?On._next=this:Rr=this,On=this),this._call=e,this._time=o,Mo()},stop:function(){this._call&&(this._call=null,this._time=1/0,Mo())}};function vs(e,t,o){var a=new Ur;return a.restart(e,t,o),a}function Nd(){Jo(),++un;for(var e=Rr,t;e;)(t=zt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--un}function qi(){zt=(Ir=Yn.now())+Br,un=Fn=0;try{Nd()}finally{un=0,Ad(),zt=0}}function kd(){var e=Yn.now(),t=e-Ir;t>ms&&(Br-=t,Ir=e)}function Ad(){for(var e,t=Rr,o,a=1/0;t;)t._call?(a>t._time&&(a=t._time),e=t,t=t._next):(o=t._next,t._next=null,t=e?e._next=o:Rr=o);On=e,Mo(a)}function Mo(e){if(!un){Fn&&(Fn=clearTimeout(Fn));var t=e-zt;t>24?(e<1/0&&(Fn=setTimeout(qi,e-Yn.now()-Br)),Mn&&(Mn=clearInterval(Mn))):(Mn||(Ir=Yn.now(),Mn=setInterval(kd,ms)),un=1,ys(qi))}}function Ki(e,t,o){var a=new Ur;return t=t==null?0:+t,a.restart(r=>{a.stop(),e(r+t)},t,o),a}var Td=Lr("start","end","cancel","interrupt"),Md=[],xs=0,Zi=1,Po=2,Cr=3,Ji=4,Do=5,Er=6;function Gr(e,t,o,a,r,n){var i=e.__transition;if(!i)e.__transition={};else if(o in i)return;Pd(e,o,{name:t,index:a,group:r,on:Td,tween:Md,time:n.time,delay:n.delay,duration:n.duration,ease:n.ease,timer:null,state:xs})}function Qo(e,t){var o=lt(e,t);if(o.state>xs)throw new Error("too late; already scheduled");return o}function pt(e,t){var o=lt(e,t);if(o.state>Cr)throw new Error("too late; already running");return o}function lt(e,t){var o=e.__transition;if(!o||!(o=o[t]))throw new Error("transition not found");return o}function Pd(e,t,o){var a=e.__transition,r;a[t]=o,o.timer=vs(n,0,o.time);function n(l){o.state=Zi,o.timer.restart(i,o.delay,o.time),o.delay<=l&&i(l-o.delay)}function i(l){var u,d,f,p;if(o.state!==Zi)return s();for(u in a)if(p=a[u],p.name===o.name){if(p.state===Cr)return Ki(i);p.state===Ji?(p.state=Er,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete a[u]):+u<t&&(p.state=Er,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete a[u])}if(Ki(function(){o.state===Cr&&(o.state=Ji,o.timer.restart(c,o.delay,o.time),c(l))}),o.state=Po,o.on.call("start",e,e.__data__,o.index,o.group),o.state===Po){for(o.state=Cr,r=new Array(f=o.tween.length),u=0,d=-1;u<f;++u)(p=o.tween[u].value.call(e,e.__data__,o.index,o.group))&&(r[++d]=p);r.length=d+1}}function c(l){for(var u=l<o.duration?o.ease.call(null,l/o.duration):(o.timer.restart(s),o.state=Do,1),d=-1,f=r.length;++d<f;)r[d].call(e,u);o.state===Do&&(o.on.call("end",e,e.__data__,o.index,o.group),s())}function s(){o.state=Er,o.timer.stop(),delete a[t];for(var l in a)return;delete e.__transition}}function Nr(e,t){var o=e.__transition,a,r,n=!0,i;if(o){t=t==null?null:t+"";for(i in o){if((a=o[i]).name!==t){n=!1;continue}r=a.state>Po&&a.state<Do,a.state=Er,a.timer.stop(),a.on.call(r?"interrupt":"cancel",e,e.__data__,a.index,a.group),delete o[i]}n&&delete e.__transition}}function Dd(e){return this.each(function(){Nr(this,e)})}function Rd(e,t){var o,a;return function(){var r=pt(this,e),n=r.tween;if(n!==o){a=o=n;for(var i=0,c=a.length;i<c;++i)if(a[i].name===t){a=a.slice(),a.splice(i,1);break}}r.tween=a}}function Id(e,t,o){var a,r;if(typeof o!="function")throw new Error;return function(){var n=pt(this,e),i=n.tween;if(i!==a){r=(a=i).slice();for(var c={name:t,value:o},s=0,l=r.length;s<l;++s)if(r[s].name===t){r[s]=c;break}s===l&&r.push(c)}n.tween=r}}function Ud(e,t){var o=this._id;if(e+="",arguments.length<2){for(var a=lt(this.node(),o).tween,r=0,n=a.length,i;r<n;++r)if((i=a[r]).name===e)return i.value;return null}return this.each((t==null?Rd:Id)(o,e,t))}function ei(e,t,o){var a=e._id;return e.each(function(){var r=pt(this,a);(r.value||(r.value={}))[t]=o.apply(this,arguments)}),function(r){return lt(r,a).value[t]}}function _s(e,t){var o;return(typeof t=="number"?kt:t instanceof Xn?$i:(o=Xn(t))?(t=o,$i):md)(e,t)}function jd(e){return function(){this.removeAttribute(e)}}function Fd(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Od(e,t,o){var a,r=o+"",n;return function(){var i=this.getAttribute(e);return i===r?null:i===a?n:n=t(a=i,o)}}function Ld(e,t,o){var a,r=o+"",n;return function(){var i=this.getAttributeNS(e.space,e.local);return i===r?null:i===a?n:n=t(a=i,o)}}function zd(e,t,o){var a,r,n;return function(){var i,c=o(this),s;return c==null?void this.removeAttribute(e):(i=this.getAttribute(e),s=c+"",i===s?null:i===a&&s===r?n:(r=s,n=t(a=i,c)))}}function Bd(e,t,o){var a,r,n;return function(){var i,c=o(this),s;return c==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),s=c+"",i===s?null:i===a&&s===r?n:(r=s,n=t(a=i,c)))}}function Gd(e,t){var o=zr(e),a=o==="transform"?_d:_s;return this.attrTween(e,typeof t=="function"?(o.local?Bd:zd)(o,a,ei(this,"attr."+e,t)):t==null?(o.local?Fd:jd)(o):(o.local?Ld:Od)(o,a,t))}function Hd(e,t){return function(o){this.setAttribute(e,t.call(this,o))}}function Vd(e,t){return function(o){this.setAttributeNS(e.space,e.local,t.call(this,o))}}function Wd(e,t){var o,a;function r(){var n=t.apply(this,arguments);return n!==a&&(o=(a=n)&&Vd(e,n)),o}return r._value=t,r}function $d(e,t){var o,a;function r(){var n=t.apply(this,arguments);return n!==a&&(o=(a=n)&&Hd(e,n)),o}return r._value=t,r}function Xd(e,t){var o="attr."+e;if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;var a=zr(e);return this.tween(o,(a.local?Wd:$d)(a,t))}function Yd(e,t){return function(){Qo(this,e).delay=+t.apply(this,arguments)}}function qd(e,t){return t=+t,function(){Qo(this,e).delay=t}}function Kd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Yd:qd)(t,e)):lt(this.node(),t).delay}function Zd(e,t){return function(){pt(this,e).duration=+t.apply(this,arguments)}}function Jd(e,t){return t=+t,function(){pt(this,e).duration=t}}function Qd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Zd:Jd)(t,e)):lt(this.node(),t).duration}function ef(e,t){if(typeof t!="function")throw new Error;return function(){pt(this,e).ease=t}}function tf(e){var t=this._id;return arguments.length?this.each(ef(t,e)):lt(this.node(),t).ease}function nf(e,t){return function(){var o=t.apply(this,arguments);if(typeof o!="function")throw new Error;pt(this,e).ease=o}}function rf(e){if(typeof e!="function")throw new Error;return this.each(nf(this._id,e))}function of(e){typeof e!="function"&&(e=Ja(e));for(var t=this._groups,o=t.length,a=new Array(o),r=0;r<o;++r)for(var n=t[r],i=n.length,c=a[r]=[],s,l=0;l<i;++l)(s=n[l])&&e.call(s,s.__data__,l,n)&&c.push(s);return new _t(a,this._parents,this._name,this._id)}function af(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,o=e._groups,a=t.length,r=o.length,n=Math.min(a,r),i=new Array(a),c=0;c<n;++c)for(var s=t[c],l=o[c],u=s.length,d=i[c]=new Array(u),f,p=0;p<u;++p)(f=s[p]||l[p])&&(d[p]=f);for(;c<a;++c)i[c]=t[c];return new _t(i,this._parents,this._name,this._id)}function sf(e){return(e+"").trim().split(/^|\s+/).every(function(t){var o=t.indexOf(".");return o>=0&&(t=t.slice(0,o)),!t||t==="start"})}function cf(e,t,o){var a,r,n=sf(t)?Qo:pt;return function(){var i=n(this,e),c=i.on;c!==a&&(r=(a=c).copy()).on(t,o),i.on=r}}function lf(e,t){var o=this._id;return arguments.length<2?lt(this.node(),o).on.on(e):this.each(cf(o,e,t))}function uf(e){return function(){var t=this.parentNode;for(var o in this.__transition)if(+o!==e)return;t&&t.removeChild(this)}}function df(){return this.on("end.remove",uf(this._id))}function ff(e){var t=this._name,o=this._id;typeof e!="function"&&(e=qo(e));for(var a=this._groups,r=a.length,n=new Array(r),i=0;i<r;++i)for(var c=a[i],s=c.length,l=n[i]=new Array(s),u,d,f=0;f<s;++f)(u=c[f])&&(d=e.call(u,u.__data__,f,c))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,Gr(l[f],t,o,f,l,lt(u,o)));return new _t(n,this._parents,t,o)}function hf(e){var t=this._name,o=this._id;typeof e!="function"&&(e=Za(e));for(var a=this._groups,r=a.length,n=[],i=[],c=0;c<r;++c)for(var s=a[c],l=s.length,u,d=0;d<l;++d)if(u=s[d]){for(var f=e.call(u,u.__data__,d,s),p,y=lt(u,o),m=0,v=f.length;m<v;++m)(p=f[m])&&Gr(p,t,o,m,f,y);n.push(f),i.push(u)}return new _t(n,i,t,o)}var pf=Jn.prototype.constructor;function gf(){return new pf(this._groups,this._parents)}function mf(e,t){var o,a,r;return function(){var n=ln(this,e),i=(this.style.removeProperty(e),ln(this,e));return n===i?null:n===o&&i===a?r:r=t(o=n,a=i)}}function bs(e){return function(){this.style.removeProperty(e)}}function yf(e,t,o){var a,r=o+"",n;return function(){var i=ln(this,e);return i===r?null:i===a?n:n=t(a=i,o)}}function vf(e,t,o){var a,r,n;return function(){var i=ln(this,e),c=o(this),s=c+"";return c==null&&(s=c=(this.style.removeProperty(e),ln(this,e))),i===s?null:i===a&&s===r?n:(r=s,n=t(a=i,c))}}function xf(e,t){var o,a,r,n="style."+t,i="end."+n,c;return function(){var s=pt(this,e),l=s.on,u=s.value[n]==null?c||(c=bs(t)):void 0;(l!==o||r!==u)&&(a=(o=l).copy()).on(i,r=u),s.on=a}}function _f(e,t,o){var a=(e+="")=="transform"?xd:_s;return t==null?this.styleTween(e,mf(e,a)).on("end.style."+e,bs(e)):typeof t=="function"?this.styleTween(e,vf(e,a,ei(this,"style."+e,t))).each(xf(this._id,e)):this.styleTween(e,yf(e,a,t),o).on("end.style."+e,null)}function bf(e,t,o){return function(a){this.style.setProperty(e,t.call(this,a),o)}}function wf(e,t,o){var a,r;function n(){var i=t.apply(this,arguments);return i!==r&&(a=(r=i)&&bf(e,i,o)),a}return n._value=t,n}function Sf(e,t,o){var a="style."+(e+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(t==null)return this.tween(a,null);if(typeof t!="function")throw new Error;return this.tween(a,wf(e,t,o??""))}function Cf(e){return function(){this.textContent=e}}function Ef(e){return function(){var t=e(this);this.textContent=t??""}}function Nf(e){return this.tween("text",typeof e=="function"?Ef(ei(this,"text",e)):Cf(e==null?"":e+""))}function kf(e){return function(t){this.textContent=e.call(this,t)}}function Af(e){var t,o;function a(){var r=e.apply(this,arguments);return r!==o&&(t=(o=r)&&kf(r)),t}return a._value=e,a}function Tf(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Af(e))}function Mf(){for(var e=this._name,t=this._id,o=ws(),a=this._groups,r=a.length,n=0;n<r;++n)for(var i=a[n],c=i.length,s,l=0;l<c;++l)if(s=i[l]){var u=lt(s,t);Gr(s,e,o,l,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new _t(a,this._parents,e,o)}function Pf(){var e,t,o=this,a=o._id,r=o.size();return new Promise(function(n,i){var c={value:i},s={value:function(){--r===0&&n()}};o.each(function(){var l=pt(this,a),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(c),t._.interrupt.push(c),t._.end.push(s)),l.on=t}),r===0&&n()})}var Df=0;function _t(e,t,o,a){this._groups=e,this._parents=t,this._name=o,this._id=a}function ws(){return++Df}var yt=Jn.prototype;_t.prototype={constructor:_t,select:ff,selectAll:hf,selectChild:yt.selectChild,selectChildren:yt.selectChildren,filter:of,merge:af,selection:gf,transition:Mf,call:yt.call,nodes:yt.nodes,node:yt.node,size:yt.size,empty:yt.empty,each:yt.each,on:lf,attr:Gd,attrTween:Xd,style:_f,styleTween:Sf,text:Nf,textTween:Tf,remove:df,tween:Ud,delay:Kd,duration:Qd,ease:tf,easeVarying:rf,end:Pf,[Symbol.iterator]:yt[Symbol.iterator]};function Rf(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var If={time:null,delay:0,duration:250,ease:Rf};function Uf(e,t){for(var o;!(o=e.__transition)||!(o=o[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return o}function jf(e){var t,o;e instanceof _t?(t=e._id,e=e._name):(t=ws(),(o=If).time=Jo(),e=e==null?null:e+"");for(var a=this._groups,r=a.length,n=0;n<r;++n)for(var i=a[n],c=i.length,s,l=0;l<c;++l)(s=i[l])&&Gr(s,e,t,l,i,o||Uf(s,t));return new _t(a,this._parents,e,t)}Jn.prototype.interrupt=Dd;Jn.prototype.transition=jf;const pr=e=>()=>e;function Ff(e,{sourceEvent:t,target:o,transform:a,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:a,enumerable:!0,configurable:!0},_:{value:r}})}function vt(e,t,o){this.k=e,this.x=t,this.y=o}vt.prototype={constructor:vt,scale:function(e){return e===1?this:new vt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new vt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var xt=new vt(1,0,0);vt.prototype;function go(e){e.stopImmediatePropagation()}function Pn(e){e.preventDefault(),e.stopImmediatePropagation()}function Of(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Lf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Qi(){return this.__zoom||xt}function zf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Bf(){return navigator.maxTouchPoints||"ontouchstart"in this}function Gf(e,t,o){var a=e.invertX(t[0][0])-o[0][0],r=e.invertX(t[1][0])-o[1][0],n=e.invertY(t[0][1])-o[0][1],i=e.invertY(t[1][1])-o[1][1];return e.translate(r>a?(a+r)/2:Math.min(0,a)||Math.max(0,r),i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i))}function Ss(){var e=Of,t=Lf,o=Gf,a=zf,r=Bf,n=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],c=250,s=Cd,l=Lr("start","zoom","end"),u,d,f,p=500,y=150,m=0,v=10;function _(g){g.property("__zoom",Qi).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",I).on("dblclick.zoom",j).filter(r).on("touchstart.zoom",H).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",U).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(g,k,E,B){var G=g.selection?g.selection():g;G.property("__zoom",Qi),g!==G?A(g,k,E,B):G.interrupt().each(function(){D(this,arguments).event(B).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},_.scaleBy=function(g,k,E,B){_.scaleTo(g,function(){var G=this.__zoom.k,N=typeof k=="function"?k.apply(this,arguments):k;return G*N},E,B)},_.scaleTo=function(g,k,E,B){_.transform(g,function(){var G=t.apply(this,arguments),N=this.__zoom,R=E==null?x(G):typeof E=="function"?E.apply(this,arguments):E,b=N.invert(R),M=typeof k=="function"?k.apply(this,arguments):k;return o(C(w(N,M),R,b),G,i)},E,B)},_.translateBy=function(g,k,E,B){_.transform(g,function(){return o(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof E=="function"?E.apply(this,arguments):E),t.apply(this,arguments),i)},null,B)},_.translateTo=function(g,k,E,B,G){_.transform(g,function(){var N=t.apply(this,arguments),R=this.__zoom,b=B==null?x(N):typeof B=="function"?B.apply(this,arguments):B;return o(xt.translate(b[0],b[1]).scale(R.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof E=="function"?-E.apply(this,arguments):-E),N,i)},B,G)};function w(g,k){return k=Math.max(n[0],Math.min(n[1],k)),k===g.k?g:new vt(k,g.x,g.y)}function C(g,k,E){var B=k[0]-E[0]*g.k,G=k[1]-E[1]*g.k;return B===g.x&&G===g.y?g:new vt(g.k,B,G)}function x(g){return[(+g[0][0]+ +g[1][0])/2,(+g[0][1]+ +g[1][1])/2]}function A(g,k,E,B){g.on("start.zoom",function(){D(this,arguments).event(B).start()}).on("interrupt.zoom end.zoom",function(){D(this,arguments).event(B).end()}).tween("zoom",function(){var G=this,N=arguments,R=D(G,N).event(B),b=t.apply(G,N),M=E==null?x(b):typeof E=="function"?E.apply(G,N):E,O=Math.max(b[1][0]-b[0][0],b[1][1]-b[0][1]),L=G.__zoom,z=typeof k=="function"?k.apply(G,N):k,$=s(L.invert(M).concat(O/L.k),z.invert(M).concat(O/z.k));return function(V){if(V===1)V=z;else{var Y=$(V),Z=O/Y[2];V=new vt(Z,M[0]-Y[0]*Z,M[1]-Y[1]*Z)}R.zoom(null,V)}})}function D(g,k,E){return!E&&g.__zooming||new S(g,k)}function S(g,k){this.that=g,this.args=k,this.active=0,this.sourceEvent=null,this.extent=t.apply(g,k),this.taps=0}S.prototype={event:function(g){return g&&(this.sourceEvent=g),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(g,k){return this.mouse&&g!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&g!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&g!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(g){var k=Qe(this.that).datum();l.call(g,this.that,new Ff(g,{sourceEvent:this.sourceEvent,target:_,transform:this.that.__zoom,dispatch:l}),k)}};function P(g,...k){if(!e.apply(this,arguments))return;var E=D(this,k).event(g),B=this.__zoom,G=Math.max(n[0],Math.min(n[1],B.k*Math.pow(2,a.apply(this,arguments)))),N=at(g);if(E.wheel)(E.mouse[0][0]!==N[0]||E.mouse[0][1]!==N[1])&&(E.mouse[1]=B.invert(E.mouse[0]=N)),clearTimeout(E.wheel);else{if(B.k===G)return;E.mouse=[N,B.invert(N)],Nr(this),E.start()}Pn(g),E.wheel=setTimeout(R,y),E.zoom("mouse",o(C(w(B,G),E.mouse[0],E.mouse[1]),E.extent,i));function R(){E.wheel=null,E.end()}}function I(g,...k){if(f||!e.apply(this,arguments))return;var E=g.currentTarget,B=D(this,k,!0).event(g),G=Qe(g.view).on("mousemove.zoom",M,!0).on("mouseup.zoom",O,!0),N=at(g,E),R=g.clientX,b=g.clientY;cs(g.view),go(g),B.mouse=[N,this.__zoom.invert(N)],Nr(this),B.start();function M(L){if(Pn(L),!B.moved){var z=L.clientX-R,$=L.clientY-b;B.moved=z*z+$*$>m}B.event(L).zoom("mouse",o(C(B.that.__zoom,B.mouse[0]=at(L,E),B.mouse[1]),B.extent,i))}function O(L){G.on("mousemove.zoom mouseup.zoom",null),ls(L.view,B.moved),Pn(L),B.event(L).end()}}function j(g,...k){if(e.apply(this,arguments)){var E=this.__zoom,B=at(g.changedTouches?g.changedTouches[0]:g,this),G=E.invert(B),N=E.k*(g.shiftKey?.5:2),R=o(C(w(E,N),B,G),t.apply(this,k),i);Pn(g),c>0?Qe(this).transition().duration(c).call(A,R,B,g):Qe(this).call(_.transform,R,B,g)}}function H(g,...k){if(e.apply(this,arguments)){var E=g.touches,B=E.length,G=D(this,k,g.changedTouches.length===B).event(g),N,R,b,M;for(go(g),R=0;R<B;++R)b=E[R],M=at(b,this),M=[M,this.__zoom.invert(M),b.identifier],G.touch0?!G.touch1&&G.touch0[2]!==M[2]&&(G.touch1=M,G.taps=0):(G.touch0=M,N=!0,G.taps=1+!!u);u&&(u=clearTimeout(u)),N&&(G.taps<2&&(d=M[0],u=setTimeout(function(){u=null},p)),Nr(this),G.start())}}function T(g,...k){if(this.__zooming){var E=D(this,k).event(g),B=g.changedTouches,G=B.length,N,R,b,M;for(Pn(g),N=0;N<G;++N)R=B[N],b=at(R,this),E.touch0&&E.touch0[2]===R.identifier?E.touch0[0]=b:E.touch1&&E.touch1[2]===R.identifier&&(E.touch1[0]=b);if(R=E.that.__zoom,E.touch1){var O=E.touch0[0],L=E.touch0[1],z=E.touch1[0],$=E.touch1[1],V=(V=z[0]-O[0])*V+(V=z[1]-O[1])*V,Y=(Y=$[0]-L[0])*Y+(Y=$[1]-L[1])*Y;R=w(R,Math.sqrt(V/Y)),b=[(O[0]+z[0])/2,(O[1]+z[1])/2],M=[(L[0]+$[0])/2,(L[1]+$[1])/2]}else if(E.touch0)b=E.touch0[0],M=E.touch0[1];else return;E.zoom("touch",o(C(R,b,M),E.extent,i))}}function U(g,...k){if(this.__zooming){var E=D(this,k).event(g),B=g.changedTouches,G=B.length,N,R;for(go(g),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),N=0;N<G;++N)R=B[N],E.touch0&&E.touch0[2]===R.identifier?delete E.touch0:E.touch1&&E.touch1[2]===R.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&(R=at(R,this),Math.hypot(d[0]-R[0],d[1]-R[1])<v)){var b=Qe(this).on("dblclick.zoom");b&&b.apply(this,arguments)}}}return _.wheelDelta=function(g){return arguments.length?(a=typeof g=="function"?g:pr(+g),_):a},_.filter=function(g){return arguments.length?(e=typeof g=="function"?g:pr(!!g),_):e},_.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:pr(!!g),_):r},_.extent=function(g){return arguments.length?(t=typeof g=="function"?g:pr([[+g[0][0],+g[0][1]],[+g[1][0],+g[1][1]]]),_):t},_.scaleExtent=function(g){return arguments.length?(n[0]=+g[0],n[1]=+g[1],_):[n[0],n[1]]},_.translateExtent=function(g){return arguments.length?(i[0][0]=+g[0][0],i[1][0]=+g[1][0],i[0][1]=+g[0][1],i[1][1]=+g[1][1],_):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},_.constrain=function(g){return arguments.length?(o=g,_):o},_.duration=function(g){return arguments.length?(c=+g,_):c},_.interpolate=function(g){return arguments.length?(s=g,_):s},_.on=function(){var g=l.on.apply(l,arguments);return g===l?_:g},_.clickDistance=function(g){return arguments.length?(m=(g=+g)*g,_):Math.sqrt(m)},_.tapDistance=function(g){return arguments.length?(v=+g,_):v},_}Lc();const Hr=F.createContext(null),Hf=Hr.Provider,bt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Cs=bt.error001();function Ie(e,t){const o=F.useContext(Hr);if(o===null)throw new Error(Cs);return qa(o,e,t)}const Oe=()=>{const e=F.useContext(Hr);if(e===null)throw new Error(Cs);return F.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Vf=e=>e.userSelectionActive?"none":"all";function ti({position:e,children:t,className:o,style:a,...r}){const n=Ie(Vf),i=`${e}`.split("-");return X.createElement("div",{className:We(["react-flow__panel",o,...i]),style:{...a,pointerEvents:n},...r},t)}function Wf({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:X.createElement(ti,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},X.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const $f=({x:e,y:t,label:o,labelStyle:a={},labelShowBg:r=!0,labelBgStyle:n={},labelBgPadding:i=[2,4],labelBgBorderRadius:c=2,children:s,className:l,...u})=>{const d=F.useRef(null),[f,p]=F.useState({x:0,y:0,width:0,height:0}),y=We(["react-flow__edge-textwrapper",l]);return F.useEffect(()=>{if(d.current){const m=d.current.getBBox();p({x:m.x,y:m.y,width:m.width,height:m.height})}},[o]),typeof o>"u"||!o?null:X.createElement("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:y,visibility:f.width?"visible":"hidden",...u},r&&X.createElement("rect",{width:f.width+2*i[0],x:-i[0],y:-i[1],height:f.height+2*i[1],className:"react-flow__edge-textbg",style:n,rx:c,ry:c}),X.createElement("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:d,style:a},o),s)};var Xf=F.memo($f);const ni=e=>({width:e.offsetWidth,height:e.offsetHeight}),dn=(e,t=0,o=1)=>Math.min(Math.max(e,t),o),ri=(e={x:0,y:0},t)=>({x:dn(e.x,t[0][0],t[1][0]),y:dn(e.y,t[0][1],t[1][1])}),ea=(e,t,o)=>e<t?dn(Math.abs(e-t),1,50)/50:e>o?-dn(Math.abs(e-o),1,50)/50:0,Es=(e,t)=>{const o=ea(e.x,35,t.width-35)*20,a=ea(e.y,35,t.height-35)*20;return[o,a]},Ns=e=>e.getRootNode?.()||window?.document,ks=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),qn=({x:e,y:t,width:o,height:a})=>({x:e,y:t,x2:e+o,y2:t+a}),As=({x:e,y:t,x2:o,y2:a})=>({x:e,y:t,width:o-e,height:a-t}),ta=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Yf=(e,t)=>As(ks(qn(e),qn(t))),Ro=(e,t)=>{const o=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),a=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(o*a)},qf=e=>et(e.width)&&et(e.height)&&et(e.x)&&et(e.y),et=e=>!isNaN(e)&&isFinite(e),je=Symbol.for("internals"),Ts=["Enter"," ","Escape"],Kf=(e,t)=>{},Zf=e=>"nativeEvent"in e;function Io(e){const o=(Zf(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(o?.nodeName)||o?.hasAttribute("contenteditable")||!!o?.closest(".nokey")}const Ms=e=>"clientX"in e,Mt=(e,t)=>{const o=Ms(e),a=o?e.clientX:e.touches?.[0].clientX,r=o?e.clientY:e.touches?.[0].clientY;return{x:a-(t?.left??0),y:r-(t?.top??0)}},jr=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,hn=({id:e,path:t,labelX:o,labelY:a,label:r,labelStyle:n,labelShowBg:i,labelBgStyle:c,labelBgPadding:s,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:p=20})=>X.createElement(X.Fragment,null,X.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:f}),p&&X.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),r&&et(o)&&et(a)?X.createElement(Xf,{x:o,y:a,label:r,labelStyle:n,labelShowBg:i,labelBgStyle:c,labelBgPadding:s,labelBgBorderRadius:l}):null);hn.displayName="BaseEdge";function Dn(e,t,o){return o===void 0?o:a=>{const r=t().edges.find(n=>n.id===e);r&&o(a,{...r})}}function Ps({sourceX:e,sourceY:t,targetX:o,targetY:a}){const r=Math.abs(o-e)/2,n=o<e?o+r:o-r,i=Math.abs(a-t)/2,c=a<t?a+i:a-i;return[n,c,r,i]}function Ds({sourceX:e,sourceY:t,targetX:o,targetY:a,sourceControlX:r,sourceControlY:n,targetControlX:i,targetControlY:c}){const s=e*.125+r*.375+i*.375+o*.125,l=t*.125+n*.375+c*.375+a*.125,u=Math.abs(s-e),d=Math.abs(l-t);return[s,l,u,d]}var Bt;(function(e){e.Strict="strict",e.Loose="loose"})(Bt||(Bt={}));var Ut;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ut||(Ut={}));var Kn;(function(e){e.Partial="partial",e.Full="full"})(Kn||(Kn={}));var Tt;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Tt||(Tt={}));var Fr;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Fr||(Fr={}));var pe;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(pe||(pe={}));function na({pos:e,x1:t,y1:o,x2:a,y2:r}){return e===pe.Left||e===pe.Right?[.5*(t+a),o]:[t,.5*(o+r)]}function Rs({sourceX:e,sourceY:t,sourcePosition:o=pe.Bottom,targetX:a,targetY:r,targetPosition:n=pe.Top}){const[i,c]=na({pos:o,x1:e,y1:t,x2:a,y2:r}),[s,l]=na({pos:n,x1:a,y1:r,x2:e,y2:t}),[u,d,f,p]=Ds({sourceX:e,sourceY:t,targetX:a,targetY:r,sourceControlX:i,sourceControlY:c,targetControlX:s,targetControlY:l});return[`M${e},${t} C${i},${c} ${s},${l} ${a},${r}`,u,d,f,p]}const oi=F.memo(({sourceX:e,sourceY:t,targetX:o,targetY:a,sourcePosition:r=pe.Bottom,targetPosition:n=pe.Top,label:i,labelStyle:c,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,interactionWidth:m})=>{const[v,_,w]=Rs({sourceX:e,sourceY:t,sourcePosition:r,targetX:o,targetY:a,targetPosition:n});return X.createElement(hn,{path:v,labelX:_,labelY:w,label:i,labelStyle:c,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,interactionWidth:m})});oi.displayName="SimpleBezierEdge";const ra={[pe.Left]:{x:-1,y:0},[pe.Right]:{x:1,y:0},[pe.Top]:{x:0,y:-1},[pe.Bottom]:{x:0,y:1}},Jf=({source:e,sourcePosition:t=pe.Bottom,target:o})=>t===pe.Left||t===pe.Right?e.x<o.x?{x:1,y:0}:{x:-1,y:0}:e.y<o.y?{x:0,y:1}:{x:0,y:-1},oa=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Qf({source:e,sourcePosition:t=pe.Bottom,target:o,targetPosition:a=pe.Top,center:r,offset:n}){const i=ra[t],c=ra[a],s={x:e.x+i.x*n,y:e.y+i.y*n},l={x:o.x+c.x*n,y:o.y+c.y*n},u=Jf({source:s,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let p=[],y,m;const v={x:0,y:0},_={x:0,y:0},[w,C,x,A]=Ps({sourceX:e.x,sourceY:e.y,targetX:o.x,targetY:o.y});if(i[d]*c[d]===-1){y=r.x??w,m=r.y??C;const S=[{x:y,y:s.y},{x:y,y:l.y}],P=[{x:s.x,y:m},{x:l.x,y:m}];i[d]===f?p=d==="x"?S:P:p=d==="x"?P:S}else{const S=[{x:s.x,y:l.y}],P=[{x:l.x,y:s.y}];if(d==="x"?p=i.x===f?P:S:p=i.y===f?S:P,t===a){const U=Math.abs(e[d]-o[d]);if(U<=n){const g=Math.min(n-1,n-U);i[d]===f?v[d]=(s[d]>e[d]?-1:1)*g:_[d]=(l[d]>o[d]?-1:1)*g}}if(t!==a){const U=d==="x"?"y":"x",g=i[d]===c[U],k=s[U]>l[U],E=s[U]<l[U];(i[d]===1&&(!g&&k||g&&E)||i[d]!==1&&(!g&&E||g&&k))&&(p=d==="x"?S:P)}const I={x:s.x+v.x,y:s.y+v.y},j={x:l.x+_.x,y:l.y+_.y},H=Math.max(Math.abs(I.x-p[0].x),Math.abs(j.x-p[0].x)),T=Math.max(Math.abs(I.y-p[0].y),Math.abs(j.y-p[0].y));H>=T?(y=(I.x+j.x)/2,m=p[0].y):(y=p[0].x,m=(I.y+j.y)/2)}return[[e,{x:s.x+v.x,y:s.y+v.y},...p,{x:l.x+_.x,y:l.y+_.y},o],y,m,x,A]}function eh(e,t,o,a){const r=Math.min(oa(e,t)/2,oa(t,o)/2,a),{x:n,y:i}=t;if(e.x===n&&n===o.x||e.y===i&&i===o.y)return`L${n} ${i}`;if(e.y===i){const l=e.x<o.x?-1:1,u=e.y<o.y?1:-1;return`L ${n+r*l},${i}Q ${n},${i} ${n},${i+r*u}`}const c=e.x<o.x?1:-1,s=e.y<o.y?-1:1;return`L ${n},${i+r*s}Q ${n},${i} ${n+r*c},${i}`}function Uo({sourceX:e,sourceY:t,sourcePosition:o=pe.Bottom,targetX:a,targetY:r,targetPosition:n=pe.Top,borderRadius:i=5,centerX:c,centerY:s,offset:l=20}){const[u,d,f,p,y]=Qf({source:{x:e,y:t},sourcePosition:o,target:{x:a,y:r},targetPosition:n,center:{x:c,y:s},offset:l});return[u.reduce((v,_,w)=>{let C="";return w>0&&w<u.length-1?C=eh(u[w-1],_,u[w+1],i):C=`${w===0?"M":"L"}${_.x} ${_.y}`,v+=C,v},""),d,f,p,y]}const Vr=F.memo(({sourceX:e,sourceY:t,targetX:o,targetY:a,label:r,labelStyle:n,labelShowBg:i,labelBgStyle:c,labelBgPadding:s,labelBgBorderRadius:l,style:u,sourcePosition:d=pe.Bottom,targetPosition:f=pe.Top,markerEnd:p,markerStart:y,pathOptions:m,interactionWidth:v})=>{const[_,w,C]=Uo({sourceX:e,sourceY:t,sourcePosition:d,targetX:o,targetY:a,targetPosition:f,borderRadius:m?.borderRadius,offset:m?.offset});return X.createElement(hn,{path:_,labelX:w,labelY:C,label:r,labelStyle:n,labelShowBg:i,labelBgStyle:c,labelBgPadding:s,labelBgBorderRadius:l,style:u,markerEnd:p,markerStart:y,interactionWidth:v})});Vr.displayName="SmoothStepEdge";const ii=F.memo(e=>X.createElement(Vr,{...e,pathOptions:F.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));ii.displayName="StepEdge";function th({sourceX:e,sourceY:t,targetX:o,targetY:a}){const[r,n,i,c]=Ps({sourceX:e,sourceY:t,targetX:o,targetY:a});return[`M ${e},${t}L ${o},${a}`,r,n,i,c]}const ai=F.memo(({sourceX:e,sourceY:t,targetX:o,targetY:a,label:r,labelStyle:n,labelShowBg:i,labelBgStyle:c,labelBgPadding:s,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:p})=>{const[y,m,v]=th({sourceX:e,sourceY:t,targetX:o,targetY:a});return X.createElement(hn,{path:y,labelX:m,labelY:v,label:r,labelStyle:n,labelShowBg:i,labelBgStyle:c,labelBgPadding:s,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:p})});ai.displayName="StraightEdge";function gr(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ia({pos:e,x1:t,y1:o,x2:a,y2:r,c:n}){switch(e){case pe.Left:return[t-gr(t-a,n),o];case pe.Right:return[t+gr(a-t,n),o];case pe.Top:return[t,o-gr(o-r,n)];case pe.Bottom:return[t,o+gr(r-o,n)]}}function si({sourceX:e,sourceY:t,sourcePosition:o=pe.Bottom,targetX:a,targetY:r,targetPosition:n=pe.Top,curvature:i=.25}){const[c,s]=ia({pos:o,x1:e,y1:t,x2:a,y2:r,c:i}),[l,u]=ia({pos:n,x1:a,y1:r,x2:e,y2:t,c:i}),[d,f,p,y]=Ds({sourceX:e,sourceY:t,targetX:a,targetY:r,sourceControlX:c,sourceControlY:s,targetControlX:l,targetControlY:u});return[`M${e},${t} C${c},${s} ${l},${u} ${a},${r}`,d,f,p,y]}const Or=F.memo(({sourceX:e,sourceY:t,targetX:o,targetY:a,sourcePosition:r=pe.Bottom,targetPosition:n=pe.Top,label:i,labelStyle:c,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,pathOptions:m,interactionWidth:v})=>{const[_,w,C]=si({sourceX:e,sourceY:t,sourcePosition:r,targetX:o,targetY:a,targetPosition:n,curvature:m?.curvature});return X.createElement(hn,{path:_,labelX:w,labelY:C,label:i,labelStyle:c,labelShowBg:s,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,interactionWidth:v})});Or.displayName="BezierEdge";const ci=F.createContext(null),nh=ci.Provider;ci.Consumer;const rh=()=>F.useContext(ci),oh=e=>"id"in e&&"source"in e&&"target"in e,ih=({source:e,sourceHandle:t,target:o,targetHandle:a})=>`reactflow__edge-${e}${t||""}-${o}${a||""}`,jo=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(a=>`${a}=${e[a]}`).join("&")}`,ah=(e,t)=>t.some(o=>o.source===e.source&&o.target===e.target&&(o.sourceHandle===e.sourceHandle||!o.sourceHandle&&!e.sourceHandle)&&(o.targetHandle===e.targetHandle||!o.targetHandle&&!e.targetHandle)),Is=(e,t)=>{if(!e.source||!e.target)return t;let o;return oh(e)?o={...e}:o={...e,id:ih(e)},ah(o,t)?t:t.concat(o)},Fo=({x:e,y:t},[o,a,r],n,[i,c])=>{const s={x:(e-o)/r,y:(t-a)/r};return n?{x:i*Math.round(s.x/i),y:c*Math.round(s.y/c)}:s},Us=({x:e,y:t},[o,a,r])=>({x:e*r+o,y:t*r+a}),Ft=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const o=(e.width??0)*t[0],a=(e.height??0)*t[1],r={x:e.position.x-o,y:e.position.y-a};return{...r,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-o,y:e.positionAbsolute.y-a}:r}},Wr=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const o=e.reduce((a,r)=>{const{x:n,y:i}=Ft(r,t).positionAbsolute;return ks(a,qn({x:n,y:i,width:r.width||0,height:r.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return As(o)},js=(e,t,[o,a,r]=[0,0,1],n=!1,i=!1,c=[0,0])=>{const s={x:(t.x-o)/r,y:(t.y-a)/r,width:t.width/r,height:t.height/r},l=[];return e.forEach(u=>{const{width:d,height:f,selectable:p=!0,hidden:y=!1}=u;if(i&&!p||y)return!1;const{positionAbsolute:m}=Ft(u,c),v={x:m.x,y:m.y,width:d||0,height:f||0},_=Ro(s,v),w=typeof d>"u"||typeof f>"u"||d===null||f===null,C=n&&_>0,x=(d||0)*(f||0);(w||C||_>=x||u.dragging)&&l.push(u)}),l},Fs=(e,t)=>{const o=e.map(a=>a.id);return t.filter(a=>o.includes(a.source)||o.includes(a.target))},Os=(e,t,o,a,r,n=.1)=>{const i=t/(e.width*(1+n)),c=o/(e.height*(1+n)),s=Math.min(i,c),l=dn(s,a,r),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,p=o/2-d*l;return{x:f,y:p,zoom:l}},Rt=(e,t=0)=>e.transition().duration(t);function aa(e,t,o,a){return(t[o]||[]).reduce((r,n)=>(`${e.id}-${n.id}-${o}`!==a&&r.push({id:n.id||null,type:o,nodeId:e.id,x:(e.positionAbsolute?.x??0)+n.x+n.width/2,y:(e.positionAbsolute?.y??0)+n.y+n.height/2}),r),[])}function sh(e,t,o,a,r,n){const{x:i,y:c}=Mt(e),l=t.elementsFromPoint(i,c).find(y=>y.classList.contains("react-flow__handle"));if(l){const y=l.getAttribute("data-nodeid");if(y){const m=li(void 0,l),v=l.getAttribute("data-handleid"),_=n({nodeId:y,id:v,type:m});if(_){const w=r.find(C=>C.nodeId===y&&C.type===m&&C.id===v);return{handle:{id:v,type:m,nodeId:y,x:w?.x||o.x,y:w?.y||o.y},validHandleResult:_}}}}let u=[],d=1/0;if(r.forEach(y=>{const m=Math.sqrt((y.x-o.x)**2+(y.y-o.y)**2);if(m<=a){const v=n(y);m<=d&&(m<d?u=[{handle:y,validHandleResult:v}]:m===d&&u.push({handle:y,validHandleResult:v}),d=m)}}),!u.length)return{handle:null,validHandleResult:Ls()};if(u.length===1)return u[0];const f=u.some(({validHandleResult:y})=>y.isValid),p=u.some(({handle:y})=>y.type==="target");return u.find(({handle:y,validHandleResult:m})=>p?y.type==="target":f?m.isValid:!0)||u[0]}const ch={source:null,target:null,sourceHandle:null,targetHandle:null},Ls=()=>({handleDomNode:null,isValid:!1,connection:ch,endHandle:null});function zs(e,t,o,a,r,n,i){const c=r==="target",s=i.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),l={...Ls(),handleDomNode:s};if(s){const u=li(void 0,s),d=s.getAttribute("data-nodeid"),f=s.getAttribute("data-handleid"),p=s.classList.contains("connectable"),y=s.classList.contains("connectableend"),m={source:c?d:o,sourceHandle:c?f:a,target:c?o:d,targetHandle:c?a:f};l.connection=m,p&&y&&(t===Bt.Strict?c&&u==="source"||!c&&u==="target":d!==o||f!==a)&&(l.endHandle={nodeId:d,handleId:f,type:u},l.isValid=n(m))}return l}function lh({nodes:e,nodeId:t,handleId:o,handleType:a}){return e.reduce((r,n)=>{if(n[je]){const{handleBounds:i}=n[je];let c=[],s=[];i&&(c=aa(n,i,"source",`${t}-${o}-${a}`),s=aa(n,i,"target",`${t}-${o}-${a}`)),r.push(...c,...s)}return r},[])}function li(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function mo(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function uh(e,t){let o=null;return t?o="valid":e&&!t&&(o="invalid"),o}function Bs({event:e,handleId:t,nodeId:o,onConnect:a,isTarget:r,getState:n,setState:i,isValidConnection:c,edgeUpdaterType:s,onReconnectEnd:l}){const u=Ns(e.target),{connectionMode:d,domNode:f,autoPanOnConnect:p,connectionRadius:y,onConnectStart:m,panBy:v,getNodes:_,cancelConnection:w}=n();let C=0,x;const{x:A,y:D}=Mt(e),S=u?.elementFromPoint(A,D),P=li(s,S),I=f?.getBoundingClientRect();if(!I||!P)return;let j,H=Mt(e,I),T=!1,U=null,g=!1,k=null;const E=lh({nodes:_(),nodeId:o,handleId:t,handleType:P}),B=()=>{if(!p)return;const[R,b]=Es(H,I);v({x:R,y:b}),C=requestAnimationFrame(B)};i({connectionPosition:H,connectionStatus:null,connectionNodeId:o,connectionHandleId:t,connectionHandleType:P,connectionStartHandle:{nodeId:o,handleId:t,type:P},connectionEndHandle:null}),m?.(e,{nodeId:o,handleId:t,handleType:P});function G(R){const{transform:b}=n();H=Mt(R,I);const{handle:M,validHandleResult:O}=sh(R,u,Fo(H,b,!1,[1,1]),y,E,L=>zs(L,d,o,t,r?"target":"source",c,u));if(x=M,T||(B(),T=!0),k=O.handleDomNode,U=O.connection,g=O.isValid,i({connectionPosition:x&&g?Us({x:x.x,y:x.y},b):H,connectionStatus:uh(!!x,g),connectionEndHandle:O.endHandle}),!x&&!g&&!k)return mo(j);U.source!==U.target&&k&&(mo(j),j=k,k.classList.add("connecting","react-flow__handle-connecting"),k.classList.toggle("valid",g),k.classList.toggle("react-flow__handle-valid",g))}function N(R){(x||k)&&U&&g&&a?.(U),n().onConnectEnd?.(R),s&&l?.(R),mo(j),w(),cancelAnimationFrame(C),T=!1,g=!1,U=null,k=null,u.removeEventListener("mousemove",G),u.removeEventListener("mouseup",N),u.removeEventListener("touchmove",G),u.removeEventListener("touchend",N)}u.addEventListener("mousemove",G),u.addEventListener("mouseup",N),u.addEventListener("touchmove",G),u.addEventListener("touchend",N)}const sa=()=>!0,dh=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),fh=(e,t,o)=>a=>{const{connectionStartHandle:r,connectionEndHandle:n,connectionClickStartHandle:i}=a;return{connecting:r?.nodeId===e&&r?.handleId===t&&r?.type===o||n?.nodeId===e&&n?.handleId===t&&n?.type===o,clickConnecting:i?.nodeId===e&&i?.handleId===t&&i?.type===o}},Gs=F.forwardRef(({type:e="source",position:t=pe.Top,isValidConnection:o,isConnectable:a=!0,isConnectableStart:r=!0,isConnectableEnd:n=!0,id:i,onConnect:c,children:s,className:l,onMouseDown:u,onTouchStart:d,...f},p)=>{const y=i||null,m=e==="target",v=Oe(),_=rh(),{connectOnClick:w,noPanClassName:C}=Ie(dh,Be),{connecting:x,clickConnecting:A}=Ie(fh(_,y,e),Be);_||v.getState().onError?.("010",bt.error010());const D=I=>{const{defaultEdgeOptions:j,onConnect:H,hasDefaultEdges:T}=v.getState(),U={...j,...I};if(T){const{edges:g,setEdges:k}=v.getState();k(Is(U,g))}H?.(U),c?.(U)},S=I=>{if(!_)return;const j=Ms(I);r&&(j&&I.button===0||!j)&&Bs({event:I,handleId:y,nodeId:_,onConnect:D,isTarget:m,getState:v.getState,setState:v.setState,isValidConnection:o||v.getState().isValidConnection||sa}),j?u?.(I):d?.(I)},P=I=>{const{onClickConnectStart:j,onClickConnectEnd:H,connectionClickStartHandle:T,connectionMode:U,isValidConnection:g}=v.getState();if(!_||!T&&!r)return;if(!T){j?.(I,{nodeId:_,handleId:y,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:_,type:e,handleId:y}});return}const k=Ns(I.target),E=o||g||sa,{connection:B,isValid:G}=zs({nodeId:_,id:y,type:e},U,T.nodeId,T.handleId||null,T.type,E,k);G&&D(B),H?.(I),v.setState({connectionClickStartHandle:null})};return X.createElement("div",{"data-handleid":y,"data-nodeid":_,"data-handlepos":t,"data-id":`${_}-${y}-${e}`,className:We(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",C,l,{source:!m,target:m,connectable:a,connectablestart:r,connectableend:n,connecting:A,connectionindicator:a&&(r&&!x||n&&x)}]),onMouseDown:S,onTouchStart:S,onClick:w?P:void 0,ref:p,...f},s)});Gs.displayName="Handle";var Ot=F.memo(Gs);const Hs=({data:e,isConnectable:t,targetPosition:o=pe.Top,sourcePosition:a=pe.Bottom})=>X.createElement(X.Fragment,null,X.createElement(Ot,{type:"target",position:o,isConnectable:t}),e?.label,X.createElement(Ot,{type:"source",position:a,isConnectable:t}));Hs.displayName="DefaultNode";var Oo=F.memo(Hs);const Vs=({data:e,isConnectable:t,sourcePosition:o=pe.Bottom})=>X.createElement(X.Fragment,null,e?.label,X.createElement(Ot,{type:"source",position:o,isConnectable:t}));Vs.displayName="InputNode";var Ws=F.memo(Vs);const $s=({data:e,isConnectable:t,targetPosition:o=pe.Top})=>X.createElement(X.Fragment,null,X.createElement(Ot,{type:"target",position:o,isConnectable:t}),e?.label);$s.displayName="OutputNode";var Xs=F.memo($s);const ui=()=>null;ui.displayName="GroupNode";const hh=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),mr=e=>e.id;function ph(e,t){return Be(e.selectedNodes.map(mr),t.selectedNodes.map(mr))&&Be(e.selectedEdges.map(mr),t.selectedEdges.map(mr))}const Ys=F.memo(({onSelectionChange:e})=>{const t=Oe(),{selectedNodes:o,selectedEdges:a}=Ie(hh,ph);return F.useEffect(()=>{const r={nodes:o,edges:a};e?.(r),t.getState().onSelectionChange.forEach(n=>n(r))},[o,a,e]),null});Ys.displayName="SelectionListener";const gh=e=>!!e.onSelectionChange;function mh({onSelectionChange:e}){const t=Ie(gh);return e||t?X.createElement(Ys,{onSelectionChange:e}):null}const yh=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Jt(e,t){F.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Ee(e,t,o){F.useEffect(()=>{typeof t<"u"&&o({[e]:t})},[t])}const vh=({nodes:e,edges:t,defaultNodes:o,defaultEdges:a,onConnect:r,onConnectStart:n,onConnectEnd:i,onClickConnectStart:c,onClickConnectEnd:s,nodesDraggable:l,nodesConnectable:u,nodesFocusable:d,edgesFocusable:f,edgesUpdatable:p,elevateNodesOnSelect:y,minZoom:m,maxZoom:v,nodeExtent:_,onNodesChange:w,onEdgesChange:C,elementsSelectable:x,connectionMode:A,snapGrid:D,snapToGrid:S,translateExtent:P,connectOnClick:I,defaultEdgeOptions:j,fitView:H,fitViewOptions:T,onNodesDelete:U,onEdgesDelete:g,onNodeDrag:k,onNodeDragStart:E,onNodeDragStop:B,onSelectionDrag:G,onSelectionDragStart:N,onSelectionDragStop:R,noPanClassName:b,nodeOrigin:M,rfId:O,autoPanOnConnect:L,autoPanOnNodeDrag:z,onError:$,connectionRadius:V,isValidConnection:Y,nodeDragThreshold:Z})=>{const{setNodes:Q,setEdges:J,setDefaultNodesAndEdges:q,setMinZoom:ge,setMaxZoom:se,setTranslateExtent:ee,setNodeExtent:oe,reset:te}=Ie(yh,Be),W=Oe();return F.useEffect(()=>{const re=a?.map(ae=>({...ae,...j}));return q(o,re),()=>{te()}},[]),Ee("defaultEdgeOptions",j,W.setState),Ee("connectionMode",A,W.setState),Ee("onConnect",r,W.setState),Ee("onConnectStart",n,W.setState),Ee("onConnectEnd",i,W.setState),Ee("onClickConnectStart",c,W.setState),Ee("onClickConnectEnd",s,W.setState),Ee("nodesDraggable",l,W.setState),Ee("nodesConnectable",u,W.setState),Ee("nodesFocusable",d,W.setState),Ee("edgesFocusable",f,W.setState),Ee("edgesUpdatable",p,W.setState),Ee("elementsSelectable",x,W.setState),Ee("elevateNodesOnSelect",y,W.setState),Ee("snapToGrid",S,W.setState),Ee("snapGrid",D,W.setState),Ee("onNodesChange",w,W.setState),Ee("onEdgesChange",C,W.setState),Ee("connectOnClick",I,W.setState),Ee("fitViewOnInit",H,W.setState),Ee("fitViewOnInitOptions",T,W.setState),Ee("onNodesDelete",U,W.setState),Ee("onEdgesDelete",g,W.setState),Ee("onNodeDrag",k,W.setState),Ee("onNodeDragStart",E,W.setState),Ee("onNodeDragStop",B,W.setState),Ee("onSelectionDrag",G,W.setState),Ee("onSelectionDragStart",N,W.setState),Ee("onSelectionDragStop",R,W.setState),Ee("noPanClassName",b,W.setState),Ee("nodeOrigin",M,W.setState),Ee("rfId",O,W.setState),Ee("autoPanOnConnect",L,W.setState),Ee("autoPanOnNodeDrag",z,W.setState),Ee("onError",$,W.setState),Ee("connectionRadius",V,W.setState),Ee("isValidConnection",Y,W.setState),Ee("nodeDragThreshold",Z,W.setState),Jt(e,Q),Jt(t,J),Jt(m,ge),Jt(v,se),Jt(P,ee),Jt(_,oe),null},ca={display:"none"},xh={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},qs="react-flow__node-desc",Ks="react-flow__edge-desc",_h="react-flow__aria-live",bh=e=>e.ariaLiveMessage;function wh({rfId:e}){const t=Ie(bh);return X.createElement("div",{id:`${_h}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:xh},t)}function Sh({rfId:e,disableKeyboardA11y:t}){return X.createElement(X.Fragment,null,X.createElement("div",{id:`${qs}-${e}`,style:ca},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),X.createElement("div",{id:`${Ks}-${e}`,style:ca},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&X.createElement(wh,{rfId:e}))}var Zn=(e=null,t={actInsideInputWithModifier:!0})=>{const[o,a]=F.useState(!1),r=F.useRef(!1),n=F.useRef(new Set([])),[i,c]=F.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),u=l.reduce((d,f)=>d.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return F.useEffect(()=>{const s=typeof document<"u"?document:null,l=t?.target||s;if(e!==null){const u=p=>{if(r.current=p.ctrlKey||p.metaKey||p.shiftKey,(!r.current||r.current&&!t.actInsideInputWithModifier)&&Io(p))return!1;const m=ua(p.code,c);n.current.add(p[m]),la(i,n.current,!1)&&(p.preventDefault(),a(!0))},d=p=>{if((!r.current||r.current&&!t.actInsideInputWithModifier)&&Io(p))return!1;const m=ua(p.code,c);la(i,n.current,!0)?(a(!1),n.current.clear()):n.current.delete(p[m]),p.key==="Meta"&&n.current.clear(),r.current=!1},f=()=>{n.current.clear(),a(!1)};return l?.addEventListener("keydown",u),l?.addEventListener("keyup",d),window.addEventListener("blur",f),()=>{l?.removeEventListener("keydown",u),l?.removeEventListener("keyup",d),window.removeEventListener("blur",f)}}},[e,a]),o};function la(e,t,o){return e.filter(a=>o||a.length===t.size).some(a=>a.every(r=>t.has(r)))}function ua(e,t){return t.includes(e)?"code":"key"}function Zs(e,t,o,a){const r=e.parentNode||e.parentId;if(!r)return o;const n=t.get(r),i=Ft(n,a);return Zs(n,t,{x:(o.x??0)+i.x,y:(o.y??0)+i.y,z:(n[je]?.z??0)>(o.z??0)?n[je]?.z??0:o.z??0},a)}function Js(e,t,o){e.forEach(a=>{const r=a.parentNode||a.parentId;if(r&&!e.has(r))throw new Error(`Parent node ${r} not found`);if(r||o?.[a.id]){const{x:n,y:i,z:c}=Zs(a,e,{...a.position,z:a[je]?.z??0},t);a.positionAbsolute={x:n,y:i},a[je].z=c,o?.[a.id]&&(a[je].isParent=!0)}})}function yo(e,t,o,a){const r=new Map,n={},i=a?1e3:0;return e.forEach(c=>{const s=(et(c.zIndex)?c.zIndex:0)+(c.selected?i:0),l=t.get(c.id),u={...c,positionAbsolute:{x:c.position.x,y:c.position.y}},d=c.parentNode||c.parentId;d&&(n[d]=!0);const f=l?.type&&l?.type!==c.type;Object.defineProperty(u,je,{enumerable:!1,value:{handleBounds:f?void 0:l?.[je]?.handleBounds,z:s}}),r.set(c.id,u)}),Js(r,o,n),r}function Qs(e,t={}){const{getNodes:o,width:a,height:r,minZoom:n,maxZoom:i,d3Zoom:c,d3Selection:s,fitViewOnInitDone:l,fitViewOnInit:u,nodeOrigin:d}=e(),f=t.initial&&!l&&u;if(c&&s&&(f||!t.initial)){const y=o().filter(v=>{const _=t.includeHiddenNodes?v.width&&v.height:!v.hidden;return t.nodes?.length?_&&t.nodes.some(w=>w.id===v.id):_}),m=y.every(v=>v.width&&v.height);if(y.length>0&&m){const v=Wr(y,d),{x:_,y:w,zoom:C}=Os(v,a,r,t.minZoom??n,t.maxZoom??i,t.padding??.1),x=xt.translate(_,w).scale(C);return typeof t.duration=="number"&&t.duration>0?c.transform(Rt(s,t.duration),x):c.transform(s,x),!0}}return!1}function Ch(e,t){return e.forEach(o=>{const a=t.get(o.id);a&&t.set(a.id,{...a,[je]:a[je],selected:o.selected})}),new Map(t)}function Eh(e,t){return t.map(o=>{const a=e.find(r=>r.id===o.id);return a&&(o.selected=a.selected),o})}function yr({changedNodes:e,changedEdges:t,get:o,set:a}){const{nodeInternals:r,edges:n,onNodesChange:i,onEdgesChange:c,hasDefaultNodes:s,hasDefaultEdges:l}=o();e?.length&&(s&&a({nodeInternals:Ch(e,r)}),i?.(e)),t?.length&&(l&&a({edges:Eh(t,n)}),c?.(t))}const Qt=()=>{},Nh={zoomIn:Qt,zoomOut:Qt,zoomTo:Qt,getZoom:()=>1,setViewport:Qt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Qt,fitBounds:Qt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},kh=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Ah=()=>{const e=Oe(),{d3Zoom:t,d3Selection:o}=Ie(kh,Be);return F.useMemo(()=>o&&t?{zoomIn:r=>t.scaleBy(Rt(o,r?.duration),1.2),zoomOut:r=>t.scaleBy(Rt(o,r?.duration),1/1.2),zoomTo:(r,n)=>t.scaleTo(Rt(o,n?.duration),r),getZoom:()=>e.getState().transform[2],setViewport:(r,n)=>{const[i,c,s]=e.getState().transform,l=xt.translate(r.x??i,r.y??c).scale(r.zoom??s);t.transform(Rt(o,n?.duration),l)},getViewport:()=>{const[r,n,i]=e.getState().transform;return{x:r,y:n,zoom:i}},fitView:r=>Qs(e.getState,r),setCenter:(r,n,i)=>{const{width:c,height:s,maxZoom:l}=e.getState(),u=typeof i?.zoom<"u"?i.zoom:l,d=c/2-r*u,f=s/2-n*u,p=xt.translate(d,f).scale(u);t.transform(Rt(o,i?.duration),p)},fitBounds:(r,n)=>{const{width:i,height:c,minZoom:s,maxZoom:l}=e.getState(),{x:u,y:d,zoom:f}=Os(r,i,c,s,l,n?.padding??.1),p=xt.translate(u,d).scale(f);t.transform(Rt(o,n?.duration),p)},project:r=>{const{transform:n,snapToGrid:i,snapGrid:c}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Fo(r,n,i,c)},screenToFlowPosition:r=>{const{transform:n,snapToGrid:i,snapGrid:c,domNode:s}=e.getState();if(!s)return r;const{x:l,y:u}=s.getBoundingClientRect(),d={x:r.x-l,y:r.y-u};return Fo(d,n,i,c)},flowToScreenPosition:r=>{const{transform:n,domNode:i}=e.getState();if(!i)return r;const{x:c,y:s}=i.getBoundingClientRect(),l=Us(r,n);return{x:l.x+c,y:l.y+s}},viewportInitialized:!0}:Nh,[t,o])};function di(){const e=Ah(),t=Oe(),o=F.useCallback(()=>t.getState().getNodes().map(m=>({...m})),[]),a=F.useCallback(m=>t.getState().nodeInternals.get(m),[]),r=F.useCallback(()=>{const{edges:m=[]}=t.getState();return m.map(v=>({...v}))},[]),n=F.useCallback(m=>{const{edges:v=[]}=t.getState();return v.find(_=>_.id===m)},[]),i=F.useCallback(m=>{const{getNodes:v,setNodes:_,hasDefaultNodes:w,onNodesChange:C}=t.getState(),x=v(),A=typeof m=="function"?m(x):m;if(w)_(A);else if(C){const D=A.length===0?x.map(S=>({type:"remove",id:S.id})):A.map(S=>({item:S,type:"reset"}));C(D)}},[]),c=F.useCallback(m=>{const{edges:v=[],setEdges:_,hasDefaultEdges:w,onEdgesChange:C}=t.getState(),x=typeof m=="function"?m(v):m;if(w)_(x);else if(C){const A=x.length===0?v.map(D=>({type:"remove",id:D.id})):x.map(D=>({item:D,type:"reset"}));C(A)}},[]),s=F.useCallback(m=>{const v=Array.isArray(m)?m:[m],{getNodes:_,setNodes:w,hasDefaultNodes:C,onNodesChange:x}=t.getState();if(C){const D=[..._(),...v];w(D)}else if(x){const A=v.map(D=>({item:D,type:"add"}));x(A)}},[]),l=F.useCallback(m=>{const v=Array.isArray(m)?m:[m],{edges:_=[],setEdges:w,hasDefaultEdges:C,onEdgesChange:x}=t.getState();if(C)w([..._,...v]);else if(x){const A=v.map(D=>({item:D,type:"add"}));x(A)}},[]),u=F.useCallback(()=>{const{getNodes:m,edges:v=[],transform:_}=t.getState(),[w,C,x]=_;return{nodes:m().map(A=>({...A})),edges:v.map(A=>({...A})),viewport:{x:w,y:C,zoom:x}}},[]),d=F.useCallback(({nodes:m,edges:v})=>{const{nodeInternals:_,getNodes:w,edges:C,hasDefaultNodes:x,hasDefaultEdges:A,onNodesDelete:D,onEdgesDelete:S,onNodesChange:P,onEdgesChange:I}=t.getState(),j=(m||[]).map(k=>k.id),H=(v||[]).map(k=>k.id),T=w().reduce((k,E)=>{const B=E.parentNode||E.parentId,G=!j.includes(E.id)&&B&&k.find(R=>R.id===B);return(typeof E.deletable=="boolean"?E.deletable:!0)&&(j.includes(E.id)||G)&&k.push(E),k},[]),U=C.filter(k=>typeof k.deletable=="boolean"?k.deletable:!0),g=U.filter(k=>H.includes(k.id));if(T||g){const k=Fs(T,U),E=[...g,...k],B=E.reduce((G,N)=>(G.includes(N.id)||G.push(N.id),G),[]);if((A||x)&&(A&&t.setState({edges:C.filter(G=>!B.includes(G.id))}),x&&(T.forEach(G=>{_.delete(G.id)}),t.setState({nodeInternals:new Map(_)}))),B.length>0&&(S?.(E),I&&I(B.map(G=>({id:G,type:"remove"})))),T.length>0&&(D?.(T),P)){const G=T.map(N=>({id:N.id,type:"remove"}));P(G)}}},[]),f=F.useCallback(m=>{const v=qf(m),_=v?null:t.getState().nodeInternals.get(m.id);return!v&&!_?[null,null,v]:[v?m:ta(_),_,v]},[]),p=F.useCallback((m,v=!0,_)=>{const[w,C,x]=f(m);return w?(_||t.getState().getNodes()).filter(A=>{if(!x&&(A.id===C.id||!A.positionAbsolute))return!1;const D=ta(A),S=Ro(D,w);return v&&S>0||S>=w.width*w.height}):[]},[]),y=F.useCallback((m,v,_=!0)=>{const[w]=f(m);if(!w)return!1;const C=Ro(w,v);return _&&C>0||C>=w.width*w.height},[]);return F.useMemo(()=>({...e,getNodes:o,getNode:a,getEdges:r,getEdge:n,setNodes:i,setEdges:c,addNodes:s,addEdges:l,toObject:u,deleteElements:d,getIntersectingNodes:p,isNodeIntersecting:y}),[e,o,a,r,n,i,c,s,l,u,d,p,y])}const Th={actInsideInputWithModifier:!1};var Mh=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const o=Oe(),{deleteElements:a}=di(),r=Zn(e,Th),n=Zn(t);F.useEffect(()=>{if(r){const{edges:i,getNodes:c}=o.getState(),s=c().filter(u=>u.selected),l=i.filter(u=>u.selected);a({nodes:s,edges:l}),o.setState({nodesSelectionActive:!1})}},[r]),F.useEffect(()=>{o.setState({multiSelectionActive:n})},[n])};function Ph(e){const t=Oe();F.useEffect(()=>{let o;const a=()=>{if(!e.current)return;const r=ni(e.current);(r.height===0||r.width===0)&&t.getState().onError?.("004",bt.error004()),t.setState({width:r.width||500,height:r.height||500})};return a(),window.addEventListener("resize",a),e.current&&(o=new ResizeObserver(()=>a()),o.observe(e.current)),()=>{window.removeEventListener("resize",a),o&&e.current&&o.unobserve(e.current)}},[])}const fi={position:"absolute",width:"100%",height:"100%",top:0,left:0},Dh=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,vr=e=>({x:e.x,y:e.y,zoom:e.k}),en=(e,t)=>e.target.closest(`.${t}`),da=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),fa=e=>{const t=e.ctrlKey&&jr()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Rh=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Ih=({onMove:e,onMoveStart:t,onMoveEnd:o,onPaneContextMenu:a,zoomOnScroll:r=!0,zoomOnPinch:n=!0,panOnScroll:i=!1,panOnScrollSpeed:c=.5,panOnScrollMode:s=Ut.Free,zoomOnDoubleClick:l=!0,elementsSelectable:u,panOnDrag:d=!0,defaultViewport:f,translateExtent:p,minZoom:y,maxZoom:m,zoomActivationKeyCode:v,preventScrolling:_=!0,children:w,noWheelClassName:C,noPanClassName:x})=>{const A=F.useRef(),D=Oe(),S=F.useRef(!1),P=F.useRef(!1),I=F.useRef(null),j=F.useRef({x:0,y:0,zoom:0}),{d3Zoom:H,d3Selection:T,d3ZoomHandler:U,userSelectionActive:g}=Ie(Rh,Be),k=Zn(v),E=F.useRef(0),B=F.useRef(!1),G=F.useRef();return Ph(I),F.useEffect(()=>{if(I.current){const N=I.current.getBoundingClientRect(),R=Ss().scaleExtent([y,m]).translateExtent(p),b=Qe(I.current).call(R),M=xt.translate(f.x,f.y).scale(dn(f.zoom,y,m)),O=[[0,0],[N.width,N.height]],L=R.constrain()(M,O,p);R.transform(b,L),R.wheelDelta(fa),D.setState({d3Zoom:R,d3Selection:b,d3ZoomHandler:b.on("wheel.zoom"),transform:[L.x,L.y,L.k],domNode:I.current.closest(".react-flow")})}},[]),F.useEffect(()=>{T&&H&&(i&&!k&&!g?T.on("wheel.zoom",N=>{if(en(N,C))return!1;N.preventDefault(),N.stopImmediatePropagation();const R=T.property("__zoom").k||1;if(N.ctrlKey&&n){const Y=at(N),Z=fa(N),Q=R*Math.pow(2,Z);H.scaleTo(T,Q,Y,N);return}const b=N.deltaMode===1?20:1;let M=s===Ut.Vertical?0:N.deltaX*b,O=s===Ut.Horizontal?0:N.deltaY*b;!jr()&&N.shiftKey&&s!==Ut.Vertical&&(M=N.deltaY*b,O=0),H.translateBy(T,-(M/R)*c,-(O/R)*c,{internal:!0});const L=vr(T.property("__zoom")),{onViewportChangeStart:z,onViewportChange:$,onViewportChangeEnd:V}=D.getState();clearTimeout(G.current),B.current||(B.current=!0,t?.(N,L),z?.(L)),B.current&&(e?.(N,L),$?.(L),G.current=setTimeout(()=>{o?.(N,L),V?.(L),B.current=!1},150))},{passive:!1}):typeof U<"u"&&T.on("wheel.zoom",function(N,R){if(!_&&N.type==="wheel"&&!N.ctrlKey||en(N,C))return null;N.preventDefault(),U.call(this,N,R)},{passive:!1}))},[g,i,s,T,H,U,k,n,_,C,t,e,o]),F.useEffect(()=>{H&&H.on("start",N=>{if(!N.sourceEvent||N.sourceEvent.internal)return null;E.current=N.sourceEvent?.button;const{onViewportChangeStart:R}=D.getState(),b=vr(N.transform);S.current=!0,j.current=b,N.sourceEvent?.type==="mousedown"&&D.setState({paneDragging:!0}),R?.(b),t?.(N.sourceEvent,b)})},[H,t]),F.useEffect(()=>{H&&(g&&!S.current?H.on("zoom",null):g||H.on("zoom",N=>{const{onViewportChange:R}=D.getState();if(D.setState({transform:[N.transform.x,N.transform.y,N.transform.k]}),P.current=!!(a&&da(d,E.current??0)),(e||R)&&!N.sourceEvent?.internal){const b=vr(N.transform);R?.(b),e?.(N.sourceEvent,b)}}))},[g,H,e,d,a]),F.useEffect(()=>{H&&H.on("end",N=>{if(!N.sourceEvent||N.sourceEvent.internal)return null;const{onViewportChangeEnd:R}=D.getState();if(S.current=!1,D.setState({paneDragging:!1}),a&&da(d,E.current??0)&&!P.current&&a(N.sourceEvent),P.current=!1,(o||R)&&Dh(j.current,N.transform)){const b=vr(N.transform);j.current=b,clearTimeout(A.current),A.current=setTimeout(()=>{R?.(b),o?.(N.sourceEvent,b)},i?150:0)}})},[H,i,d,o,a]),F.useEffect(()=>{H&&H.filter(N=>{const R=k||r,b=n&&N.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&N.button===1&&N.type==="mousedown"&&(en(N,"react-flow__node")||en(N,"react-flow__edge")))return!0;if(!d&&!R&&!i&&!l&&!n||g||!l&&N.type==="dblclick"||en(N,C)&&N.type==="wheel"||en(N,x)&&(N.type!=="wheel"||i&&N.type==="wheel"&&!k)||!n&&N.ctrlKey&&N.type==="wheel"||!R&&!i&&!b&&N.type==="wheel"||!d&&(N.type==="mousedown"||N.type==="touchstart")||Array.isArray(d)&&!d.includes(N.button)&&N.type==="mousedown")return!1;const M=Array.isArray(d)&&d.includes(N.button)||!N.button||N.button<=1;return(!N.ctrlKey||N.type==="wheel")&&M})},[g,H,r,n,i,l,d,u,k]),X.createElement("div",{className:"react-flow__renderer",ref:I,style:fi},w)},Uh=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function jh(){const{userSelectionActive:e,userSelectionRect:t}=Ie(Uh,Be);return e&&t?X.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function ha(e,t){const o=t.parentNode||t.parentId,a=e.find(r=>r.id===o);if(a){const r=t.position.x+t.width-a.width,n=t.position.y+t.height-a.height;if(r>0||n>0||t.position.x<0||t.position.y<0){if(a.style={...a.style},a.style.width=a.style.width??a.width,a.style.height=a.style.height??a.height,r>0&&(a.style.width+=r),n>0&&(a.style.height+=n),t.position.x<0){const i=Math.abs(t.position.x);a.position.x=a.position.x-i,a.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);a.position.y=a.position.y-i,a.style.height+=i,t.position.y=0}a.width=a.style.width,a.height=a.style.height}}}function ec(e,t){if(e.some(a=>a.type==="reset"))return e.filter(a=>a.type==="reset").map(a=>a.item);const o=e.filter(a=>a.type==="add").map(a=>a.item);return t.reduce((a,r)=>{const n=e.filter(c=>c.id===r.id);if(n.length===0)return a.push(r),a;const i={...r};for(const c of n)if(c)switch(c.type){case"select":{i.selected=c.selected;break}case"position":{typeof c.position<"u"&&(i.position=c.position),typeof c.positionAbsolute<"u"&&(i.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(i.dragging=c.dragging),i.expandParent&&ha(a,i);break}case"dimensions":{typeof c.dimensions<"u"&&(i.width=c.dimensions.width,i.height=c.dimensions.height),typeof c.updateStyle<"u"&&(i.style={...i.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(i.resizing=c.resizing),i.expandParent&&ha(a,i);break}case"remove":return a}return a.push(i),a},o)}function tc(e,t){return ec(e,t)}function Fh(e,t){return ec(e,t)}const At=(e,t)=>({id:e,type:"select",selected:t});function on(e,t){return e.reduce((o,a)=>{const r=t.includes(a.id);return!a.selected&&r?(a.selected=!0,o.push(At(a.id,!0))):a.selected&&!r&&(a.selected=!1,o.push(At(a.id,!1))),o},[])}const vo=(e,t)=>o=>{o.target===t.current&&e?.(o)},Oh=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),nc=F.memo(({isSelecting:e,selectionMode:t=Kn.Full,panOnDrag:o,onSelectionStart:a,onSelectionEnd:r,onPaneClick:n,onPaneContextMenu:i,onPaneScroll:c,onPaneMouseEnter:s,onPaneMouseMove:l,onPaneMouseLeave:u,children:d})=>{const f=F.useRef(null),p=Oe(),y=F.useRef(0),m=F.useRef(0),v=F.useRef(),{userSelectionActive:_,elementsSelectable:w,dragging:C}=Ie(Oh,Be),x=()=>{p.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,m.current=0},A=U=>{n?.(U),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},D=U=>{if(Array.isArray(o)&&o?.includes(2)){U.preventDefault();return}i?.(U)},S=c?U=>c(U):void 0,P=U=>{const{resetSelectedElements:g,domNode:k}=p.getState();if(v.current=k?.getBoundingClientRect(),!w||!e||U.button!==0||U.target!==f.current||!v.current)return;const{x:E,y:B}=Mt(U,v.current);g(),p.setState({userSelectionRect:{width:0,height:0,startX:E,startY:B,x:E,y:B}}),a?.(U)},I=U=>{const{userSelectionRect:g,nodeInternals:k,edges:E,transform:B,onNodesChange:G,onEdgesChange:N,nodeOrigin:R,getNodes:b}=p.getState();if(!e||!v.current||!g)return;p.setState({userSelectionActive:!0,nodesSelectionActive:!1});const M=Mt(U,v.current),O=g.startX??0,L=g.startY??0,z={...g,x:M.x<O?M.x:O,y:M.y<L?M.y:L,width:Math.abs(M.x-O),height:Math.abs(M.y-L)},$=b(),V=js(k,z,B,t===Kn.Partial,!0,R),Y=Fs(V,E).map(Q=>Q.id),Z=V.map(Q=>Q.id);if(y.current!==Z.length){y.current=Z.length;const Q=on($,Z);Q.length&&G?.(Q)}if(m.current!==Y.length){m.current=Y.length;const Q=on(E,Y);Q.length&&N?.(Q)}p.setState({userSelectionRect:z})},j=U=>{if(U.button!==0)return;const{userSelectionRect:g}=p.getState();!_&&g&&U.target===f.current&&A?.(U),p.setState({nodesSelectionActive:y.current>0}),x(),r?.(U)},H=U=>{_&&(p.setState({nodesSelectionActive:y.current>0}),r?.(U)),x()},T=w&&(e||_);return X.createElement("div",{className:We(["react-flow__pane",{dragging:C,selection:e}]),onClick:T?void 0:vo(A,f),onContextMenu:vo(D,f),onWheel:vo(S,f),onMouseEnter:T?void 0:s,onMouseDown:T?P:void 0,onMouseMove:T?I:l,onMouseUp:T?j:void 0,onMouseLeave:T?H:u,ref:f,style:fi},d,X.createElement(jh,null))});nc.displayName="Pane";function rc(e,t){const o=e.parentNode||e.parentId;if(!o)return!1;const a=t.get(o);return a?a.selected?!0:rc(a,t):!1}function pa(e,t,o){let a=e;do{if(a?.matches(t))return!0;if(a===o.current)return!1;a=a.parentElement}while(a);return!1}function Lh(e,t,o,a){return Array.from(e.values()).filter(r=>(r.selected||r.id===a)&&(!r.parentNode||r.parentId||!rc(r,e))&&(r.draggable||t&&typeof r.draggable>"u")).map(r=>({id:r.id,position:r.position||{x:0,y:0},positionAbsolute:r.positionAbsolute||{x:0,y:0},distance:{x:o.x-(r.positionAbsolute?.x??0),y:o.y-(r.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:r.extent,parentNode:r.parentNode||r.parentId,parentId:r.parentNode||r.parentId,width:r.width,height:r.height,expandParent:r.expandParent}))}function zh(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function oc(e,t,o,a,r=[0,0],n){const i=zh(e,e.extent||a);let c=i;const s=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(s&&e.width&&e.height){const d=o.get(s),{x:f,y:p}=Ft(d,r).positionAbsolute;c=d&&et(f)&&et(p)&&et(d.width)&&et(d.height)?[[f+e.width*r[0],p+e.height*r[1]],[f+d.width-e.width+e.width*r[0],p+d.height-e.height+e.height*r[1]]]:c}else n?.("005",bt.error005()),c=i;else if(e.extent&&s&&e.extent!=="parent"){const d=o.get(s),{x:f,y:p}=Ft(d,r).positionAbsolute;c=[[e.extent[0][0]+f,e.extent[0][1]+p],[e.extent[1][0]+f,e.extent[1][1]+p]]}let l={x:0,y:0};if(s){const d=o.get(s);l=Ft(d,r).positionAbsolute}const u=c&&c!=="parent"?ri(t,c):t;return{position:{x:u.x-l.x,y:u.y-l.y},positionAbsolute:u}}function xo({nodeId:e,dragItems:t,nodeInternals:o}){const a=t.map(r=>({...o.get(r.id),position:r.position,positionAbsolute:r.positionAbsolute}));return[e?a.find(r=>r.id===e):a[0],a]}const ga=(e,t,o,a)=>{const r=t.querySelectorAll(e);if(!r||!r.length)return null;const n=Array.from(r),i=t.getBoundingClientRect(),c={x:i.width*a[0],y:i.height*a[1]};return n.map(s=>{const l=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),position:s.getAttribute("data-handlepos"),x:(l.left-i.left-c.x)/o,y:(l.top-i.top-c.y)/o,...ni(s)}})};function Rn(e,t,o){return o===void 0?o:a=>{const r=t().nodeInternals.get(e);r&&o(a,{...r})}}function Lo({id:e,store:t,unselect:o=!1,nodeRef:a}){const{addSelectedNodes:r,unselectNodesAndEdges:n,multiSelectionActive:i,nodeInternals:c,onError:s}=t.getState(),l=c.get(e);if(!l){s?.("012",bt.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(o||l.selected&&i)&&(n({nodes:[l],edges:[]}),requestAnimationFrame(()=>a?.current?.blur())):r([e])}function Bh(){const e=Oe();return F.useCallback(({sourceEvent:o})=>{const{transform:a,snapGrid:r,snapToGrid:n}=e.getState(),i=o.touches?o.touches[0].clientX:o.clientX,c=o.touches?o.touches[0].clientY:o.clientY,s={x:(i-a[0])/a[2],y:(c-a[1])/a[2]};return{xSnapped:n?r[0]*Math.round(s.x/r[0]):s.x,ySnapped:n?r[1]*Math.round(s.y/r[1]):s.y,...s}},[])}function _o(e){return(t,o,a)=>e?.(t,a)}function ic({nodeRef:e,disabled:t=!1,noDragClassName:o,handleSelector:a,nodeId:r,isSelectable:n,selectNodesOnDrag:i}){const c=Oe(),[s,l]=F.useState(!1),u=F.useRef([]),d=F.useRef({x:null,y:null}),f=F.useRef(0),p=F.useRef(null),y=F.useRef({x:0,y:0}),m=F.useRef(null),v=F.useRef(!1),_=F.useRef(!1),w=F.useRef(!1),C=Bh();return F.useEffect(()=>{if(e?.current){const x=Qe(e.current),A=({x:P,y:I})=>{const{nodeInternals:j,onNodeDrag:H,onSelectionDrag:T,updateNodePositions:U,nodeExtent:g,snapGrid:k,snapToGrid:E,nodeOrigin:B,onError:G}=c.getState();d.current={x:P,y:I};let N=!1,R={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&g){const M=Wr(u.current,B);R=qn(M)}if(u.current=u.current.map(M=>{const O={x:P-M.distance.x,y:I-M.distance.y};E&&(O.x=k[0]*Math.round(O.x/k[0]),O.y=k[1]*Math.round(O.y/k[1]));const L=[[g[0][0],g[0][1]],[g[1][0],g[1][1]]];u.current.length>1&&g&&!M.extent&&(L[0][0]=M.positionAbsolute.x-R.x+g[0][0],L[1][0]=M.positionAbsolute.x+(M.width??0)-R.x2+g[1][0],L[0][1]=M.positionAbsolute.y-R.y+g[0][1],L[1][1]=M.positionAbsolute.y+(M.height??0)-R.y2+g[1][1]);const z=oc(M,O,j,L,B,G);return N=N||M.position.x!==z.position.x||M.position.y!==z.position.y,M.position=z.position,M.positionAbsolute=z.positionAbsolute,M}),!N)return;U(u.current,!0,!0),l(!0);const b=r?H:_o(T);if(b&&m.current){const[M,O]=xo({nodeId:r,dragItems:u.current,nodeInternals:j});b(m.current,M,O)}},D=()=>{if(!p.current)return;const[P,I]=Es(y.current,p.current);if(P!==0||I!==0){const{transform:j,panBy:H}=c.getState();d.current.x=(d.current.x??0)-P/j[2],d.current.y=(d.current.y??0)-I/j[2],H({x:P,y:I})&&A(d.current)}f.current=requestAnimationFrame(D)},S=P=>{const{nodeInternals:I,multiSelectionActive:j,nodesDraggable:H,unselectNodesAndEdges:T,onNodeDragStart:U,onSelectionDragStart:g}=c.getState();_.current=!0;const k=r?U:_o(g);(!i||!n)&&!j&&r&&(I.get(r)?.selected||T()),r&&n&&i&&Lo({id:r,store:c,nodeRef:e});const E=C(P);if(d.current=E,u.current=Lh(I,H,E,r),k&&u.current){const[B,G]=xo({nodeId:r,dragItems:u.current,nodeInternals:I});k(P.sourceEvent,B,G)}};if(t)x.on(".drag",null);else{const P=Ju().on("start",I=>{const{domNode:j,nodeDragThreshold:H}=c.getState();H===0&&S(I),w.current=!1;const T=C(I);d.current=T,p.current=j?.getBoundingClientRect()||null,y.current=Mt(I.sourceEvent,p.current)}).on("drag",I=>{const j=C(I),{autoPanOnNodeDrag:H,nodeDragThreshold:T}=c.getState();if(I.sourceEvent.type==="touchmove"&&I.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!v.current&&_.current&&H&&(v.current=!0,D()),!_.current){const U=j.xSnapped-(d?.current?.x??0),g=j.ySnapped-(d?.current?.y??0);Math.sqrt(U*U+g*g)>T&&S(I)}(d.current.x!==j.xSnapped||d.current.y!==j.ySnapped)&&u.current&&_.current&&(m.current=I.sourceEvent,y.current=Mt(I.sourceEvent,p.current),A(j))}}).on("end",I=>{if(!(!_.current||w.current)&&(l(!1),v.current=!1,_.current=!1,cancelAnimationFrame(f.current),u.current)){const{updateNodePositions:j,nodeInternals:H,onNodeDragStop:T,onSelectionDragStop:U}=c.getState(),g=r?T:_o(U);if(j(u.current,!1,!1),g){const[k,E]=xo({nodeId:r,dragItems:u.current,nodeInternals:H});g(I.sourceEvent,k,E)}}}).filter(I=>{const j=I.target;return!I.button&&(!o||!pa(j,`.${o}`,e))&&(!a||pa(j,a,e))});return x.call(P),()=>{x.on(".drag",null)}}}},[e,t,o,a,n,c,r,i,C]),s}function ac(){const e=Oe();return F.useCallback(o=>{const{nodeInternals:a,nodeExtent:r,updateNodePositions:n,getNodes:i,snapToGrid:c,snapGrid:s,onError:l,nodesDraggable:u}=e.getState(),d=i().filter(w=>w.selected&&(w.draggable||u&&typeof w.draggable>"u")),f=c?s[0]:5,p=c?s[1]:5,y=o.isShiftPressed?4:1,m=o.x*f*y,v=o.y*p*y,_=d.map(w=>{if(w.positionAbsolute){const C={x:w.positionAbsolute.x+m,y:w.positionAbsolute.y+v};c&&(C.x=s[0]*Math.round(C.x/s[0]),C.y=s[1]*Math.round(C.y/s[1]));const{positionAbsolute:x,position:A}=oc(w,C,a,r,void 0,l);w.position=A,w.positionAbsolute=x}return w});n(_,!0,!1)},[])}const cn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var In=e=>{const t=({id:o,type:a,data:r,xPos:n,yPos:i,xPosOrigin:c,yPosOrigin:s,selected:l,onClick:u,onMouseEnter:d,onMouseMove:f,onMouseLeave:p,onContextMenu:y,onDoubleClick:m,style:v,className:_,isDraggable:w,isSelectable:C,isConnectable:x,isFocusable:A,selectNodesOnDrag:D,sourcePosition:S,targetPosition:P,hidden:I,resizeObserver:j,dragHandle:H,zIndex:T,isParent:U,noDragClassName:g,noPanClassName:k,initialized:E,disableKeyboardA11y:B,ariaLabel:G,rfId:N,hasHandleBounds:R})=>{const b=Oe(),M=F.useRef(null),O=F.useRef(null),L=F.useRef(S),z=F.useRef(P),$=F.useRef(a),V=C||w||u||d||f||p,Y=ac(),Z=Rn(o,b.getState,d),Q=Rn(o,b.getState,f),J=Rn(o,b.getState,p),q=Rn(o,b.getState,y),ge=Rn(o,b.getState,m),se=te=>{const{nodeDragThreshold:W}=b.getState();if(C&&(!D||!w||W>0)&&Lo({id:o,store:b,nodeRef:M}),u){const re=b.getState().nodeInternals.get(o);re&&u(te,{...re})}},ee=te=>{if(!Io(te)&&!B)if(Ts.includes(te.key)&&C){const W=te.key==="Escape";Lo({id:o,store:b,unselect:W,nodeRef:M})}else w&&l&&Object.prototype.hasOwnProperty.call(cn,te.key)&&(b.setState({ariaLiveMessage:`Moved selected node ${te.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~n}, y: ${~~i}`}),Y({x:cn[te.key].x,y:cn[te.key].y,isShiftPressed:te.shiftKey}))};F.useEffect(()=>()=>{O.current&&(j?.unobserve(O.current),O.current=null)},[]),F.useEffect(()=>{if(M.current&&!I){const te=M.current;(!E||!R||O.current!==te)&&(O.current&&j?.unobserve(O.current),j?.observe(te),O.current=te)}},[I,E,R]),F.useEffect(()=>{const te=$.current!==a,W=L.current!==S,re=z.current!==P;M.current&&(te||W||re)&&(te&&($.current=a),W&&(L.current=S),re&&(z.current=P),b.getState().updateNodeDimensions([{id:o,nodeElement:M.current,forceUpdate:!0}]))},[o,a,S,P]);const oe=ic({nodeRef:M,disabled:I||!w,noDragClassName:g,handleSelector:H,nodeId:o,isSelectable:C,selectNodesOnDrag:D});return I?null:X.createElement("div",{className:We(["react-flow__node",`react-flow__node-${a}`,{[k]:w},_,{selected:l,selectable:C,parent:U,dragging:oe}]),ref:M,style:{zIndex:T,transform:`translate(${c}px,${s}px)`,pointerEvents:V?"all":"none",visibility:E?"visible":"hidden",...v},"data-id":o,"data-testid":`rf__node-${o}`,onMouseEnter:Z,onMouseMove:Q,onMouseLeave:J,onContextMenu:q,onClick:se,onDoubleClick:ge,onKeyDown:A?ee:void 0,tabIndex:A?0:void 0,role:A?"button":void 0,"aria-describedby":B?void 0:`${qs}-${N}`,"aria-label":G},X.createElement(nh,{value:o},X.createElement(e,{id:o,data:r,type:a,xPos:n,yPos:i,selected:l,isConnectable:x,sourcePosition:S,targetPosition:P,dragging:oe,dragHandle:H,zIndex:T})))};return t.displayName="NodeWrapper",F.memo(t)};const Gh=e=>{const t=e.getNodes().filter(o=>o.selected);return{...Wr(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Hh({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:o}){const a=Oe(),{width:r,height:n,x:i,y:c,transformString:s,userSelectionActive:l}=Ie(Gh,Be),u=ac(),d=F.useRef(null);if(F.useEffect(()=>{o||d.current?.focus({preventScroll:!0})},[o]),ic({nodeRef:d}),l||!r||!n)return null;const f=e?y=>{const m=a.getState().getNodes().filter(v=>v.selected);e(y,m)}:void 0,p=y=>{Object.prototype.hasOwnProperty.call(cn,y.key)&&u({x:cn[y.key].x,y:cn[y.key].y,isShiftPressed:y.shiftKey})};return X.createElement("div",{className:We(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s}},X.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:o?void 0:-1,onKeyDown:o?void 0:p,style:{width:r,height:n,top:c,left:i}}))}var Vh=F.memo(Hh);const Wh=e=>e.nodesSelectionActive,sc=({children:e,onPaneClick:t,onPaneMouseEnter:o,onPaneMouseMove:a,onPaneMouseLeave:r,onPaneContextMenu:n,onPaneScroll:i,deleteKeyCode:c,onMove:s,onMoveStart:l,onMoveEnd:u,selectionKeyCode:d,selectionOnDrag:f,selectionMode:p,onSelectionStart:y,onSelectionEnd:m,multiSelectionKeyCode:v,panActivationKeyCode:_,zoomActivationKeyCode:w,elementsSelectable:C,zoomOnScroll:x,zoomOnPinch:A,panOnScroll:D,panOnScrollSpeed:S,panOnScrollMode:P,zoomOnDoubleClick:I,panOnDrag:j,defaultViewport:H,translateExtent:T,minZoom:U,maxZoom:g,preventScrolling:k,onSelectionContextMenu:E,noWheelClassName:B,noPanClassName:G,disableKeyboardA11y:N})=>{const R=Ie(Wh),b=Zn(d),M=Zn(_),O=M||j,L=M||D,z=b||f&&O!==!0;return Mh({deleteKeyCode:c,multiSelectionKeyCode:v}),X.createElement(Ih,{onMove:s,onMoveStart:l,onMoveEnd:u,onPaneContextMenu:n,elementsSelectable:C,zoomOnScroll:x,zoomOnPinch:A,panOnScroll:L,panOnScrollSpeed:S,panOnScrollMode:P,zoomOnDoubleClick:I,panOnDrag:!b&&O,defaultViewport:H,translateExtent:T,minZoom:U,maxZoom:g,zoomActivationKeyCode:w,preventScrolling:k,noWheelClassName:B,noPanClassName:G},X.createElement(nc,{onSelectionStart:y,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:o,onPaneMouseMove:a,onPaneMouseLeave:r,onPaneContextMenu:n,onPaneScroll:i,panOnDrag:O,isSelecting:!!z,selectionMode:p},e,R&&X.createElement(Vh,{onSelectionContextMenu:E,noPanClassName:G,disableKeyboardA11y:N})))};sc.displayName="FlowRenderer";var $h=F.memo(sc);function Xh(e){return Ie(F.useCallback(o=>e?js(o.nodeInternals,{x:0,y:0,width:o.width,height:o.height},o.transform,!0):o.getNodes(),[e]))}function Yh(e){const t={input:In(e.input||Ws),default:In(e.default||Oo),output:In(e.output||Xs),group:In(e.group||ui)},o={},a=Object.keys(e).filter(r=>!["input","default","output","group"].includes(r)).reduce((r,n)=>(r[n]=In(e[n]||Oo),r),o);return{...t,...a}}const qh=({x:e,y:t,width:o,height:a,origin:r})=>!o||!a?{x:e,y:t}:r[0]<0||r[1]<0||r[0]>1||r[1]>1?{x:e,y:t}:{x:e-o*r[0],y:t-a*r[1]},Kh=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),cc=e=>{const{nodesDraggable:t,nodesConnectable:o,nodesFocusable:a,elementsSelectable:r,updateNodeDimensions:n,onError:i}=Ie(Kh,Be),c=Xh(e.onlyRenderVisibleElements),s=F.useRef(),l=F.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(d=>{const f=d.map(p=>({id:p.target.getAttribute("data-id"),nodeElement:p.target,forceUpdate:!0}));n(f)});return s.current=u,u},[]);return F.useEffect(()=>()=>{s?.current?.disconnect()},[]),X.createElement("div",{className:"react-flow__nodes",style:fi},c.map(u=>{let d=u.type||"default";e.nodeTypes[d]||(i?.("003",bt.error003(d)),d="default");const f=e.nodeTypes[d]||e.nodeTypes.default,p=!!(u.draggable||t&&typeof u.draggable>"u"),y=!!(u.selectable||r&&typeof u.selectable>"u"),m=!!(u.connectable||o&&typeof u.connectable>"u"),v=!!(u.focusable||a&&typeof u.focusable>"u"),_=e.nodeExtent?ri(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,w=_?.x??0,C=_?.y??0,x=qh({x:w,y:C,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return X.createElement(f,{key:u.id,id:u.id,className:u.className,style:u.style,type:d,data:u.data,sourcePosition:u.sourcePosition||pe.Bottom,targetPosition:u.targetPosition||pe.Top,hidden:u.hidden,xPos:w,yPos:C,xPosOrigin:x.x,yPosOrigin:x.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:p,isSelectable:y,isConnectable:m,isFocusable:v,resizeObserver:l,dragHandle:u.dragHandle,zIndex:u[je]?.z??0,isParent:!!u[je]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!u[je]?.handleBounds})}))};cc.displayName="NodeRenderer";var Zh=F.memo(cc);const Jh=(e,t,o)=>o===pe.Left?e-t:o===pe.Right?e+t:e,Qh=(e,t,o)=>o===pe.Top?e-t:o===pe.Bottom?e+t:e,ma="react-flow__edgeupdater",ya=({position:e,centerX:t,centerY:o,radius:a=10,onMouseDown:r,onMouseEnter:n,onMouseOut:i,type:c})=>X.createElement("circle",{onMouseDown:r,onMouseEnter:n,onMouseOut:i,className:We([ma,`${ma}-${c}`]),cx:Jh(t,a,e),cy:Qh(o,a,e),r:a,stroke:"transparent",fill:"transparent"}),ep=()=>!0;var tn=e=>{const t=({id:o,className:a,type:r,data:n,onClick:i,onEdgeDoubleClick:c,selected:s,animated:l,label:u,labelStyle:d,labelShowBg:f,labelBgStyle:p,labelBgPadding:y,labelBgBorderRadius:m,style:v,source:_,target:w,sourceX:C,sourceY:x,targetX:A,targetY:D,sourcePosition:S,targetPosition:P,elementsSelectable:I,hidden:j,sourceHandleId:H,targetHandleId:T,onContextMenu:U,onMouseEnter:g,onMouseMove:k,onMouseLeave:E,reconnectRadius:B,onReconnect:G,onReconnectStart:N,onReconnectEnd:R,markerEnd:b,markerStart:M,rfId:O,ariaLabel:L,isFocusable:z,isReconnectable:$,pathOptions:V,interactionWidth:Y,disableKeyboardA11y:Z})=>{const Q=F.useRef(null),[J,q]=F.useState(!1),[ge,se]=F.useState(!1),ee=Oe(),oe=F.useMemo(()=>`url('#${jo(M,O)}')`,[M,O]),te=F.useMemo(()=>`url('#${jo(b,O)}')`,[b,O]);if(j)return null;const W=be=>{const{edges:ke,addSelectedEdges:xe,unselectNodesAndEdges:_e,multiSelectionActive:de}=ee.getState(),Ae=ke.find(Me=>Me.id===o);Ae&&(I&&(ee.setState({nodesSelectionActive:!1}),Ae.selected&&de?(_e({nodes:[],edges:[Ae]}),Q.current?.blur()):xe([o])),i&&i(be,Ae))},re=Dn(o,ee.getState,c),ae=Dn(o,ee.getState,U),K=Dn(o,ee.getState,g),ye=Dn(o,ee.getState,k),ie=Dn(o,ee.getState,E),ce=(be,ke)=>{if(be.button!==0)return;const{edges:xe,isValidConnection:_e}=ee.getState(),de=ke?w:_,Ae=(ke?T:H)||null,Me=ke?"target":"source",Le=_e||ep,Pe=ke,me=xe.find(Ne=>Ne.id===o);se(!0),N?.(be,me,Me);const Te=Ne=>{se(!1),R?.(Ne,me,Me)};Bs({event:be,handleId:Ae,nodeId:de,onConnect:Ne=>G?.(me,Ne),isTarget:Pe,getState:ee.getState,setState:ee.setState,isValidConnection:Le,edgeUpdaterType:Me,onReconnectEnd:Te})},ne=be=>ce(be,!0),Se=be=>ce(be,!1),le=()=>q(!0),ue=()=>q(!1),fe=!I&&!i,ve=be=>{if(!Z&&Ts.includes(be.key)&&I){const{unselectNodesAndEdges:ke,addSelectedEdges:xe,edges:_e}=ee.getState();be.key==="Escape"?(Q.current?.blur(),ke({edges:[_e.find(Ae=>Ae.id===o)]})):xe([o])}};return X.createElement("g",{className:We(["react-flow__edge",`react-flow__edge-${r}`,a,{selected:s,animated:l,inactive:fe,updating:J}]),onClick:W,onDoubleClick:re,onContextMenu:ae,onMouseEnter:K,onMouseMove:ye,onMouseLeave:ie,onKeyDown:z?ve:void 0,tabIndex:z?0:void 0,role:z?"button":"img","data-testid":`rf__edge-${o}`,"aria-label":L===null?void 0:L||`Edge from ${_} to ${w}`,"aria-describedby":z?`${Ks}-${O}`:void 0,ref:Q},!ge&&X.createElement(e,{id:o,source:_,target:w,selected:s,animated:l,label:u,labelStyle:d,labelShowBg:f,labelBgStyle:p,labelBgPadding:y,labelBgBorderRadius:m,data:n,style:v,sourceX:C,sourceY:x,targetX:A,targetY:D,sourcePosition:S,targetPosition:P,sourceHandleId:H,targetHandleId:T,markerStart:oe,markerEnd:te,pathOptions:V,interactionWidth:Y}),$&&X.createElement(X.Fragment,null,($==="source"||$===!0)&&X.createElement(ya,{position:S,centerX:C,centerY:x,radius:B,onMouseDown:ne,onMouseEnter:le,onMouseOut:ue,type:"source"}),($==="target"||$===!0)&&X.createElement(ya,{position:P,centerX:A,centerY:D,radius:B,onMouseDown:Se,onMouseEnter:le,onMouseOut:ue,type:"target"})))};return t.displayName="EdgeWrapper",F.memo(t)};function tp(e){const t={default:tn(e.default||Or),straight:tn(e.bezier||ai),step:tn(e.step||ii),smoothstep:tn(e.step||Vr),simplebezier:tn(e.simplebezier||oi)},o={},a=Object.keys(e).filter(r=>!["default","bezier"].includes(r)).reduce((r,n)=>(r[n]=tn(e[n]||Or),r),o);return{...t,...a}}function va(e,t,o=null){const a=(o?.x||0)+t.x,r=(o?.y||0)+t.y,n=o?.width||t.width,i=o?.height||t.height;switch(e){case pe.Top:return{x:a+n/2,y:r};case pe.Right:return{x:a+n,y:r+i/2};case pe.Bottom:return{x:a+n/2,y:r+i};case pe.Left:return{x:a,y:r+i/2}}}function xa(e,t){return e?e.length===1||!t?e[0]:t&&e.find(o=>o.id===t)||null:null}const np=(e,t,o,a,r,n)=>{const i=va(o,e,t),c=va(n,a,r);return{sourceX:i.x,sourceY:i.y,targetX:c.x,targetY:c.y}};function rp({sourcePos:e,targetPos:t,sourceWidth:o,sourceHeight:a,targetWidth:r,targetHeight:n,width:i,height:c,transform:s}){const l={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+o,t.x+r),y2:Math.max(e.y+a,t.y+n)};l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const u=qn({x:(0-s[0])/s[2],y:(0-s[1])/s[2],width:i/s[2],height:c/s[2]}),d=Math.max(0,Math.min(u.x2,l.x2)-Math.max(u.x,l.x)),f=Math.max(0,Math.min(u.y2,l.y2)-Math.max(u.y,l.y));return Math.ceil(d*f)>0}function _a(e){const t=e?.[je]?.handleBounds||null,o=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!o]}const op=[{level:0,isMaxLevel:!0,edges:[]}];function ip(e,t,o=!1){let a=-1;const r=e.reduce((i,c)=>{const s=et(c.zIndex);let l=s?c.zIndex:0;if(o){const u=t.get(c.target),d=t.get(c.source),f=c.selected||u?.selected||d?.selected,p=Math.max(d?.[je]?.z||0,u?.[je]?.z||0,1e3);l=(s?c.zIndex:0)+(f?p:0)}return i[l]?i[l].push(c):i[l]=[c],a=l>a?l:a,i},{}),n=Object.entries(r).map(([i,c])=>{const s=+i;return{edges:c,level:s,isMaxLevel:s===a}});return n.length===0?op:n}function ap(e,t,o){const a=Ie(F.useCallback(r=>e?r.edges.filter(n=>{const i=t.get(n.source),c=t.get(n.target);return i?.width&&i?.height&&c?.width&&c?.height&&rp({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:c.width,targetHeight:c.height,width:r.width,height:r.height,transform:r.transform})}):r.edges,[e,t]));return ip(a,t,o)}const sp=({color:e="none",strokeWidth:t=1})=>X.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),cp=({color:e="none",strokeWidth:t=1})=>X.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),ba={[Fr.Arrow]:sp,[Fr.ArrowClosed]:cp};function lp(e){const t=Oe();return F.useMemo(()=>Object.prototype.hasOwnProperty.call(ba,e)?ba[e]:(t.getState().onError?.("009",bt.error009(e)),null),[e])}const up=({id:e,type:t,color:o,width:a=12.5,height:r=12.5,markerUnits:n="strokeWidth",strokeWidth:i,orient:c="auto-start-reverse"})=>{const s=lp(t);return s?X.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${a}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:n,orient:c,refX:"0",refY:"0"},X.createElement(s,{color:o,strokeWidth:i})):null},dp=({defaultColor:e,rfId:t})=>o=>{const a=[];return o.edges.reduce((r,n)=>([n.markerStart,n.markerEnd].forEach(i=>{if(i&&typeof i=="object"){const c=jo(i,t);a.includes(c)||(r.push({id:c,color:i.color||e,...i}),a.push(c))}}),r),[]).sort((r,n)=>r.id.localeCompare(n.id))},lc=({defaultColor:e,rfId:t})=>{const o=Ie(F.useCallback(dp({defaultColor:e,rfId:t}),[e,t]),(a,r)=>!(a.length!==r.length||a.some((n,i)=>n.id!==r[i].id)));return X.createElement("defs",null,o.map(a=>X.createElement(up,{id:a.id,key:a.id,type:a.type,color:a.color,width:a.width,height:a.height,markerUnits:a.markerUnits,strokeWidth:a.strokeWidth,orient:a.orient})))};lc.displayName="MarkerDefinitions";var fp=F.memo(lc);const hp=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),uc=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:o,rfId:a,edgeTypes:r,noPanClassName:n,onEdgeContextMenu:i,onEdgeMouseEnter:c,onEdgeMouseMove:s,onEdgeMouseLeave:l,onEdgeClick:u,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:p,onReconnectEnd:y,reconnectRadius:m,children:v,disableKeyboardA11y:_})=>{const{edgesFocusable:w,edgesUpdatable:C,elementsSelectable:x,width:A,height:D,connectionMode:S,nodeInternals:P,onError:I}=Ie(hp,Be),j=ap(t,P,o);return A?X.createElement(X.Fragment,null,j.map(({level:H,edges:T,isMaxLevel:U})=>X.createElement("svg",{key:H,style:{zIndex:H},width:A,height:D,className:"react-flow__edges react-flow__container"},U&&X.createElement(fp,{defaultColor:e,rfId:a}),X.createElement("g",null,T.map(g=>{const[k,E,B]=_a(P.get(g.source)),[G,N,R]=_a(P.get(g.target));if(!B||!R)return null;let b=g.type||"default";r[b]||(I?.("011",bt.error011(b)),b="default");const M=r[b]||r.default,O=S===Bt.Strict?N.target:(N.target??[]).concat(N.source??[]),L=xa(E.source,g.sourceHandle),z=xa(O,g.targetHandle),$=L?.position||pe.Bottom,V=z?.position||pe.Top,Y=!!(g.focusable||w&&typeof g.focusable>"u"),Z=g.reconnectable||g.updatable,Q=typeof f<"u"&&(Z||C&&typeof Z>"u");if(!L||!z)return I?.("008",bt.error008(L,g)),null;const{sourceX:J,sourceY:q,targetX:ge,targetY:se}=np(k,L,$,G,z,V);return X.createElement(M,{key:g.id,id:g.id,className:We([g.className,n]),type:b,data:g.data,selected:!!g.selected,animated:!!g.animated,hidden:!!g.hidden,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,style:g.style,source:g.source,target:g.target,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerEnd:g.markerEnd,markerStart:g.markerStart,sourceX:J,sourceY:q,targetX:ge,targetY:se,sourcePosition:$,targetPosition:V,elementsSelectable:x,onContextMenu:i,onMouseEnter:c,onMouseMove:s,onMouseLeave:l,onClick:u,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:p,onReconnectEnd:y,reconnectRadius:m,rfId:a,ariaLabel:g.ariaLabel,isFocusable:Y,isReconnectable:Q,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth,disableKeyboardA11y:_})})))),v):null};uc.displayName="EdgeRenderer";var pp=F.memo(uc);const gp=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function mp({children:e}){const t=Ie(gp);return X.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function yp(e){const t=di(),o=F.useRef(!1);F.useEffect(()=>{!o.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),o.current=!0)},[e,t.viewportInitialized])}const vp={[pe.Left]:pe.Right,[pe.Right]:pe.Left,[pe.Top]:pe.Bottom,[pe.Bottom]:pe.Top},dc=({nodeId:e,handleType:t,style:o,type:a=Tt.Bezier,CustomComponent:r,connectionStatus:n})=>{const{fromNode:i,handleId:c,toX:s,toY:l,connectionMode:u}=Ie(F.useCallback(D=>({fromNode:D.nodeInternals.get(e),handleId:D.connectionHandleId,toX:(D.connectionPosition.x-D.transform[0])/D.transform[2],toY:(D.connectionPosition.y-D.transform[1])/D.transform[2],connectionMode:D.connectionMode}),[e]),Be),d=i?.[je]?.handleBounds;let f=d?.[t];if(u===Bt.Loose&&(f=f||d?.[t==="source"?"target":"source"]),!i||!f)return null;const p=c?f.find(D=>D.id===c):f[0],y=p?p.x+p.width/2:(i.width??0)/2,m=p?p.y+p.height/2:i.height??0,v=(i.positionAbsolute?.x??0)+y,_=(i.positionAbsolute?.y??0)+m,w=p?.position,C=w?vp[w]:null;if(!w||!C)return null;if(r)return X.createElement(r,{connectionLineType:a,connectionLineStyle:o,fromNode:i,fromHandle:p,fromX:v,fromY:_,toX:s,toY:l,fromPosition:w,toPosition:C,connectionStatus:n});let x="";const A={sourceX:v,sourceY:_,sourcePosition:w,targetX:s,targetY:l,targetPosition:C};return a===Tt.Bezier?[x]=si(A):a===Tt.Step?[x]=Uo({...A,borderRadius:0}):a===Tt.SmoothStep?[x]=Uo(A):a===Tt.SimpleBezier?[x]=Rs(A):x=`M${v},${_} ${s},${l}`,X.createElement("path",{d:x,fill:"none",className:"react-flow__connection-path",style:o})};dc.displayName="ConnectionLine";const xp=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function _p({containerStyle:e,style:t,type:o,component:a}){const{nodeId:r,handleType:n,nodesConnectable:i,width:c,height:s,connectionStatus:l}=Ie(xp,Be);return!(r&&n&&c&&i)?null:X.createElement("svg",{style:e,width:c,height:s,className:"react-flow__edges react-flow__connectionline react-flow__container"},X.createElement("g",{className:We(["react-flow__connection",l])},X.createElement(dc,{nodeId:r,handleType:n,style:t,type:o,CustomComponent:a,connectionStatus:l})))}function wa(e,t){return F.useRef(null),Oe(),F.useMemo(()=>t(e),[e])}const fc=({nodeTypes:e,edgeTypes:t,onMove:o,onMoveStart:a,onMoveEnd:r,onInit:n,onNodeClick:i,onEdgeClick:c,onNodeDoubleClick:s,onEdgeDoubleClick:l,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:p,onSelectionContextMenu:y,onSelectionStart:m,onSelectionEnd:v,connectionLineType:_,connectionLineStyle:w,connectionLineComponent:C,connectionLineContainerStyle:x,selectionKeyCode:A,selectionOnDrag:D,selectionMode:S,multiSelectionKeyCode:P,panActivationKeyCode:I,zoomActivationKeyCode:j,deleteKeyCode:H,onlyRenderVisibleElements:T,elementsSelectable:U,selectNodesOnDrag:g,defaultViewport:k,translateExtent:E,minZoom:B,maxZoom:G,preventScrolling:N,defaultMarkerColor:R,zoomOnScroll:b,zoomOnPinch:M,panOnScroll:O,panOnScrollSpeed:L,panOnScrollMode:z,zoomOnDoubleClick:$,panOnDrag:V,onPaneClick:Y,onPaneMouseEnter:Z,onPaneMouseMove:Q,onPaneMouseLeave:J,onPaneScroll:q,onPaneContextMenu:ge,onEdgeContextMenu:se,onEdgeMouseEnter:ee,onEdgeMouseMove:oe,onEdgeMouseLeave:te,onReconnect:W,onReconnectStart:re,onReconnectEnd:ae,reconnectRadius:K,noDragClassName:ye,noWheelClassName:ie,noPanClassName:ce,elevateEdgesOnSelect:ne,disableKeyboardA11y:Se,nodeOrigin:le,nodeExtent:ue,rfId:fe})=>{const ve=wa(e,Yh),be=wa(t,tp);return yp(n),X.createElement($h,{onPaneClick:Y,onPaneMouseEnter:Z,onPaneMouseMove:Q,onPaneMouseLeave:J,onPaneContextMenu:ge,onPaneScroll:q,deleteKeyCode:H,selectionKeyCode:A,selectionOnDrag:D,selectionMode:S,onSelectionStart:m,onSelectionEnd:v,multiSelectionKeyCode:P,panActivationKeyCode:I,zoomActivationKeyCode:j,elementsSelectable:U,onMove:o,onMoveStart:a,onMoveEnd:r,zoomOnScroll:b,zoomOnPinch:M,zoomOnDoubleClick:$,panOnScroll:O,panOnScrollSpeed:L,panOnScrollMode:z,panOnDrag:V,defaultViewport:k,translateExtent:E,minZoom:B,maxZoom:G,onSelectionContextMenu:y,preventScrolling:N,noDragClassName:ye,noWheelClassName:ie,noPanClassName:ce,disableKeyboardA11y:Se},X.createElement(mp,null,X.createElement(pp,{edgeTypes:be,onEdgeClick:c,onEdgeDoubleClick:l,onlyRenderVisibleElements:T,onEdgeContextMenu:se,onEdgeMouseEnter:ee,onEdgeMouseMove:oe,onEdgeMouseLeave:te,onReconnect:W,onReconnectStart:re,onReconnectEnd:ae,reconnectRadius:K,defaultMarkerColor:R,noPanClassName:ce,elevateEdgesOnSelect:!!ne,disableKeyboardA11y:Se,rfId:fe},X.createElement(_p,{style:w,type:_,component:C,containerStyle:x})),X.createElement("div",{className:"react-flow__edgelabel-renderer"}),X.createElement(Zh,{nodeTypes:ve,onNodeClick:i,onNodeDoubleClick:s,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:p,selectNodesOnDrag:g,onlyRenderVisibleElements:T,noPanClassName:ce,noDragClassName:ye,disableKeyboardA11y:Se,nodeOrigin:le,nodeExtent:ue,rfId:fe})))};fc.displayName="GraphView";var bp=F.memo(fc);const zo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Nt={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:zo,nodeExtent:zo,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Bt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Kf,isValidConnection:void 0},wp=()=>ul((e,t)=>({...Nt,setNodes:o=>{const{nodeInternals:a,nodeOrigin:r,elevateNodesOnSelect:n}=t();e({nodeInternals:yo(o,a,r,n)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:o=>{const{defaultEdgeOptions:a={}}=t();e({edges:o.map(r=>({...a,...r}))})},setDefaultNodesAndEdges:(o,a)=>{const r=typeof o<"u",n=typeof a<"u",i=r?yo(o,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:i,edges:n?a:[],hasDefaultNodes:r,hasDefaultEdges:n})},updateNodeDimensions:o=>{const{onNodesChange:a,nodeInternals:r,fitViewOnInit:n,fitViewOnInitDone:i,fitViewOnInitOptions:c,domNode:s,nodeOrigin:l}=t(),u=s?.querySelector(".react-flow__viewport");if(!u)return;const d=window.getComputedStyle(u),{m22:f}=new window.DOMMatrixReadOnly(d.transform),p=o.reduce((m,v)=>{const _=r.get(v.id);if(_?.hidden)r.set(_.id,{..._,[je]:{..._[je],handleBounds:void 0}});else if(_){const w=ni(v.nodeElement);!!(w.width&&w.height&&(_.width!==w.width||_.height!==w.height||v.forceUpdate))&&(r.set(_.id,{..._,[je]:{..._[je],handleBounds:{source:ga(".source",v.nodeElement,f,l),target:ga(".target",v.nodeElement,f,l)}},...w}),m.push({id:_.id,type:"dimensions",dimensions:w}))}return m},[]);Js(r,l);const y=i||n&&!i&&Qs(t,{initial:!0,...c});e({nodeInternals:new Map(r),fitViewOnInitDone:y}),p?.length>0&&a?.(p)},updateNodePositions:(o,a=!0,r=!1)=>{const{triggerNodeChanges:n}=t(),i=o.map(c=>{const s={id:c.id,type:"position",dragging:r};return a&&(s.positionAbsolute=c.positionAbsolute,s.position=c.position),s});n(i)},triggerNodeChanges:o=>{const{onNodesChange:a,nodeInternals:r,hasDefaultNodes:n,nodeOrigin:i,getNodes:c,elevateNodesOnSelect:s}=t();if(o?.length){if(n){const l=tc(o,c()),u=yo(l,r,i,s);e({nodeInternals:u})}a?.(o)}},addSelectedNodes:o=>{const{multiSelectionActive:a,edges:r,getNodes:n}=t();let i,c=null;a?i=o.map(s=>At(s,!0)):(i=on(n(),o),c=on(r,[])),yr({changedNodes:i,changedEdges:c,get:t,set:e})},addSelectedEdges:o=>{const{multiSelectionActive:a,edges:r,getNodes:n}=t();let i,c=null;a?i=o.map(s=>At(s,!0)):(i=on(r,o),c=on(n(),[])),yr({changedNodes:c,changedEdges:i,get:t,set:e})},unselectNodesAndEdges:({nodes:o,edges:a}={})=>{const{edges:r,getNodes:n}=t(),i=o||n(),c=a||r,s=i.map(u=>(u.selected=!1,At(u.id,!1))),l=c.map(u=>At(u.id,!1));yr({changedNodes:s,changedEdges:l,get:t,set:e})},setMinZoom:o=>{const{d3Zoom:a,maxZoom:r}=t();a?.scaleExtent([o,r]),e({minZoom:o})},setMaxZoom:o=>{const{d3Zoom:a,minZoom:r}=t();a?.scaleExtent([r,o]),e({maxZoom:o})},setTranslateExtent:o=>{t().d3Zoom?.translateExtent(o),e({translateExtent:o})},resetSelectedElements:()=>{const{edges:o,getNodes:a}=t(),n=a().filter(c=>c.selected).map(c=>At(c.id,!1)),i=o.filter(c=>c.selected).map(c=>At(c.id,!1));yr({changedNodes:n,changedEdges:i,get:t,set:e})},setNodeExtent:o=>{const{nodeInternals:a}=t();a.forEach(r=>{r.positionAbsolute=ri(r.position,o)}),e({nodeExtent:o,nodeInternals:new Map(a)})},panBy:o=>{const{transform:a,width:r,height:n,d3Zoom:i,d3Selection:c,translateExtent:s}=t();if(!i||!c||!o.x&&!o.y)return!1;const l=xt.translate(a[0]+o.x,a[1]+o.y).scale(a[2]),u=[[0,0],[r,n]],d=i?.constrain()(l,u,s);return i.transform(c,d),a[0]!==d.x||a[1]!==d.y||a[2]!==d.k},cancelConnection:()=>e({connectionNodeId:Nt.connectionNodeId,connectionHandleId:Nt.connectionHandleId,connectionHandleType:Nt.connectionHandleType,connectionStatus:Nt.connectionStatus,connectionStartHandle:Nt.connectionStartHandle,connectionEndHandle:Nt.connectionEndHandle}),reset:()=>e({...Nt})}),Object.is),hc=({children:e})=>{const t=F.useRef(null);return t.current||(t.current=wp()),X.createElement(Hf,{value:t.current},e)};hc.displayName="ReactFlowProvider";const pc=({children:e})=>F.useContext(Hr)?X.createElement(X.Fragment,null,e):X.createElement(hc,null,e);pc.displayName="ReactFlowWrapper";const Sp={input:Ws,default:Oo,output:Xs,group:ui},Cp={default:Or,straight:ai,step:ii,smoothstep:Vr,simplebezier:oi},Ep=[0,0],Np=[15,15],kp={x:0,y:0,zoom:1},Ap={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},gc=F.forwardRef(({nodes:e,edges:t,defaultNodes:o,defaultEdges:a,className:r,nodeTypes:n=Sp,edgeTypes:i=Cp,onNodeClick:c,onEdgeClick:s,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:p,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:_,onNodeMouseEnter:w,onNodeMouseMove:C,onNodeMouseLeave:x,onNodeContextMenu:A,onNodeDoubleClick:D,onNodeDragStart:S,onNodeDrag:P,onNodeDragStop:I,onNodesDelete:j,onEdgesDelete:H,onSelectionChange:T,onSelectionDragStart:U,onSelectionDrag:g,onSelectionDragStop:k,onSelectionContextMenu:E,onSelectionStart:B,onSelectionEnd:G,connectionMode:N=Bt.Strict,connectionLineType:R=Tt.Bezier,connectionLineStyle:b,connectionLineComponent:M,connectionLineContainerStyle:O,deleteKeyCode:L="Backspace",selectionKeyCode:z="Shift",selectionOnDrag:$=!1,selectionMode:V=Kn.Full,panActivationKeyCode:Y="Space",multiSelectionKeyCode:Z=jr()?"Meta":"Control",zoomActivationKeyCode:Q=jr()?"Meta":"Control",snapToGrid:J=!1,snapGrid:q=Np,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:se=!0,nodesDraggable:ee,nodesConnectable:oe,nodesFocusable:te,nodeOrigin:W=Ep,edgesFocusable:re,edgesUpdatable:ae,elementsSelectable:K,defaultViewport:ye=kp,minZoom:ie=.5,maxZoom:ce=2,translateExtent:ne=zo,preventScrolling:Se=!0,nodeExtent:le,defaultMarkerColor:ue="#b1b1b7",zoomOnScroll:fe=!0,zoomOnPinch:ve=!0,panOnScroll:be=!1,panOnScrollSpeed:ke=.5,panOnScrollMode:xe=Ut.Free,zoomOnDoubleClick:_e=!0,panOnDrag:de=!0,onPaneClick:Ae,onPaneMouseEnter:Me,onPaneMouseMove:Le,onPaneMouseLeave:Pe,onPaneScroll:me,onPaneContextMenu:Te,children:tt,onEdgeContextMenu:Ne,onEdgeDoubleClick:Ce,onEdgeMouseEnter:Ue,onEdgeMouseMove:De,onEdgeMouseLeave:we,onEdgeUpdate:Re,onEdgeUpdateStart:Ge,onEdgeUpdateEnd:ze,onReconnect:Fe,onReconnectStart:qe,onReconnectEnd:ut,reconnectRadius:nt=10,edgeUpdaterRadius:dt=10,onNodesChange:gt,onEdgesChange:rt,noDragClassName:He="nodrag",noWheelClassName:mt="nowheel",noPanClassName:gn="nopan",fitView:mn=!1,fitViewOptions:Xr,connectOnClick:er=!0,attributionPosition:Gt,proOptions:yn,defaultEdgeOptions:Yr,elevateNodesOnSelect:tr=!0,elevateEdgesOnSelect:Ht=!1,disableKeyboardA11y:Vt=!1,autoPanOnConnect:vn=!0,autoPanOnNodeDrag:he=!0,connectionRadius:Pt=20,isValidConnection:qr,onError:St,style:Wt,id:xn,nodeDragThreshold:_n,...$t},Xt)=>{const Yt=xn||"1";return X.createElement("div",{...$t,style:{...Wt,...Ap},ref:Xt,className:We(["react-flow",r]),"data-testid":"rf__wrapper",id:xn},X.createElement(pc,null,X.createElement(bp,{onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onNodeClick:c,onEdgeClick:s,onNodeMouseEnter:w,onNodeMouseMove:C,onNodeMouseLeave:x,onNodeContextMenu:A,onNodeDoubleClick:D,nodeTypes:n,edgeTypes:i,connectionLineType:R,connectionLineStyle:b,connectionLineComponent:M,connectionLineContainerStyle:O,selectionKeyCode:z,selectionOnDrag:$,selectionMode:V,deleteKeyCode:L,multiSelectionKeyCode:Z,panActivationKeyCode:Y,zoomActivationKeyCode:Q,onlyRenderVisibleElements:ge,selectNodesOnDrag:se,defaultViewport:ye,translateExtent:ne,minZoom:ie,maxZoom:ce,preventScrolling:Se,zoomOnScroll:fe,zoomOnPinch:ve,zoomOnDoubleClick:_e,panOnScroll:be,panOnScrollSpeed:ke,panOnScrollMode:xe,panOnDrag:de,onPaneClick:Ae,onPaneMouseEnter:Me,onPaneMouseMove:Le,onPaneMouseLeave:Pe,onPaneScroll:me,onPaneContextMenu:Te,onSelectionContextMenu:E,onSelectionStart:B,onSelectionEnd:G,onEdgeContextMenu:Ne,onEdgeDoubleClick:Ce,onEdgeMouseEnter:Ue,onEdgeMouseMove:De,onEdgeMouseLeave:we,onReconnect:Fe??Re,onReconnectStart:qe??Ge,onReconnectEnd:ut??ze,reconnectRadius:nt??dt,defaultMarkerColor:ue,noDragClassName:He,noWheelClassName:mt,noPanClassName:gn,elevateEdgesOnSelect:Ht,rfId:Yt,disableKeyboardA11y:Vt,nodeOrigin:W,nodeExtent:le}),X.createElement(vh,{nodes:e,edges:t,defaultNodes:o,defaultEdges:a,onConnect:p,onConnectStart:y,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:_,nodesDraggable:ee,nodesConnectable:oe,nodesFocusable:te,edgesFocusable:re,edgesUpdatable:ae,elementsSelectable:K,elevateNodesOnSelect:tr,minZoom:ie,maxZoom:ce,nodeExtent:le,onNodesChange:gt,onEdgesChange:rt,snapToGrid:J,snapGrid:q,connectionMode:N,translateExtent:ne,connectOnClick:er,defaultEdgeOptions:Yr,fitView:mn,fitViewOptions:Xr,onNodesDelete:j,onEdgesDelete:H,onNodeDragStart:S,onNodeDrag:P,onNodeDragStop:I,onSelectionDrag:g,onSelectionDragStart:U,onSelectionDragStop:k,noPanClassName:gn,nodeOrigin:W,rfId:Yt,autoPanOnConnect:vn,autoPanOnNodeDrag:he,onError:St,connectionRadius:Pt,isValidConnection:qr,nodeDragThreshold:_n}),X.createElement(mh,{onSelectionChange:T}),tt,X.createElement(Wf,{proOptions:yn,position:Gt}),X.createElement(Sh,{rfId:Yt,disableKeyboardA11y:Vt})))});gc.displayName="ReactFlow";function mc(e){return t=>{const[o,a]=F.useState(t),r=F.useCallback(n=>a(i=>e(n,i)),[]);return[o,a,r]}}const Tp=mc(tc),Mp=mc(Fh),yc=({id:e,x:t,y:o,width:a,height:r,style:n,color:i,strokeColor:c,strokeWidth:s,className:l,borderRadius:u,shapeRendering:d,onClick:f,selected:p})=>{const{background:y,backgroundColor:m}=n||{},v=i||y||m;return X.createElement("rect",{className:We(["react-flow__minimap-node",{selected:p},l]),x:t,y:o,rx:u,ry:u,width:a,height:r,fill:v,stroke:c,strokeWidth:s,shapeRendering:d,onClick:f?_=>f(_,e):void 0})};yc.displayName="MiniMapNode";var Pp=F.memo(yc);const Dp=e=>e.nodeOrigin,Rp=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),bo=e=>e instanceof Function?e:()=>e;function Ip({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:o="",nodeBorderRadius:a=5,nodeStrokeWidth:r=2,nodeComponent:n=Pp,onClick:i}){const c=Ie(Rp,Be),s=Ie(Dp),l=bo(t),u=bo(e),d=bo(o),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return X.createElement(X.Fragment,null,c.map(p=>{const{x:y,y:m}=Ft(p,s).positionAbsolute;return X.createElement(n,{key:p.id,x:y,y:m,width:p.width,height:p.height,style:p.style,selected:p.selected,className:d(p),color:l(p),borderRadius:a,strokeColor:u(p),strokeWidth:r,shapeRendering:f,onClick:i,id:p.id})}))}var Up=F.memo(Ip);const jp=200,Fp=150,Op=e=>{const t=e.getNodes(),o={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:o,boundingRect:t.length>0?Yf(Wr(t,e.nodeOrigin),o):o,rfId:e.rfId}},Lp="react-flow__minimap-desc";function vc({style:e,className:t,nodeStrokeColor:o="transparent",nodeColor:a="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:i=2,nodeComponent:c,maskColor:s="rgb(240, 240, 240, 0.6)",maskStrokeColor:l="none",maskStrokeWidth:u=1,position:d="bottom-right",onClick:f,onNodeClick:p,pannable:y=!1,zoomable:m=!1,ariaLabel:v="React Flow mini map",inversePan:_=!1,zoomStep:w=10,offsetScale:C=5}){const x=Oe(),A=F.useRef(null),{boundingRect:D,viewBB:S,rfId:P}=Ie(Op,Be),I=e?.width??jp,j=e?.height??Fp,H=D.width/I,T=D.height/j,U=Math.max(H,T),g=U*I,k=U*j,E=C*U,B=D.x-(g-D.width)/2-E,G=D.y-(k-D.height)/2-E,N=g+E*2,R=k+E*2,b=`${Lp}-${P}`,M=F.useRef(0);M.current=U,F.useEffect(()=>{if(A.current){const z=Qe(A.current),$=Z=>{const{transform:Q,d3Selection:J,d3Zoom:q}=x.getState();if(Z.sourceEvent.type!=="wheel"||!J||!q)return;const ge=-Z.sourceEvent.deltaY*(Z.sourceEvent.deltaMode===1?.05:Z.sourceEvent.deltaMode?1:.002)*w,se=Q[2]*Math.pow(2,ge);q.scaleTo(J,se)},V=Z=>{const{transform:Q,d3Selection:J,d3Zoom:q,translateExtent:ge,width:se,height:ee}=x.getState();if(Z.sourceEvent.type!=="mousemove"||!J||!q)return;const oe=M.current*Math.max(1,Q[2])*(_?-1:1),te={x:Q[0]-Z.sourceEvent.movementX*oe,y:Q[1]-Z.sourceEvent.movementY*oe},W=[[0,0],[se,ee]],re=xt.translate(te.x,te.y).scale(Q[2]),ae=q.constrain()(re,W,ge);q.transform(J,ae)},Y=Ss().on("zoom",y?V:null).on("zoom.wheel",m?$:null);return z.call(Y),()=>{z.on("zoom",null)}}},[y,m,_,w]);const O=f?z=>{const $=at(z);f(z,{x:$[0],y:$[1]})}:void 0,L=p?(z,$)=>{const V=x.getState().nodeInternals.get($);p(z,V)}:void 0;return X.createElement(ti,{position:d,style:e,className:We(["react-flow__minimap",t]),"data-testid":"rf__minimap"},X.createElement("svg",{width:I,height:j,viewBox:`${B} ${G} ${N} ${R}`,role:"img","aria-labelledby":b,ref:A,onClick:O},v&&X.createElement("title",{id:b},v),X.createElement(Up,{onClick:L,nodeColor:a,nodeStrokeColor:o,nodeBorderRadius:n,nodeClassName:r,nodeStrokeWidth:i,nodeComponent:c}),X.createElement("path",{className:"react-flow__minimap-mask",d:`M${B-E},${G-E}h${N+E*2}v${R+E*2}h${-N-E*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fill:s,fillRule:"evenodd",stroke:l,strokeWidth:u,pointerEvents:"none"})))}vc.displayName="MiniMap";var zp=F.memo(vc);function Bp(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},X.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Gp(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},X.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Hp(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},X.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Vp(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},X.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Wp(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},X.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Ln=({children:e,className:t,...o})=>X.createElement("button",{type:"button",className:We(["react-flow__controls-button",t]),...o},e);Ln.displayName="ControlButton";const $p=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),xc=({style:e,showZoom:t=!0,showFitView:o=!0,showInteractive:a=!0,fitViewOptions:r,onZoomIn:n,onZoomOut:i,onFitView:c,onInteractiveChange:s,className:l,children:u,position:d="bottom-left"})=>{const f=Oe(),[p,y]=F.useState(!1),{isInteractive:m,minZoomReached:v,maxZoomReached:_}=Ie($p,Be),{zoomIn:w,zoomOut:C,fitView:x}=di();if(F.useEffect(()=>{y(!0)},[]),!p)return null;const A=()=>{w(),n?.()},D=()=>{C(),i?.()},S=()=>{x(r),c?.()},P=()=>{f.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),s?.(!m)};return X.createElement(ti,{className:We(["react-flow__controls",l]),position:d,style:e,"data-testid":"rf__controls"},t&&X.createElement(X.Fragment,null,X.createElement(Ln,{onClick:A,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:_},X.createElement(Bp,null)),X.createElement(Ln,{onClick:D,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v},X.createElement(Gp,null))),o&&X.createElement(Ln,{className:"react-flow__controls-fitview",onClick:S,title:"fit view","aria-label":"fit view"},X.createElement(Hp,null)),a&&X.createElement(Ln,{className:"react-flow__controls-interactive",onClick:P,title:"toggle interactivity","aria-label":"toggle interactivity"},m?X.createElement(Wp,null):X.createElement(Vp,null)),u)};xc.displayName="Controls";var Xp=F.memo(xc),ct;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ct||(ct={}));function Yp({color:e,dimensions:t,lineWidth:o}){return X.createElement("path",{stroke:e,strokeWidth:o,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function qp({color:e,radius:t}){return X.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Kp={[ct.Dots]:"#91919a",[ct.Lines]:"#eee",[ct.Cross]:"#e2e2e2"},Zp={[ct.Dots]:1,[ct.Lines]:1,[ct.Cross]:6},Jp=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function _c({id:e,variant:t=ct.Dots,gap:o=20,size:a,lineWidth:r=1,offset:n=2,color:i,style:c,className:s}){const l=F.useRef(null),{transform:u,patternId:d}=Ie(Jp,Be),f=i||Kp[t],p=a||Zp[t],y=t===ct.Dots,m=t===ct.Cross,v=Array.isArray(o)?o:[o,o],_=[v[0]*u[2]||1,v[1]*u[2]||1],w=p*u[2],C=m?[w,w]:_,x=y?[w/n,w/n]:[C[0]/n,C[1]/n];return X.createElement("svg",{className:We(["react-flow__background",s]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:l,"data-testid":"rf__background"},X.createElement("pattern",{id:d+e,x:u[0]%_[0],y:u[1]%_[1],width:_[0],height:_[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${x[0]},-${x[1]})`},y?X.createElement(qp,{color:f,radius:w/n}):X.createElement(Yp,{dimensions:C,color:f,lineWidth:r})),X.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}_c.displayName="Background";var Qp=F.memo(_c);const e0={input:{label:"Request Input",icon:""},cache_l1:{label:"L1 Memory",icon:""},cache_l2:{label:"L2 Redis",icon:""},cache_l3:{label:"L3 PostgreSQL",icon:""},semantic_dedup:{label:"Semantic Dedup",icon:""},phi_filter:{label:"PHI Filter",icon:""},fraud_detector:{label:"Fraud Detector",icon:""},transaction_validator:{label:"Transaction Validator",icon:""},openai:{label:"OpenAI GPT",icon:""},anthropic:{label:"Anthropic Claude",icon:""},gemini:{label:"Google Gemini",icon:""},hipaa_audit:{label:"HIPAA Audit",icon:""},pci_audit:{label:"PCI Audit",icon:""},sox_logger:{label:"SOX Logger",icon:""},retention_policy:{label:"Retention Policy",icon:""},audit_logger:{label:"Audit Logger",icon:""},encrypted_cache:{label:"Encrypted Cache",icon:""},output:{label:"Response Output",icon:""}},t0={input:"",cache:"",intelligence:"",llm:"",compliance:"",output:""};function n0({sector:e,config:t}){const o=(t?.nodes||[]).map(({category:r,types:n})=>({title:`${t0[r]||""} ${r.charAt(0).toUpperCase()+r.slice(1)}`,nodes:n.map(i=>({type:i,...e0[i]}))})),a=(r,n)=>{r.dataTransfer.setData("application/reactflow",n),r.dataTransfer.effectAllowed="move"};return h.jsxs("aside",{className:"sidebar",children:[h.jsxs("div",{className:"sidebar-header",children:[h.jsx("h2",{children:"Node Library"}),h.jsx("p",{children:"Drag nodes to canvas"})]}),h.jsx("div",{className:"node-categories",children:o.map(r=>h.jsxs("div",{className:"node-category",children:[h.jsx("h3",{children:r.title}),h.jsx("div",{className:"node-list",children:r.nodes.map(n=>h.jsxs("div",{className:"node-item",draggable:!0,onDragStart:i=>a(i,n.type),children:[h.jsx("span",{className:"node-item-icon",children:n.icon}),h.jsx("span",{className:"node-item-label",children:n.label})]},n.type))})]},r.title))})]})}const r0={healthcare:{name:"Healthcare & Life Sciences",icon:"",scenarios:[{id:"hipaa-compliant-rag",name:"HIPAA-Compliant RAG",description:"Medical knowledge retrieval with full audit trails for compliance",useCase:"clinical_decision_support",nodes:[{type:"cache_l1",config:{ttl:300,max_size:"1GB",encryption:"AES-256"}},{type:"cache_l2",config:{ttl:3600,storage:"redis",audit_log:!0}},{type:"compliance_layer",config:{standard:"HIPAA",audit_retention:"7_years"}},{type:"pii_detection",config:{redaction:"automatic",phi_alerts:!0}},{type:"semantic_dedup",config:{threshold:.95}}],compliance:["HIPAA","HITRUST"],estimatedSavings:"$3,200/mo",complexity:"complex",reasoning:"Medical RAG systems require secure caching with full audit trails. PHI detection prevents data leaks. Multi-tier caching reduces EHR API load by 85%."},{id:"diagnostic-imaging-cache",name:"Diagnostic Imaging Analysis",description:"Cache AI-analyzed radiology reports and imaging interpretations",useCase:"diagnostic_imaging",nodes:[{type:"cache_l1",config:{ttl:600,max_size:"2GB"}},{type:"cache_l2",config:{ttl:7200,storage:"redis"}},{type:"deduplication",config:{hash_algorithm:"perceptual",threshold:.92}},{type:"compliance_layer",config:{standard:"HIPAA"}}],compliance:["HIPAA","FDA 21 CFR Part 11"],estimatedSavings:"$4,800/mo",complexity:"moderate",reasoning:"Radiology AI models are expensive ($0.50-2.00 per image). Caching similar case interpretations saves 70% on redundant analyses."},{id:"patient-triage-assistant",name:"Patient Triage Assistant",description:"Cache symptom analysis and triage recommendations",useCase:"patient_triage",nodes:[{type:"cache_l1",config:{ttl:180,max_size:"500MB"}},{type:"semantic_cache",config:{similarity_threshold:.88}},{type:"compliance_layer",config:{standard:"HIPAA",log_all_access:!0}}],compliance:["HIPAA"],estimatedSavings:"$1,800/mo",complexity:"simple",reasoning:'Common symptoms generate repeated queries. Semantic caching handles symptom variations (e.g., "chest pain" vs "tightness in chest").'}]},finance:{name:"Finance & FinTech",icon:"",scenarios:[{id:"fraud-detection-cache",name:"Real-Time Fraud Detection",description:"Cache ML fraud scores with sub-50ms latency requirements",useCase:"fraud_detection",nodes:[{type:"cache_l1",config:{ttl:120,max_size:"1GB",strategy:"LRU"}},{type:"cache_l2",config:{ttl:600,storage:"redis"}},{type:"anomaly_detection",config:{alert_on_cache_miss:!0}},{type:"compliance_layer",config:{standard:"PCI-DSS",immutable_logs:!0}}],compliance:["PCI-DSS","SOC 2 Type II"],estimatedSavings:"$5,200/mo",complexity:"complex",reasoning:"Payment fraud models must respond <50ms. L1 cache ensures 95% hit rate on known patterns. Anomaly detection flags unusual transaction types for live scoring."},{id:"kyc-document-verification",name:"KYC Document Verification",description:"Cache ID verification results and risk assessments",useCase:"kyc_verification",nodes:[{type:"cache_l1",config:{ttl:3600,max_size:"500MB"}},{type:"cache_l2",config:{ttl:86400,storage:"postgresql"}},{type:"deduplication",config:{hash_fields:["document_id","customer_id"]}},{type:"compliance_layer",config:{standard:"KYC/AML",retention:"5_years"}}],compliance:["KYC/AML","GDPR"],estimatedSavings:"$3,600/mo",complexity:"moderate",reasoning:"Identity verification APIs cost $0.50-3.00 per check. Caching verified documents for returning customers saves 80% on redundant checks."},{id:"market-sentiment-analysis",name:"Market Sentiment Analysis",description:"Cache LLM-analyzed market sentiment from news/social",useCase:"sentiment_analysis",nodes:[{type:"cache_l1",config:{ttl:300,max_size:"1GB"}},{type:"cache_l2",config:{ttl:1800,storage:"redis"}},{type:"semantic_dedup",config:{threshold:.9}},{type:"time_series_cache",config:{window:"15min",aggregate:"avg"}}],compliance:["SOC 2"],estimatedSavings:"$2,400/mo",complexity:"moderate",reasoning:"Trading firms analyze same news multiple times. Semantic caching handles paraphrased headlines. Time-series aggregation reduces duplicate sentiment calls."}]},education:{name:"Education & EdTech",icon:"",scenarios:[{id:"literacy-rag-system",name:"Science of Reading RAG",description:"Cache research-backed literacy guidance with source citations",useCase:"educational_rag",nodes:[{type:"cache_l1",config:{ttl:600,max_size:"500MB"}},{type:"cache_l2",config:{ttl:7200,storage:"redis"}},{type:"semantic_cache",config:{similarity_threshold:.87}},{type:"citation_tracking",config:{store_sources:!0}},{type:"content_filtering",config:{age_appropriate:!0}}],compliance:["FERPA","COPPA"],estimatedSavings:"$1,600/mo",complexity:"moderate",reasoning:"Teachers ask similar questions about phonics, comprehension strategies. Semantic caching handles question variations. Citation tracking maintains research integrity."},{id:"personalized-tutoring",name:"AI Tutoring Personalization",description:"Cache student-specific learning recommendations",useCase:"adaptive_learning",nodes:[{type:"cache_l1",config:{ttl:300,max_size:"1GB",partition_by:"student_id"}},{type:"cache_l2",config:{ttl:3600,storage:"redis"}},{type:"user_memory",config:{remember_preferences:!0,learning_style:!0}},{type:"compliance_layer",config:{standard:"FERPA",student_data_protection:!0}}],compliance:["FERPA","COPPA"],estimatedSavings:"$2,100/mo",complexity:"moderate",reasoning:"Personalized learning models are compute-intensive. Caching per-student recommendations reduces redundant model inference by 75%."},{id:"grading-automation",name:"Automated Essay Grading",description:"Cache grading rubrics and similar essay assessments",useCase:"automated_grading",nodes:[{type:"cache_l1",config:{ttl:3600,max_size:"500MB"}},{type:"semantic_dedup",config:{threshold:.93}},{type:"compliance_layer",config:{standard:"FERPA"}}],compliance:["FERPA"],estimatedSavings:"$1,200/mo",complexity:"simple",reasoning:"Similar essays get graded repeatedly. Semantic deduplication detects near-duplicate submissions, reducing LLM grading costs by 60%."}]},legal:{name:"Legal & Compliance",icon:"",scenarios:[{id:"contract-analysis",name:"Contract Review & Analysis",description:"Cache legal clause analysis and risk assessments",useCase:"contract_review",nodes:[{type:"cache_l1",config:{ttl:1800,max_size:"1GB"}},{type:"cache_l2",config:{ttl:86400,storage:"postgresql"}},{type:"semantic_cache",config:{similarity_threshold:.91}},{type:"versioning",config:{track_changes:!0}},{type:"compliance_layer",config:{standard:"SOC 2",attorney_client_privilege:!0}}],compliance:["SOC 2","ISO 27001"],estimatedSavings:"$4,200/mo",complexity:"complex",reasoning:"Legal AI models (GPT-4) cost $0.10+ per contract. Standard clauses appear repeatedly. Semantic caching handles clause variations, saving 70% on analysis."},{id:"regulatory-compliance-checks",name:"Regulatory Compliance Monitoring",description:"Cache regulation interpretations and compliance status",useCase:"compliance_monitoring",nodes:[{type:"cache_l1",config:{ttl:600,max_size:"500MB"}},{type:"cache_l2",config:{ttl:3600,storage:"redis"}},{type:"compliance_layer",config:{standards:["SOC 2","ISO 27001","GDPR"],audit_trail:!0}}],compliance:["SOC 2","ISO 27001","GDPR"],estimatedSavings:"$2,800/mo",complexity:"moderate",reasoning:"Compliance teams query same regulations repeatedly. Caching regulation interpretations reduces LLM costs by 80%."}]},ecommerce:{name:"E-commerce & Retail",icon:"",scenarios:[{id:"product-recommendations",name:"AI Product Recommendations",description:"Cache personalized product suggestions and search results",useCase:"product_recommendations",nodes:[{type:"cache_l1",config:{ttl:300,max_size:"2GB",partition_by:"user_segment"}},{type:"cache_l2",config:{ttl:3600,storage:"redis"}},{type:"semantic_cache",config:{similarity_threshold:.85}},{type:"ab_testing",config:{variant_caching:!0}}],compliance:["GDPR","CCPA"],estimatedSavings:"$3,400/mo",complexity:"moderate",reasoning:'Recommendation models run on every page load. Segment-based caching (e.g., "outdoor enthusiast") reduces per-user computation by 85%.'},{id:"customer-support-bot",name:"Customer Support Chatbot",description:"Cache common support queries and product knowledge",useCase:"customer_support",nodes:[{type:"cache_l1",config:{ttl:600,max_size:"1GB"}},{type:"cache_l2",config:{ttl:7200,storage:"redis"}},{type:"semantic_cache",config:{similarity_threshold:.88}},{type:"user_memory",config:{remember_orders:!0,preferences:!0}}],compliance:["GDPR","CCPA"],estimatedSavings:"$2,600/mo",complexity:"moderate",reasoning:`Support bots answer 80% of the same questions. Semantic caching handles variations ("Where's my order?" vs "Track my shipment"). 90% hit rate.`}]},data_lakehouse:{name:"Data Lakehouse & Analytics",icon:"",scenarios:[{id:"databricks-rag-optimization",name:"Databricks RAG Optimization",description:"Cache LLM inference for lakehouse RAG pipelines with sub-50ms hits",useCase:"lakehouse_rag",nodes:[{type:"cache_l1",config:{ttl:300,max_size:"2GB",strategy:"LRU"}},{type:"cache_l2",config:{ttl:3600,storage:"redis"}},{type:"cache_l3",config:{ttl:86400,storage:"delta_lake"}},{type:"semantic_dedup",config:{threshold:.92,use_embeddings:!0}},{type:"compliance_layer",config:{standards:["SOC 2","ISO 42001"],lineage_tracking:!0}},{type:"cost_allocation",config:{chargeback_by_namespace:!0}}],compliance:["SOC 2","ISO 42001","GDPR"],estimatedSavings:"$8,400/mo",complexity:"complex",reasoning:"Enterprise RAG systems query same data repeatedly. 3-tier caching (hot/warm/cold) reduces lakehouse LLM costs by 90%. Lineage tracking for AI governance."},{id:"snowflake-cortex-cache",name:"Snowflake Cortex AI Caching",description:"Cache Snowflake Cortex LLM responses with SQL integration",useCase:"snowflake_cortex",nodes:[{type:"cache_l1",config:{ttl:600,max_size:"1GB"}},{type:"cache_l2",config:{ttl:7200,storage:"redis"}},{type:"semantic_cache",config:{threshold:.9}},{type:"cost_allocation",config:{by_warehouse:!0,by_schema:!0}}],compliance:["SOC 2","GDPR"],estimatedSavings:"$6,200/mo",complexity:"moderate",reasoning:"Snowflake Cortex charges per token. Caching SQL-triggered LLM calls reduces costs by 85%. Cost allocation maps to Snowflake warehouses for FinOps."},{id:"vector-search-cache",name:"Vector Search Optimization",description:"Cache vector similarity searches and embeddings",useCase:"vector_search",nodes:[{type:"cache_l1",config:{ttl:300,max_size:"1GB"}},{type:"embedding_cache",config:{ttl:7200,model:"text-embedding-3-large"}},{type:"semantic_cache",config:{threshold:.93,vector_similarity:"cosine"}},{type:"deduplication",config:{hash_embeddings:!0}}],compliance:["SOC 2"],estimatedSavings:"$4,800/mo",complexity:"moderate",reasoning:"Vector DBs (Pinecone, Weaviate) charge per query. Caching embeddings avoids redundant OpenAI embedding API calls ($0.00013/1K tokens). 80% hit rate."}]},media:{name:"Media & Entertainment",icon:"",scenarios:[{id:"content-moderation",name:"AI Content Moderation",description:"Cache moderation decisions for user-generated content",useCase:"content_moderation",nodes:[{type:"cache_l1",config:{ttl:600,max_size:"1GB"}},{type:"cache_l2",config:{ttl:7200,storage:"redis"}},{type:"perceptual_hash",config:{threshold:.95}},{type:"semantic_dedup",config:{threshold:.9}}],compliance:["COPPA","GDPR"],estimatedSavings:"$5,600/mo",complexity:"moderate",reasoning:"Moderation APIs cost $0.01-0.05 per item. Perceptual hashing detects duplicate images/videos. Semantic dedup catches text variations. 75% hit rate."},{id:"subtitle-generation",name:"AI Subtitle Generation",description:"Cache transcription and translation results",useCase:"subtitle_generation",nodes:[{type:"cache_l1",config:{ttl:3600,max_size:"2GB"}},{type:"cache_l2",config:{ttl:86400,storage:"postgresql"}},{type:"audio_fingerprint",config:{algorithm:"chromaprint"}},{type:"deduplication",config:{by_audio_hash:!0}}],compliance:["GDPR"],estimatedSavings:"$3,200/mo",complexity:"moderate",reasoning:"Transcription APIs (Whisper, Deepgram) cost $0.006-0.024 per minute. Audio fingerprinting detects re-uploads, avoiding redundant transcription."}]},manufacturing:{name:"Manufacturing & IoT",icon:"",scenarios:[{id:"predictive-maintenance",name:"Predictive Maintenance AI",description:"Cache equipment failure predictions and maintenance schedules",useCase:"predictive_maintenance",nodes:[{type:"cache_l1",config:{ttl:300,max_size:"500MB",partition_by:"equipment_id"}},{type:"cache_l2",config:{ttl:3600,storage:"redis"}},{type:"time_series_cache",config:{window:"1hour",aggregate:"latest"}},{type:"anomaly_detection",config:{alert_on_deviation:!0}}],compliance:["ISO 27001"],estimatedSavings:"$2,800/mo",complexity:"moderate",reasoning:"ML models analyze sensor data every 5 minutes. Caching stable predictions reduces redundant inference by 70%. Anomaly detection triggers fresh inference only when needed."},{id:"quality-control-vision",name:"Computer Vision QC",description:"Cache defect detection results from production line cameras",useCase:"quality_control",nodes:[{type:"cache_l1",config:{ttl:600,max_size:"1GB"}},{type:"perceptual_hash",config:{threshold:.93}},{type:"deduplication",config:{by_image_hash:!0}}],compliance:["ISO 9001"],estimatedSavings:"$4,200/mo",complexity:"simple",reasoning:'Vision models analyze thousands of images/hour. Perceptual hashing detects identical/similar products, caching "pass/fail" decisions. 85% hit rate on repetitive production.'}]}};function o0(e){return r0[e]?.scenarios||[]}const Bo={data:[],async loadDataset(){if(this.data.length>0)return this.data;try{const e=await fetch("/data/dataset_sample.json");if(!e.ok)throw new Error("Failed to load dataset");return this.data=await e.json(),console.log(`Loaded ${this.data.length} items from dataset`),this.data}catch(e){return console.error("Error loading dataset:",e),[]}},getData(){return this.data},getStats(){if(this.data.length===0)return null;const e={};let t=0;return this.data.forEach(o=>{e[o.category]=(e[o.category]||0)+1,t+=o.tokens}),{totalItems:this.data.length,avgTokens:Math.round(t/this.data.length),categories:e}}};function Sa({sector:e,config:t,onClose:o,onComplete:a}){const r=o0(e)||[],n=t?.templates||[],[i,c]=F.useState(1),[s,l]=F.useState(null),[u,d]=F.useState(""),[f,p]=F.useState("balanced"),[y,m]=F.useState(!1),[v,_]=F.useState(null),[w,C]=F.useState(null),x=[{icon:"",title:"Data Lakehouse RAG",description:"Optimize LLM inference for data lakehouse RAG pipelines with sub-50ms cache hits and full audit trails for compliance"},{icon:"",title:"AI Learning Platform",description:"Cache AI model inference results for educational platform with student learning analytics and response personalization"},{icon:"",title:"Media Asset Acceleration",description:"Accelerate content delivery for media assets with multi-region edge caching and 14x faster upload speeds"},{icon:"",title:"Enterprise AI Governance",description:"Cache reasoning model outputs (o1/DeepSeek) with governance controls for enterprise AI compliance and cost reduction"},{icon:"",title:"Vector Search",description:"Optimize vector search and embedding cache for production RAG systems with semantic similarity matching"}];F.useEffect(()=>{i===2&&Bo.loadDataset().then(()=>{C(Bo.getStats())})},[i]);const A=async()=>{if(i===1){if(!s){_("Please select a use case");return}if(s==="custom"&&!u.trim()){_("Please describe your use case");return}_(null),c(2)}else i===2?c(3):i===3&&(c(4),await D())},D=async()=>{m(!0),_(null);try{const S=r.find(g=>g.id===s),P=n.find(g=>g.id===s);let I,j,H;if(S){I=S.description,j=S.nodes.map((g,k)=>({id:`${g.type}-${k}`,type:g.type,position:{x:100+k*250,y:200},data:{label:g.type.replace(/_/g," ").toUpperCase(),config:g.config||{},metrics:{hitRate:0,latency:0,savings:0}}})),H=[];for(let g=0;g<j.length-1;g++)H.push({id:`e${g}`,source:j[g].id,target:j[g+1].id,animated:!0,style:{stroke:"#10b981"}});a({name:S.name,description:S.description,nodes:j,edges:H,sector:e,compliance:S.compliance,estimatedSavings:S.estimatedSavings,complexity:S.complexity,reasoning:S.reasoning}),m(!1);return}I=s==="custom"?u:P.prompt;const U=await(await fetch("/api/pipeline/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:I,sector:e,performance:f})})).json();if(U.success&&U.pipeline)a(U.pipeline);else throw new Error(U.error||"Failed to generate pipeline")}catch(S){_(S.message),m(!1),c(3)}};return h.jsx("div",{className:"wizard-overlay-new",onClick:o,children:h.jsxs("div",{className:"wizard-modal-new",onClick:S=>S.stopPropagation(),children:[h.jsxs("div",{className:"wizard-header-new",children:[h.jsxs("div",{className:"wizard-brand",children:[h.jsx("div",{className:"wizard-icon",children:h.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:h.jsx("path",{d:"M15 6l-6 6 6 6"})})}),h.jsxs("div",{children:[h.jsx("h2",{children:"AI Pipeline Wizard"}),h.jsx("p",{className:"wizard-subtitle",children:"Configure an end-to-end AI workflow for intelligent caching"})]})]}),h.jsxs("div",{className:"wizard-controls",children:[h.jsxs("div",{className:"step-indicator",children:[h.jsx("span",{className:"step-number",children:i}),h.jsx("span",{className:"step-label",children:i===1?"Use case":i===2?"Analyze":i===3?"Optimize":"Generate"}),h.jsx("span",{className:"step-total",children:"/ 4"})]}),h.jsx("button",{className:"close-btn-new",onClick:o,children:""})]})]}),h.jsxs("div",{className:"wizard-body-new",children:[i===1&&h.jsxs("div",{className:"wizard-step-new",children:[h.jsxs("div",{className:"step-header",children:[h.jsxs("div",{children:[h.jsx("h3",{children:"Select Use Case"}),h.jsx("p",{children:"Choose a starting point. You can refine settings in the next steps."}),h.jsx("p",{className:"legend-hint",children:"Amounts shown are estimated monthly savings from caching, not fees."})]}),h.jsxs("div",{className:"recommended-badge",children:[h.jsx("span",{className:"pulse-dot"}),h.jsx("span",{children:"Recommended"})]})]}),h.jsxs("div",{className:"legend-bar",role:"note","aria-label":"Badge legend",children:[h.jsx("span",{className:"legend-chip legend-savings",children:" Est. savings/mo"}),h.jsx("span",{className:"legend-chip legend-compliance",children:" Compliance badges"}),h.jsx("span",{className:"legend-chip legend-complexity",children:" Enterprise = complexity"})]}),h.jsxs("div",{className:"use-case-grid-new",children:[r.map(S=>h.jsxs("button",{className:`use-case-card-new ${s===S.id?"selected":""} ${S.complexity==="complex"?"recommended":""}`,onClick:()=>l(S.id),children:[h.jsx("div",{className:"card-icon",children:""}),h.jsxs("div",{className:"card-content",children:[h.jsxs("div",{className:"card-title-row",children:[h.jsx("h4",{children:S.name}),S.complexity==="complex"&&h.jsx("span",{className:"badge badge-advanced",title:"Complexity level",children:"Enterprise"}),S.estimatedSavings&&h.jsx("span",{className:"badge badge-savings",title:"Estimated monthly savings vs no caching",children:S.estimatedSavings})]}),h.jsx("p",{children:S.description}),S.compliance&&S.compliance.length>0&&h.jsx("div",{className:"card-tags",children:S.compliance.slice(0,3).map((P,I)=>h.jsxs("span",{className:"tag",children:[" ",P]},I))})]}),s===S.id&&h.jsx("div",{className:"selection-indicator",children:h.jsx("div",{className:"selection-dot"})})]},S.id)),n.map(S=>h.jsxs("button",{className:`use-case-card-new ${s===S.id?"selected":""} ${S.recommended?"recommended":""}`,onClick:()=>l(S.id),children:[h.jsx("div",{className:"card-icon",children:S.icon||""}),h.jsxs("div",{className:"card-content",children:[h.jsxs("div",{className:"card-title-row",children:[h.jsx("h4",{children:S.title}),S.popular&&h.jsx("span",{className:"badge badge-popular",children:"Most popular"}),S.advanced&&h.jsx("span",{className:"badge badge-advanced",children:"Advanced"})]}),h.jsx("p",{children:S.description}),S.tags&&h.jsx("div",{className:"card-tags",children:S.tags.map((P,I)=>h.jsx("span",{className:"tag",children:P},I))})]}),s===S.id&&h.jsx("div",{className:"selection-indicator",children:h.jsx("div",{className:"selection-dot"})})]},S.id))]}),s==="custom"&&h.jsxs("div",{className:"custom-prompt-new",children:[h.jsx("label",{children:"Describe your caching needs:"}),h.jsx("textarea",{value:u,onChange:S=>d(S.target.value),placeholder:"Describe what you want to cache...",rows:4}),h.jsxs("div",{className:"prompt-examples-new",children:[h.jsx("p",{className:"examples-label",children:" Need inspiration? Try these:"}),h.jsx("div",{className:"example-chips",children:x.map((S,P)=>h.jsxs("button",{type:"button",className:"example-chip-new",onClick:()=>d(S.description),children:[h.jsx("span",{className:"chip-icon",children:S.icon}),h.jsx("span",{children:S.title})]},P))})]})]}),v&&h.jsx("div",{className:"error-message-new",children:v})]}),i===2&&h.jsxs("div",{className:"wizard-step-new",children:[h.jsxs("div",{className:"step-header",children:[h.jsx("h3",{children:"Analyze Data"}),h.jsx("p",{children:"Projected impact based on your dataset"})]}),w?h.jsxs("div",{className:"analysis-grid",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",marginTop:"20px"},children:[h.jsxs("div",{className:"stat-card",style:{background:"rgba(255,255,255,0.05)",padding:"20px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.1)"},children:[h.jsx("div",{style:{fontSize:"2rem",marginBottom:"5px"},children:""}),h.jsx("h4",{style:{margin:"0 0 5px 0",color:"#aaa"},children:"Est. Hit Rate"}),h.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"#00f3ff"},children:"42%"}),h.jsx("p",{style:{fontSize:"0.9rem",color:"#666"},children:"Based on semantic clusters"})]}),h.jsxs("div",{className:"stat-card",style:{background:"rgba(255,255,255,0.05)",padding:"20px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.1)"},children:[h.jsx("div",{style:{fontSize:"2rem",marginBottom:"5px"},children:""}),h.jsx("h4",{style:{margin:"0 0 5px 0",color:"#aaa"},children:"Monthly Savings"}),h.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"#00ff9d"},children:"$120"}),h.jsx("p",{style:{fontSize:"0.9rem",color:"#666"},children:"Est. token reduction"})]}),h.jsxs("div",{className:"stat-card",style:{background:"rgba(255,255,255,0.05)",padding:"20px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.1)"},children:[h.jsx("div",{style:{fontSize:"2rem",marginBottom:"5px"},children:""}),h.jsx("h4",{style:{margin:"0 0 5px 0",color:"#aaa"},children:"Latency Drop"}),h.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"#ff0055"},children:"-85%"}),h.jsx("p",{style:{fontSize:"0.9rem",color:"#666"},children:"2.5s  0.4s"})]}),h.jsxs("div",{style:{gridColumn:"1 / -1",marginTop:"20px",padding:"15px",background:"rgba(0, 243, 255, 0.1)",borderRadius:"8px",border:"1px solid rgba(0, 243, 255, 0.2)"},children:[h.jsx("h4",{style:{margin:"0 0 10px 0",color:"#00f3ff"},children:"Dataset Insights"}),h.jsxs("div",{style:{display:"flex",gap:"20px",fontSize:"0.9rem",color:"#ddd"},children:[h.jsxs("span",{children:[" ",h.jsx("strong",{children:w.totalItems})," Samples"]}),h.jsxs("span",{children:[" ",h.jsx("strong",{children:w.avgTokens})," Avg Tokens"]}),h.jsxs("span",{children:[" ",h.jsx("strong",{children:Object.keys(w.categories).length})," Categories"]})]})]})]}):h.jsxs("div",{className:"loading-state-new",children:[h.jsx("div",{className:"spinner-new"}),h.jsx("p",{children:"Analyzing dataset..."})]})]}),i===3&&h.jsxs("div",{className:"wizard-step-new",children:[h.jsxs("div",{className:"step-header",children:[h.jsx("h3",{children:"Optimize For"}),h.jsx("p",{children:"Choose your performance priority"})]}),h.jsxs("div",{className:"performance-options-new",children:[h.jsxs("button",{className:`perf-option-new ${f==="fast"?"selected":""}`,onClick:()=>p("fast"),children:[h.jsx("div",{className:"perf-icon-new",children:""}),h.jsxs("div",{className:"perf-info-new",children:[h.jsx("h4",{children:"Low Latency"}),h.jsx("p",{children:"Minimize response time  L1 only"}),h.jsx("span",{className:"perf-metric-new",children:"~50ms p95"})]})]}),h.jsxs("button",{className:`perf-option-new ${f==="balanced"?"selected":""}`,onClick:()=>p("balanced"),children:[h.jsx("div",{className:"perf-icon-new",children:""}),h.jsxs("div",{className:"perf-info-new",children:[h.jsx("h4",{children:"Balanced"}),h.jsx("p",{children:"Good speed + savings  L1 + L2"}),h.jsx("span",{className:"perf-metric-new perf-recommended",children:"Recommended"})]})]}),h.jsxs("button",{className:`perf-option-new ${f==="cost"?"selected":""}`,onClick:()=>p("cost"),children:[h.jsx("div",{className:"perf-icon-new",children:""}),h.jsxs("div",{className:"perf-info-new",children:[h.jsx("h4",{children:"Cost Optimized"}),h.jsx("p",{children:"Maximum savings  Multi-tier"}),h.jsx("span",{className:"perf-metric-new",children:"$2.40/req saved"})]})]})]})]}),i===4&&h.jsx("div",{className:"wizard-step-new",children:y?h.jsxs("div",{className:"loading-state-new",children:[h.jsx("div",{className:"spinner-new"}),h.jsx("p",{children:"AI is generating your pipeline..."}),h.jsx("span",{className:"loading-subtitle-new",children:"Analyzing use case and optimizing nodes"})]}):v?h.jsxs("div",{className:"error-state-new",children:[h.jsx("p",{children:v}),h.jsx("button",{className:"btn-new btn-secondary-new",onClick:()=>c(3),children:"Try Again"})]}):null})]}),h.jsxs("div",{className:"wizard-footer-new",children:[h.jsxs("div",{className:"footer-hint",children:[h.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("circle",{cx:"12",cy:"12",r:"10"}),h.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),h.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),h.jsx("span",{children:"You can modify data sources, models, and latency targets in later steps."})]}),h.jsxs("div",{className:"footer-actions",children:[i>1&&i<4&&h.jsx("button",{className:"btn-new btn-secondary-new",onClick:()=>c(i-1),children:"Back"}),i<4&&h.jsxs("button",{className:"btn-new btn-primary-new",onClick:A,children:[h.jsx("span",{children:i===3?"Generate Pipeline":"Next"}),h.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[h.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),h.jsx("polyline",{points:"12 5 19 12 12 19"})]})]})]})]})]})})}const i0=[{id:"healthcare",icon:"",title:"Healthcare",description:"HIPAA compliance, PHI protection, medical records",compliance:["HIPAA","PHI Detection"],color:"#10b981"},{id:"finance",icon:"",title:"Finance",description:"PCI-DSS, fraud detection, transaction security",compliance:["PCI-DSS","SOX"],color:"#f59e0b"},{id:"legal",icon:"",title:"Legal",description:"Data retention, compliance, confidentiality",compliance:["Data Retention","Audit Logs"],color:"#8b5cf6"},{id:"ecommerce",icon:"",title:"E-commerce",description:"Product data, inventory, customer sessions",compliance:["PCI-DSS","GDPR"],color:"#3b82f6"},{id:"saas",icon:"",title:"SaaS",description:"API caching, multi-tenant, rate limiting",compliance:["SOC 2","Multi-tenant"],color:"#06b6d4"},{id:"general",icon:"",title:"General",description:"Standard caching, no special requirements",compliance:["Standard"],color:"#64748b"}];function a0({onComplete:e,onSkip:t}){const[o,a]=F.useState(null),r=()=>{o&&e(o)};return h.jsx("div",{className:"wizard-overlay",children:h.jsxs("div",{className:"wizard-modal sector-modal",children:[h.jsx("div",{className:"wizard-header",children:h.jsxs("div",{children:[h.jsx("h2",{children:"Welcome to AgentCache Studio"}),h.jsx("p",{className:"subtitle",children:"Choose your industry to customize your experience"})]})}),h.jsx("div",{className:"wizard-body",children:h.jsx("div",{className:"sector-grid",children:i0.map(n=>h.jsxs("div",{className:`sector-card ${o===n.id?"selected":""}`,onClick:()=>a(n.id),style:{"--sector-color":n.color},children:[h.jsx("div",{className:"sector-icon",children:n.icon}),h.jsx("h3",{children:n.title}),h.jsx("p",{className:"sector-description",children:n.description}),h.jsx("div",{className:"sector-compliance",children:n.compliance.map(i=>h.jsx("span",{className:"compliance-badge",children:i},i))})]},n.id))})}),h.jsxs("div",{className:"wizard-footer",children:[h.jsx("button",{className:"btn btn-secondary",onClick:()=>t("general"),children:"Skip for now"}),h.jsx("button",{className:"btn btn-primary",onClick:r,disabled:!o,children:"Continue"})]})]})})}function s0({selectedNode:e}){if(!e)return h.jsx("aside",{className:"metrics-panel",children:h.jsx("div",{className:"metrics-empty",children:h.jsx("p",{children:"Click a node to view details"})})});const{data:t}=e,{label:o,config:a={},metrics:r={}}=t;return h.jsxs("aside",{className:"metrics-panel",children:[h.jsx("div",{className:"panel-header",children:h.jsx("h3",{children:"Node Details"})}),h.jsxs("div",{className:"panel-section",children:[h.jsx("h4",{children:"Info"}),h.jsxs("div",{className:"info-grid",children:[h.jsxs("div",{className:"info-item",children:[h.jsx("span",{className:"info-label",children:"Type"}),h.jsx("span",{className:"info-value",children:e.type})]}),h.jsxs("div",{className:"info-item",children:[h.jsx("span",{className:"info-label",children:"Label"}),h.jsx("span",{className:"info-value",children:o})]})]})]}),Object.keys(a).length>0&&h.jsxs("div",{className:"panel-section",children:[h.jsx("h4",{children:"Configuration"}),h.jsx("div",{className:"config-list",children:Object.entries(a).map(([n,i])=>h.jsxs("div",{className:"config-item",children:[h.jsx("span",{className:"config-key",children:n}),h.jsx("span",{className:"config-value",children:typeof i=="object"?JSON.stringify(i):String(i)})]},n))})]}),Object.keys(r).length>0&&h.jsxs("div",{className:"panel-section",children:[h.jsx("h4",{children:"Live Metrics"}),h.jsxs("div",{className:"metrics-grid",children:[r.hitRate>0&&h.jsxs("div",{className:"metric-card",children:[h.jsx("span",{className:"metric-label",children:"Hit Rate"}),h.jsxs("span",{className:"metric-value",children:[Math.round(r.hitRate*100),"%"]})]}),r.latency>0&&h.jsxs("div",{className:"metric-card",children:[h.jsx("span",{className:"metric-label",children:"Latency"}),h.jsxs("span",{className:"metric-value",children:[r.latency,"ms"]})]}),r.savings>0&&h.jsxs("div",{className:"metric-card",children:[h.jsx("span",{className:"metric-label",children:"Savings"}),h.jsxs("span",{className:"metric-value",children:["$",r.savings]})]})]})]})]})}const Ca={healthcare:[{id:"patient_records",title:" Patient Records",description:"Cache medical records with HIPAA compliance",prompt:"Cache patient medical records with HIPAA compliance and PHI detection",nodes:["input","phi_filter","cache_l1","cache_l2","hipaa_audit","openai","output"]},{id:"clinical_decision",title:" Clinical Decision Support",description:"AI-powered diagnosis with audit trails",prompt:"Cache clinical decision support AI with full audit logging",nodes:["input","phi_filter","cache_l1","anthropic","hipaa_audit","output"]},{id:"ehr_integration",title:" EHR Integration",description:"Electronic health record system caching",prompt:"Cache EHR system queries with encryption and compliance",nodes:["input","cache_l1","cache_l2","phi_filter","hipaa_audit","output"]},{id:"custom",title:" Custom Healthcare",description:"Describe your own healthcare use case",prompt:"",nodes:[]}],finance:[{id:"risk_analysis",title:" Risk Analysis",description:"Fraud detection and risk scoring",prompt:"Cache risk analysis and fraud detection for financial transactions",nodes:["input","fraud_detector","cache_l1","cache_l2","openai","pci_audit","output"]},{id:"transaction_processing",title:" Transaction Processing",description:"High-speed payment validation",prompt:"Cache transaction validation with PCI-DSS compliance",nodes:["input","transaction_validator","cache_l1","pci_audit","output"]},{id:"kyc_compliance",title:" KYC Compliance",description:"Know Your Customer verification",prompt:"Cache KYC verification results with audit trail",nodes:["input","cache_l1","cache_l2","anthropic","pci_audit","output"]},{id:"custom",title:" Custom Finance",description:"Describe your own financial use case",prompt:"",nodes:[]}],legal:[{id:"document_analysis",title:" Document Analysis",description:"Legal document review and search",prompt:"Cache legal document analysis with retention policies",nodes:["input","cache_l1","cache_l2","anthropic","retention_policy","output"]},{id:"case_research",title:" Case Research",description:"Case law and precedent lookup",prompt:"Cache case law research with audit logging",nodes:["input","semantic_dedup","cache_l2","cache_l3","openai","audit_logger","output"]},{id:"custom",title:" Custom Legal",description:"Describe your own legal use case",prompt:"",nodes:[]}],ecommerce:[{id:"product_search",title:" Product Search",description:"Fast product catalog search",prompt:"Cache product search and recommendations",nodes:["input","cache_l1","semantic_dedup","openai","output"]},{id:"inventory_sync",title:" Inventory Sync",description:"Real-time inventory availability",prompt:"Cache inventory status with short TTL for freshness",nodes:["input","cache_l1","output"]},{id:"personalization",title:" Personalization",description:"User recommendations and preferences",prompt:"Cache personalized recommendations per user",nodes:["input","cache_l1","cache_l2","gemini","output"]},{id:"custom",title:" Custom E-commerce",description:"Describe your own e-commerce use case",prompt:"",nodes:[]}],saas:[{id:"api_caching",title:" API Caching",description:"Multi-tenant API response caching",prompt:"Cache API responses with tenant isolation",nodes:["input","cache_l1","cache_l2","output"]},{id:"ai_features",title:" AI Features",description:"AI-powered product features",prompt:"Cache AI completions for SaaS features",nodes:["input","semantic_dedup","cache_l1","cache_l2","openai","output"]},{id:"analytics",title:" Analytics",description:"Dashboard data aggregation",prompt:"Cache analytics queries and dashboard data",nodes:["input","cache_l2","cache_l3","output"]},{id:"custom",title:" Custom SaaS",description:"Describe your own SaaS use case",prompt:"",nodes:[]}],general:[{id:"api_basic",title:" API Caching",description:"Basic API response caching",prompt:"Cache API responses to reduce latency",nodes:["input","cache_l1","cache_l2","output"]},{id:"llm_caching",title:" LLM Caching",description:"Cache AI model responses",prompt:"Cache LLM completions to save costs",nodes:["input","semantic_dedup","cache_l1","cache_l2","openai","output"]},{id:"database",title:" Database Query",description:"Cache expensive database queries",prompt:"Cache database query results",nodes:["input","cache_l1","cache_l2","cache_l3","output"]},{id:"custom",title:" Custom",description:"Describe your own use case",prompt:"",nodes:[]}]},Ea={healthcare:[{category:"input",types:["input"]},{category:"cache",types:["cache_l1","cache_l2","cache_l3"]},{category:"intelligence",types:["semantic_dedup","phi_filter"]},{category:"llm",types:["openai","anthropic","gemini"]},{category:"compliance",types:["hipaa_audit","encrypted_cache"]},{category:"output",types:["output"]}],finance:[{category:"input",types:["input"]},{category:"cache",types:["cache_l1","cache_l2","cache_l3"]},{category:"intelligence",types:["semantic_dedup","fraud_detector","transaction_validator"]},{category:"llm",types:["openai","anthropic","gemini"]},{category:"compliance",types:["pci_audit","sox_logger"]},{category:"output",types:["output"]}],legal:[{category:"input",types:["input"]},{category:"cache",types:["cache_l1","cache_l2","cache_l3"]},{category:"intelligence",types:["semantic_dedup"]},{category:"llm",types:["openai","anthropic","gemini"]},{category:"compliance",types:["retention_policy","audit_logger"]},{category:"output",types:["output"]}],ecommerce:[{category:"input",types:["input"]},{category:"cache",types:["cache_l1","cache_l2"]},{category:"intelligence",types:["semantic_dedup"]},{category:"llm",types:["openai","anthropic","gemini"]},{category:"output",types:["output"]}],saas:[{category:"input",types:["input"]},{category:"cache",types:["cache_l1","cache_l2","cache_l3"]},{category:"intelligence",types:["semantic_dedup"]},{category:"llm",types:["openai","anthropic","gemini"]},{category:"output",types:["output"]}],general:[{category:"input",types:["input"]},{category:"cache",types:["cache_l1","cache_l2","cache_l3"]},{category:"intelligence",types:["semantic_dedup"]},{category:"llm",types:["openai","anthropic","gemini"]},{category:"output",types:["output"]}]},Na={healthcare:{required:["hipaa","phi"],autoAddNodes:["phi_filter","hipaa_audit"],retention:"7 years",encryption:"required"},finance:{required:["pci_dss","sox"],autoAddNodes:["pci_audit"],retention:"7 years",encryption:"required"},legal:{required:["data_retention"],autoAddNodes:["retention_policy","audit_logger"],retention:"10 years",encryption:"recommended"},ecommerce:{required:["pci_dss","gdpr"],autoAddNodes:[],retention:"2 years",encryption:"recommended"},saas:{required:["soc2"],autoAddNodes:[],retention:"1 year",encryption:"recommended"},general:{required:[],autoAddNodes:[],retention:"30 days",encryption:"optional"}};function ka(e){return{templates:Ca[e]||Ca.general,nodes:Ea[e]||Ea.general,compliance:Na[e]||Na.general}}const bc=F.createContext();function c0({children:e}){const[t,o]=F.useState(null),[a,r]=F.useState(null),[n,i]=F.useState(!1);F.useEffect(()=>{const l=localStorage.getItem("agentcache_sector");l?(o(l),r(ka(l))):i(!0)},[]);const c=l=>{o(l),r(ka(l)),localStorage.setItem("agentcache_sector",l),i(!1)},s=()=>{i(!0)};return h.jsx(bc.Provider,{value:{sector:t,config:a,selectSector:c,changeSector:s,showSectorModal:n,setShowSectorModal:i},children:e})}function hi(){const e=F.useContext(bc);if(!e)throw new Error("useSector must be used within SectorProvider");return e}const Aa={healthcare:[{id:"hipaa_rag",name:"HIPAA-Compliant RAG",description:"Production RAG with PHI protection and audit logging",icon:"",tier:"enterprise",estimatedSavings:"$4,200/mo",metrics:{hitRate:.88,latency:67,savingsPerRequest:1.4},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"phi_filter",position:{x:350,y:200},config:{detection_threshold:.95,redaction_mode:"mask"}},{type:"cache_l1",position:{x:600,y:200},config:{ttl:300,max_size:"500MB"}},{type:"cache_l2",position:{x:850,y:200},config:{ttl:3600,storage:"redis"}},{type:"openai",position:{x:1100,y:200},config:{model:"gpt-4",temperature:.7}},{type:"hipaa_audit",position:{x:1350,y:200},config:{retention:"7 years",log_level:"full"}},{type:"output",position:{x:1600,y:200},config:{}}],edges:[{source:"input-0",target:"phi_filter-1"},{source:"phi_filter-1",target:"cache_l1-2"},{source:"cache_l1-2",target:"cache_l2-3",label:"MISS"},{source:"cache_l2-3",target:"openai-4",label:"MISS"},{source:"openai-4",target:"hipaa_audit-5"},{source:"hipaa_audit-5",target:"output-6"}],tags:["rag","hipaa","phi","audit"],useCase:"Clinical decision support, patient record retrieval",compliance:["HIPAA","PHI Detection"],recommended:!0},{id:"ehr_integration",name:"EHR System Cache",description:"High-performance caching for electronic health records",icon:"",tier:"professional",estimatedSavings:"$2,800/mo",metrics:{hitRate:.92,latency:45,savingsPerRequest:.95},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"cache_l1",position:{x:350,y:200},config:{ttl:600,max_size:"1GB"}},{type:"cache_l2",position:{x:600,y:200},config:{ttl:7200,storage:"redis"}},{type:"encrypted_cache",position:{x:850,y:200},config:{encryption:"AES-256"}},{type:"output",position:{x:1100,y:200},config:{}}],edges:[{source:"input-0",target:"cache_l1-1"},{source:"cache_l1-1",target:"cache_l2-2",label:"MISS"},{source:"cache_l2-2",target:"encrypted_cache-3",label:"MISS"},{source:"encrypted_cache-3",target:"output-4"}],tags:["ehr","performance","encryption"],useCase:"Fast EHR queries, patient lookup",compliance:["Encryption at Rest"]}],finance:[{id:"fraud_detection",name:"Real-Time Fraud Detection",description:"Sub-50ms fraud scoring with compliance audit",icon:"",tier:"enterprise",estimatedSavings:"$6,500/mo",metrics:{hitRate:.85,latency:38,savingsPerRequest:2.1},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"fraud_detector",position:{x:350,y:200},config:{threshold:.8,check_velocity:!0}},{type:"cache_l1",position:{x:600,y:200},config:{ttl:120,max_size:"500MB"}},{type:"openai",position:{x:850,y:200},config:{model:"gpt-4",temperature:.3}},{type:"pci_audit",position:{x:1100,y:200},config:{retention:"7 years"}},{type:"output",position:{x:1350,y:200},config:{}}],edges:[{source:"input-0",target:"fraud_detector-1"},{source:"fraud_detector-1",target:"cache_l1-2"},{source:"cache_l1-2",target:"openai-3",label:"MISS"},{source:"openai-3",target:"pci_audit-4"},{source:"pci_audit-4",target:"output-5"}],tags:["fraud","pci-dss","real-time"],useCase:"Transaction fraud scoring, risk analysis",compliance:["PCI-DSS","SOX"],recommended:!0},{id:"kyc_verification",name:"KYC Compliance Pipeline",description:"Know Your Customer verification with full audit trail",icon:"",tier:"enterprise",estimatedSavings:"$3,100/mo",metrics:{hitRate:.78,latency:95,savingsPerRequest:1.85},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"cache_l2",position:{x:350,y:200},config:{ttl:86400,storage:"postgresql"}},{type:"anthropic",position:{x:600,y:200},config:{model:"claude-3-opus"}},{type:"pci_audit",position:{x:850,y:200},config:{retention:"7 years",log_pii:!1}},{type:"output",position:{x:1100,y:200},config:{}}],edges:[{source:"input-0",target:"cache_l2-1"},{source:"cache_l2-1",target:"anthropic-2",label:"MISS"},{source:"anthropic-2",target:"pci_audit-3"},{source:"pci_audit-3",target:"output-4"}],tags:["kyc","compliance","identity"],useCase:"Customer verification, AML compliance",compliance:["KYC","AML"]}],legal:[{id:"contract_analysis",name:"Legal Contract Analysis",description:"AI-powered contract review with confidentiality protection",icon:"",tier:"enterprise",estimatedSavings:"$5,200/mo",metrics:{hitRate:.83,latency:78,savingsPerRequest:1.95},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"cache_l1",position:{x:350,y:200},config:{ttl:900,max_size:"750MB"}},{type:"cache_l2",position:{x:600,y:200},config:{ttl:7200,storage:"postgresql"}},{type:"anthropic",position:{x:850,y:200},config:{model:"claude-3-opus",temperature:.2}},{type:"output",position:{x:1100,y:200},config:{}}],edges:[{source:"input-0",target:"cache_l1-1"},{source:"cache_l1-1",target:"cache_l2-2",label:"MISS"},{source:"cache_l2-2",target:"anthropic-3",label:"MISS"},{source:"anthropic-3",target:"output-4"}],tags:["legal","contracts","compliance"],useCase:"Contract review, legal research, clause extraction",compliance:["Attorney-Client Privilege"],recommended:!0},{id:"case_law_search",name:"Case Law Search Cache",description:"Fast semantic search across legal precedents",icon:"",tier:"professional",estimatedSavings:"$2,400/mo",metrics:{hitRate:.91,latency:52,savingsPerRequest:1.1},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"semantic_dedup",position:{x:350,y:200},config:{threshold:.88}},{type:"cache_l2",position:{x:600,y:200},config:{ttl:14400,storage:"redis"}},{type:"openai",position:{x:850,y:200},config:{model:"gpt-4"}},{type:"output",position:{x:1100,y:200},config:{}}],edges:[{source:"input-0",target:"semantic_dedup-1"},{source:"semantic_dedup-1",target:"cache_l2-2"},{source:"cache_l2-2",target:"openai-3",label:"MISS"},{source:"openai-3",target:"output-4"}],tags:["legal","research","semantic-search"],useCase:"Case law research, precedent analysis",compliance:[]}],ecommerce:[{id:"product_recommendations",name:"AI Product Recommendations",description:"Personalized product suggestions with high-speed caching",icon:"",tier:"professional",estimatedSavings:"$4,100/mo",metrics:{hitRate:.94,latency:35,savingsPerRequest:.75},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"cache_l1",position:{x:350,y:200},config:{ttl:180,max_size:"1GB"}},{type:"cache_l2",position:{x:600,y:200},config:{ttl:1800,storage:"redis"}},{type:"openai",position:{x:850,y:200},config:{model:"gpt-3.5-turbo",temperature:.7}},{type:"output",position:{x:1100,y:200},config:{}}],edges:[{source:"input-0",target:"cache_l1-1"},{source:"cache_l1-1",target:"cache_l2-2",label:"MISS"},{source:"cache_l2-2",target:"openai-3",label:"MISS"},{source:"openai-3",target:"output-4"}],tags:["ecommerce","recommendations","personalization"],useCase:"Product recommendations, upselling, cross-selling",recommended:!0},{id:"customer_support",name:"E-commerce Support Bot",description:"AI customer support with order context caching",icon:"",tier:"starter",estimatedSavings:"$1,900/mo",metrics:{hitRate:.87,latency:48,savingsPerRequest:.65},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"cache_l1",position:{x:350,y:200},config:{ttl:300}},{type:"semantic_dedup",position:{x:600,y:200},config:{threshold:.9}},{type:"openai",position:{x:850,y:200},config:{model:"gpt-3.5-turbo"}},{type:"output",position:{x:1100,y:200},config:{}}],edges:[{source:"input-0",target:"cache_l1-1"},{source:"cache_l1-1",target:"semantic_dedup-2",label:"MISS"},{source:"semantic_dedup-2",target:"openai-3"},{source:"openai-3",target:"output-4"}],tags:["ecommerce","support","chatbot"],useCase:"Customer support, order status, FAQ",recommended:!0}],saas:[{id:"multi_tenant_api",name:"Multi-Tenant API Cache",description:"Isolated caching per tenant with cost allocation",icon:"",tier:"professional",estimatedSavings:"$3,800/mo",metrics:{hitRate:.89,latency:52,savingsPerRequest:1.25},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"cache_l1",position:{x:350,y:200},config:{ttl:300,namespace_isolation:!0}},{type:"cache_l2",position:{x:600,y:200},config:{ttl:1800,storage:"redis"}},{type:"semantic_dedup",position:{x:850,y:200},config:{threshold:.92}},{type:"openai",position:{x:1100,y:200},config:{model:"gpt-4"}},{type:"output",position:{x:1350,y:200},config:{}}],edges:[{source:"input-0",target:"cache_l1-1"},{source:"cache_l1-1",target:"cache_l2-2",label:"MISS"},{source:"cache_l2-2",target:"semantic_dedup-3",label:"MISS"},{source:"semantic_dedup-3",target:"openai-4"},{source:"openai-4",target:"output-5"}],tags:["multi-tenant","saas","isolation"],useCase:"B2B SaaS AI features, per-customer caching",recommended:!0}],education:[{id:"intelligent_tutor",name:"Intelligent Tutoring System",description:"FERPA-compliant AI tutor with pedagogical validation",icon:"",tier:"professional",estimatedSavings:"$2,400/mo",metrics:{hitRate:.9,latency:120,savingsPerRequest:.95},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"ferpa_filter",position:{x:350,y:200},config:{mode:"redact",protected_fields:["student_id","grades"]}},{type:"cache_l3",position:{x:600,y:200},config:{ttl:2592e3,storage:"postgresql"}},{type:"openai",position:{x:850,y:200},config:{model:"gpt-4o",temperature:.7}},{type:"learning_analytics",position:{x:1100,y:200},config:{anonymize:!0,track_metrics:["questions_asked","topics"]}},{type:"output",position:{x:1350,y:200},config:{}}],edges:[{source:"input-0",target:"ferpa_filter-1"},{source:"ferpa_filter-1",target:"cache_l3-2"},{source:"cache_l3-2",target:"openai-3",label:"MISS"},{source:"openai-3",target:"learning_analytics-4"},{source:"learning_analytics-4",target:"output-5"}],tags:["education","ferpa","tutoring"],useCase:"AI tutoring, homework help, adaptive learning",compliance:["FERPA","COPPA"],recommended:!0}],enterprise:[{id:"knowledge_assistant",name:"Enterprise Knowledge Assistant",description:"Internal knowledge base with department routing",icon:"",tier:"enterprise",estimatedSavings:"$3,200/mo",metrics:{hitRate:.8,latency:150,savingsPerRequest:1.05},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"sso_connector",position:{x:350,y:200},config:{provider:"okta",namespace_from_group:!0}},{type:"department_router",position:{x:600,y:200},config:{departments:["hr","it"],auto_detect:!0}},{type:"cache_l2",position:{x:850,y:200},config:{ttl:86400,storage:"redis"}},{type:"openai",position:{x:1100,y:200},config:{model:"gpt-4"}},{type:"output",position:{x:1350,y:200},config:{}}],edges:[{source:"input-0",target:"sso_connector-1"},{source:"sso_connector-1",target:"department_router-2"},{source:"department_router-2",target:"cache_l2-3"},{source:"cache_l2-3",target:"openai-4",label:"MISS"},{source:"openai-4",target:"output-5"}],tags:["enterprise","internal","sso"],useCase:"HR Q&A, IT support, internal documentation",compliance:["SOC2"],recommended:!0}],developer:[{id:"code_assistant",name:"Code Intelligence",description:"Context-aware code generation with reasoning cache",icon:"",tier:"professional",estimatedSavings:"$3,800/mo",metrics:{hitRate:.9,latency:85,savingsPerRequest:2.15},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"secret_scanner",position:{x:350,y:200},config:{mode:"redact",patterns:["aws","github","openai"]}},{type:"reasoning_cache",position:{x:600,y:200},config:{cache_traces:!0,ttl_days:30}},{type:"cache_l3",position:{x:850,y:200},config:{ttl:604800,storage:"postgresql"}},{type:"openai",position:{x:1100,y:200},config:{model:"gpt-4o"}},{type:"cost_tracker",position:{x:1350,y:200},config:{group_by:"project",budget_alert:50}},{type:"output",position:{x:1600,y:200},config:{}}],edges:[{source:"input-0",target:"secret_scanner-1"},{source:"secret_scanner-1",target:"reasoning_cache-2"},{source:"reasoning_cache-2",target:"cache_l3-3"},{source:"cache_l3-3",target:"openai-4",label:"MISS"},{source:"openai-4",target:"cost_tracker-5"},{source:"cost_tracker-5",target:"output-6"}],tags:["developer","code","reasoning"],useCase:"Code generation, debugging, documentation",recommended:!0}],datascience:[{id:"rag_ml_pipeline",name:"RAG + ML Pipeline",description:"Lakehouse-connected RAG with embedding cache",icon:"",tier:"enterprise",estimatedSavings:"$5,600/mo",metrics:{hitRate:.8,latency:180,savingsPerRequest:1.85},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"lakehouse_source",position:{x:350,y:200},config:{platform:"databricks",catalog:"main"}},{type:"embedding_cache",position:{x:600,y:200},config:{model:"text-embedding-3-small",ttl_days:30}},{type:"cache_l2",position:{x:850,y:200},config:{ttl:86400,storage:"redis"}},{type:"openai",position:{x:1100,y:200},config:{model:"gpt-4o"}},{type:"experiment_tracker",position:{x:1350,y:200},config:{platform:"mlflow",log_metrics:!0}},{type:"output",position:{x:1600,y:200},config:{}}],edges:[{source:"input-0",target:"lakehouse_source-1"},{source:"lakehouse_source-1",target:"embedding_cache-2"},{source:"embedding_cache-2",target:"cache_l2-3"},{source:"cache_l2-3",target:"openai-4",label:"MISS"},{source:"openai-4",target:"experiment_tracker-5"},{source:"experiment_tracker-5",target:"output-6"}],tags:["datascience","rag","ml","embeddings"],useCase:"RAG systems, data analysis, feature engineering",compliance:["SOC2"],recommended:!0}],government:[{id:"secure_gov_intelligence",name:"Secure Government Intelligence",description:"FedRAMP-compliant pipeline with IL2/IL4/IL5 support",icon:"",tier:"enterprise",estimatedSavings:"$8,400/mo",metrics:{hitRate:.75,latency:200,savingsPerRequest:2.8},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"security_gate",position:{x:350,y:200},config:{impact_level:"IL4",classification_check:!0}},{type:"cui_filter",position:{x:600,y:200},config:{mode:"block",cui_detection:!0}},{type:"cache_l2",position:{x:850,y:200},config:{ttl:3600,storage:"postgresql",region:"us-gov-west-1"}},{type:"openai",position:{x:1100,y:200},config:{model:"gpt-4o"}},{type:"fedramp_audit",position:{x:1350,y:200},config:{nist_controls:!0,oscal_export:!0}},{type:"output",position:{x:1600,y:200},config:{}}],edges:[{source:"input-0",target:"security_gate-1"},{source:"security_gate-1",target:"cui_filter-2"},{source:"cui_filter-2",target:"cache_l2-3"},{source:"cache_l2-3",target:"openai-4",label:"MISS"},{source:"openai-4",target:"fedramp_audit-5"},{source:"fedramp_audit-5",target:"output-6"}],tags:["government","fedramp","fisma","classified"],useCase:"Citizen services, scientific research, national security",compliance:["FedRAMP","FISMA","NIST 800-53"],recommended:!0}],general:[{id:"basic_llm_cache",name:"Basic LLM Cache",description:"Simple, fast caching for any LLM API",icon:"",tier:"starter",estimatedSavings:"$1,200/mo",metrics:{hitRate:.82,latency:48,savingsPerRequest:.85},nodes:[{type:"input",position:{x:100,y:200},config:{}},{type:"cache_l1",position:{x:350,y:200},config:{ttl:600}},{type:"cache_l2",position:{x:600,y:200},config:{ttl:3600}},{type:"openai",position:{x:850,y:200},config:{}},{type:"output",position:{x:1100,y:200},config:{}}],edges:[{source:"input-0",target:"cache_l1-1"},{source:"cache_l1-1",target:"cache_l2-2",label:"MISS"},{source:"cache_l2-2",target:"openai-3",label:"MISS"},{source:"openai-3",target:"output-4"}],tags:["simple","starter","llm"],useCase:"Basic chatbots, simple API caching",recommended:!0}]};function wc(e){return Aa[e]||Aa.general}function l0(e){return wc(e).filter(o=>o.recommended)}function u0({onLoadPreset:e,onClose:t}){const{sector:o}=hi(),[a,r]=F.useState("all"),n=wc(o),i=a==="recommended"?l0(o):n,c=s=>{const l=s.nodes.map((d,f)=>({id:`${d.type}-${f}`,type:d.type,position:d.position,data:{label:d.type.replace(/_/g," ").toUpperCase(),config:d.config||{},metrics:s.metrics}})),u=s.edges.map((d,f)=>({id:`edge-${f}`,source:d.source,target:d.target,label:d.label,type:"smoothstep",animated:!0}));e({name:s.name,nodes:l,edges:u,metadata:{id:s.id,description:s.description,tier:s.tier,estimatedSavings:s.estimatedSavings,tags:s.tags,useCase:s.useCase,compliance:s.compliance}})};return h.jsx("div",{className:"workspace-gallery-overlay",children:h.jsxs("div",{className:"workspace-gallery",children:[h.jsxs("div",{className:"gallery-header",children:[h.jsxs("div",{className:"gallery-title-section",children:[h.jsx("h2",{children:" Pipeline Presets"}),h.jsxs("p",{className:"gallery-subtitle",children:["Production-ready pipelines for ",o]})]}),h.jsx("button",{className:"close-btn",onClick:t,children:""})]}),h.jsxs("div",{className:"gallery-filters",children:[h.jsxs("button",{className:`filter-btn ${a==="all"?"active":""}`,onClick:()=>r("all"),children:["All Templates (",n.length,")"]}),h.jsx("button",{className:`filter-btn ${a==="recommended"?"active":""}`,onClick:()=>r("recommended"),children:" Recommended"})]}),h.jsx("div",{className:"gallery-grid",children:i.map(s=>h.jsxs("div",{className:"preset-card",children:[s.recommended&&h.jsx("div",{className:"recommended-badge",children:" Recommended"}),h.jsxs("div",{className:"preset-header",children:[h.jsx("span",{className:"preset-icon",children:s.icon}),h.jsxs("div",{className:"preset-title-section",children:[h.jsx("h3",{children:s.name}),h.jsx("span",{className:`tier-badge tier-${s.tier}`,children:s.tier})]})]}),h.jsx("p",{className:"preset-description",children:s.description}),h.jsxs("div",{className:"preset-metrics",children:[h.jsxs("div",{className:"metric",children:[h.jsx("span",{className:"metric-label",children:"Hit Rate"}),h.jsxs("span",{className:"metric-value",children:[(s.metrics.hitRate*100).toFixed(0),"%"]})]}),h.jsxs("div",{className:"metric",children:[h.jsx("span",{className:"metric-label",children:"Latency"}),h.jsxs("span",{className:"metric-value",children:[s.metrics.latency,"ms"]})]}),h.jsxs("div",{className:"metric",children:[h.jsx("span",{className:"metric-label",children:"Est. Savings"}),h.jsx("span",{className:"metric-value savings",children:s.estimatedSavings})]})]}),h.jsxs("div",{className:"preset-use-case",children:[h.jsx("strong",{children:"Use Case:"})," ",s.useCase]}),s.compliance&&s.compliance.length>0&&h.jsx("div",{className:"compliance-badges",children:s.compliance.map(l=>h.jsx("span",{className:"compliance-badge",children:l},l))}),h.jsx("div",{className:"preset-tags",children:s.tags.map(l=>h.jsxs("span",{className:"tag",children:["#",l]},l))}),h.jsx("button",{className:"load-preset-btn",onClick:()=>c(s),children:"Deploy Pipeline "})]},s.id))}),i.length===0&&h.jsx("div",{className:"no-presets",children:h.jsx("p",{children:"No presets available for this filter."})})]})})}function d0({onOpenWizard:e,onNewPipeline:t,pipelines:o=[]}){const{sector:a}=hi(),r=F.useRef(null),[n,i]=F.useState({totalPipelines:0,activePipelines:0,monthlySavings:0,cacheHitRate:87,avgLatency:52,requestsPerSec:1247});return F.useEffect(()=>{const c=r.current;if(!c)return;const s=c.getContext("2d");c.width=window.innerWidth,c.height=window.innerHeight;const l=[],u=80,d=150;class f{constructor(){this.x=Math.random()*c.width,this.y=Math.random()*c.height,this.vx=(Math.random()-.5)*.5,this.vy=(Math.random()-.5)*.5,this.radius=Math.random()*2+1,this.opacity=Math.random()*.5+.3}update(){this.x+=this.vx,this.y+=this.vy,(this.x<0||this.x>c.width)&&(this.vx*=-1),(this.y<0||this.y>c.height)&&(this.vy*=-1)}draw(){s.beginPath(),s.arc(this.x,this.y,this.radius,0,Math.PI*2),s.fillStyle=`rgba(56, 189, 248, ${this.opacity})`,s.fill()}}for(let v=0;v<u;v++)l.push(new f);function p(){for(let v=0;v<l.length;v++)for(let _=v+1;_<l.length;_++){const w=l[v].x-l[_].x,C=l[v].y-l[_].y,x=Math.sqrt(w*w+C*C);if(x<d){const A=(1-x/d)*.2;s.beginPath(),s.moveTo(l[v].x,l[v].y),s.lineTo(l[_].x,l[_].y),s.strokeStyle=`rgba(56, 189, 248, ${A})`,s.lineWidth=1,s.stroke()}}}function y(){s.clearRect(0,0,c.width,c.height),l.forEach(v=>{v.update(),v.draw()}),p(),requestAnimationFrame(y)}y();const m=()=>{c.width=window.innerWidth,c.height=window.innerHeight};return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]),F.useEffect(()=>{const c=o.filter(u=>u.isActive).length,s=o.length,l=o.reduce((u,d)=>{const f=d.estimatedSavings?.match(/\$?([\d,]+)/);return u+(f?parseInt(f[1].replace(/,/g,"")):0)},0);i({totalPipelines:s,activePipelines:c,monthlySavings:l,cacheHitRate:87+Math.floor(Math.random()*8),avgLatency:48+Math.floor(Math.random()*10),requestsPerSec:1200+Math.floor(Math.random()*300)})},[o]),h.jsxs("div",{className:"command-center pro",children:[h.jsx("canvas",{ref:r,className:"game-canvas"}),h.jsx("div",{className:"canvas-overlay"}),h.jsxs("div",{className:"command-header",children:[h.jsxs("div",{className:"header-left",children:[h.jsxs("h1",{className:"command-title",children:[h.jsx("span",{className:"title-icon",children:""}),"AgentCache Control"]}),h.jsxs("p",{className:"subtitle",children:[a?`${a.charAt(0).toUpperCase()+a.slice(1)} sector`:"Multi-sector","  Intelligent inference orchestration"]})]}),h.jsx("div",{className:"header-right",children:h.jsxs("div",{className:"system-status",children:[h.jsx("div",{className:"pulse-indicator"}),h.jsx("span",{className:"status-text",children:"Operational"})]})})]}),h.jsxs("div",{className:"kpi-strip",children:[h.jsxs("div",{className:"kpi",children:[h.jsx("div",{className:"kpi-label",children:"Hit rate"}),h.jsxs("div",{className:"kpi-value",children:[n.cacheHitRate,"%"]})]}),h.jsxs("div",{className:"kpi",children:[h.jsx("div",{className:"kpi-label",children:"P95 latency"}),h.jsxs("div",{className:"kpi-value",children:[n.avgLatency,"ms"]})]}),h.jsxs("div",{className:"kpi",children:[h.jsx("div",{className:"kpi-label",children:"Monthly savings"}),h.jsxs("div",{className:"kpi-value",children:["$",n.monthlySavings.toLocaleString()]})]}),h.jsxs("div",{className:"kpi",children:[h.jsx("div",{className:"kpi-label",children:"Throughput"}),h.jsxs("div",{className:"kpi-value",children:[n.requestsPerSec.toLocaleString()," req/s"]})]})]}),h.jsxs("div",{className:"control-grid",children:[h.jsxs("div",{className:"control-panel launch-panel",children:[h.jsxs("div",{className:"panel-header",children:[h.jsx("h3",{children:"Quick actions"}),h.jsx("div",{className:"panel-indicator"})]}),h.jsxs("div",{className:"launch-controls",children:[h.jsxs("button",{className:"launch-btn primary-launch",onClick:e,children:[h.jsx("div",{className:"btn-glow"}),h.jsxs("div",{className:"btn-content",children:[h.jsx("span",{className:"btn-icon",children:""}),h.jsx("span",{className:"btn-label",children:"AI PIPELINE WIZARD"}),h.jsx("span",{className:"btn-sublabel",children:"Generate pipeline in 30 seconds"})]}),h.jsx("div",{className:"btn-pulse"})]}),h.jsx("button",{className:"launch-btn secondary-launch",onClick:t,children:h.jsxs("div",{className:"btn-content",children:[h.jsx("span",{className:"btn-icon",children:""}),h.jsx("span",{className:"btn-label",children:"CUSTOM BUILDER"}),h.jsx("span",{className:"btn-sublabel",children:"Build from scratch"})]})})]})]}),h.jsxs("div",{className:"control-panel metrics-panel",children:[h.jsxs("div",{className:"panel-header",children:[h.jsx("h3",{children:"Overview"}),h.jsx("div",{className:"panel-indicator"})]}),h.jsxs("div",{className:"metrics-grid",children:[h.jsxs("div",{className:"metric-card",children:[h.jsx("div",{className:"metric-icon",children:""}),h.jsx("div",{className:"metric-value",children:n.totalPipelines}),h.jsx("div",{className:"metric-label",children:"Total Pipelines"}),h.jsx("div",{className:"metric-bar",children:h.jsx("div",{className:"bar-fill",style:{width:`${n.totalPipelines/10*100}%`}})})]}),h.jsxs("div",{className:"metric-card active",children:[h.jsx("div",{className:"metric-icon",children:""}),h.jsx("div",{className:"metric-value",children:n.activePipelines}),h.jsx("div",{className:"metric-label",children:"Active"}),h.jsx("div",{className:"metric-bar",children:h.jsx("div",{className:"bar-fill",style:{width:`${n.activePipelines/n.totalPipelines*100||0}%`}})})]}),h.jsxs("div",{className:"metric-card savings",children:[h.jsx("div",{className:"metric-icon",children:""}),h.jsxs("div",{className:"metric-value",children:["$",n.monthlySavings.toLocaleString()]}),h.jsx("div",{className:"metric-label",children:"Monthly Savings"}),h.jsx("div",{className:"metric-bar",children:h.jsx("div",{className:"bar-fill",style:{width:"75%"}})})]})]})]}),h.jsxs("div",{className:"control-panel gauges-panel",children:[h.jsxs("div",{className:"panel-header",children:[h.jsx("h3",{children:"Performance"}),h.jsx("div",{className:"panel-indicator"})]}),h.jsxs("div",{className:"gauges-grid",children:[h.jsxs("div",{className:"gauge",children:[h.jsx("div",{className:"gauge-display",children:h.jsxs("svg",{viewBox:"0 0 200 120",className:"gauge-svg",children:[h.jsx("path",{d:"M 20 100 A 80 80 0 0 1 180 100",fill:"none",stroke:"#1e293b",strokeWidth:"20",strokeLinecap:"round"}),h.jsx("path",{d:"M 20 100 A 80 80 0 0 1 180 100",fill:"none",stroke:"url(#cacheGradient)",strokeWidth:"20",strokeLinecap:"round",strokeDasharray:`${n.cacheHitRate*2.51} 251`,className:"gauge-arc"}),h.jsx("defs",{children:h.jsxs("linearGradient",{id:"cacheGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:"#10b981"}),h.jsx("stop",{offset:"100%",stopColor:"#06b6d4"})]})}),h.jsxs("text",{x:"100",y:"80",textAnchor:"middle",className:"gauge-value",children:[n.cacheHitRate,"%"]})]})}),h.jsx("div",{className:"gauge-label",children:"Cache Hit Rate"})]}),h.jsxs("div",{className:"gauge",children:[h.jsx("div",{className:"gauge-display",children:h.jsxs("svg",{viewBox:"0 0 200 120",className:"gauge-svg",children:[h.jsx("path",{d:"M 20 100 A 80 80 0 0 1 180 100",fill:"none",stroke:"#1e293b",strokeWidth:"20",strokeLinecap:"round"}),h.jsx("path",{d:"M 20 100 A 80 80 0 0 1 180 100",fill:"none",stroke:"url(#latencyGradient)",strokeWidth:"20",strokeLinecap:"round",strokeDasharray:`${(100-n.avgLatency/100*100)*2.51} 251`,className:"gauge-arc"}),h.jsx("defs",{children:h.jsxs("linearGradient",{id:"latencyGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:"#0ea5e9"}),h.jsx("stop",{offset:"100%",stopColor:"#6366f1"})]})}),h.jsxs("text",{x:"100",y:"80",textAnchor:"middle",className:"gauge-value",children:[n.avgLatency,"ms"]})]})}),h.jsx("div",{className:"gauge-label",children:"Avg Latency (P95)"})]})]})]}),h.jsxs("div",{className:"control-panel quick-stats",children:[h.jsxs("div",{className:"panel-header",children:[h.jsx("h3",{children:"Operations"}),h.jsx("div",{className:"panel-indicator pulsing"})]}),h.jsxs("div",{className:"stats-list",children:[h.jsxs("div",{className:"stat-item",children:[h.jsx("span",{className:"stat-dot active"}),h.jsx("span",{className:"stat-text",children:"System Health: "}),h.jsx("span",{className:"stat-badge success",children:"OPTIMAL"})]}),h.jsxs("div",{className:"stat-item",children:[h.jsx("span",{className:"stat-dot active"}),h.jsx("span",{className:"stat-text",children:"Edge Nodes: "}),h.jsx("span",{className:"stat-badge info",children:"20 ONLINE"})]}),h.jsxs("div",{className:"stat-item",children:[h.jsx("span",{className:"stat-dot active"}),h.jsx("span",{className:"stat-text",children:"Requests/sec: "}),h.jsx("span",{className:"stat-badge",children:"1,247"})]}),h.jsxs("div",{className:"stat-item",children:[h.jsx("span",{className:"stat-dot active"}),h.jsx("span",{className:"stat-text",children:"Uptime: "}),h.jsx("span",{className:"stat-badge success",children:"99.97%"})]})]})]})]}),n.totalPipelines===0&&h.jsx("div",{className:"floating-hint",children:h.jsxs("div",{className:"hint-content",children:[h.jsx("div",{className:"hint-icon",children:""}),h.jsxs("div",{className:"hint-text",children:[h.jsx("strong",{children:"Get Started"}),h.jsx("p",{children:'Click "AI Pipeline Wizard" to create your first intelligent caching pipeline'})]})]})})]})}function wt({data:e,icon:t,color:o,children:a,handles:r}){const{label:n,metrics:i={}}=e,{hitRate:c=0,latency:s=0,savings:l=0}=i;return h.jsxs("div",{className:"base-node",style:{borderColor:o},children:[r?.input!==!1&&h.jsx(Ot,{type:"target",position:pe.Left,className:"node-handle",style:{background:o}}),h.jsxs("div",{className:"node-header",style:{background:o},children:[h.jsx("span",{className:"node-icon",children:t}),h.jsx("span",{className:"node-label",children:n})]}),i&&Object.keys(i).length>0&&h.jsxs("div",{className:"node-metrics",children:[c>0&&h.jsxs("div",{className:"metric",children:[h.jsx("span",{className:"metric-label",children:"Hit Rate"}),h.jsxs("span",{className:"metric-value",children:[Math.round(c*100),"%"]})]}),s>0&&h.jsxs("div",{className:"metric",children:[h.jsx("span",{className:"metric-label",children:"Latency"}),h.jsxs("span",{className:"metric-value",children:[s,"ms"]})]}),l>0&&h.jsxs("div",{className:"metric",children:[h.jsx("span",{className:"metric-label",children:"Savings"}),h.jsxs("span",{className:"metric-value",children:["$",l]})]})]}),a,r?.output!==!1&&h.jsxs(h.Fragment,{children:[h.jsx(Ot,{type:"source",position:pe.Right,id:"default",className:"node-handle",style:{background:o,top:"50%"}}),r?.miss&&h.jsx(Ot,{type:"source",position:pe.Right,id:"miss",className:"node-handle",style:{background:"#f59e0b",top:"75%"}})]})]})}function f0({data:e}){return h.jsx(wt,{data:e,icon:"",color:"#3b82f6",handles:{input:!1,output:!0}})}function h0({data:e}){return h.jsx(wt,{data:e,icon:"",color:"#10b981",handles:{input:!0,output:!0,miss:!0}})}function p0({data:e}){return h.jsx(wt,{data:e,icon:"",color:"#059669",handles:{input:!0,output:!0,miss:!0}})}function g0({data:e}){const t={icon:"",color:"#047857"},o={input:!0,output:!0};return h.jsx(wt,{data:e,...t,handles:o})}function m0({data:e}){const t={icon:"",color:"#8b5cf6"},o={input:!0,output:!0};return h.jsx(wt,{data:e,...t,handles:o})}function y0({data:e}){const t={icon:"",color:"#7c3aed"},o={input:!0,output:!0};return h.jsx(wt,{data:e,...t,handles:o})}function v0({data:e}){const t={icon:"",color:"#a855f7"},o={input:!0,output:!0};return h.jsx(wt,{data:e,...t,handles:o})}function x0({data:e}){const t={icon:"",color:"#06b6d4"},o={input:!0,output:!0};return h.jsx(wt,{data:e,...t,handles:o})}function _0({data:e}){const t={icon:"",color:"#3b82f6"},o={input:!0,output:!1};return h.jsx(wt,{data:e,...t,handles:o})}const b0={input:f0,cache_l1:h0,cache_l2:p0,cache_l3:g0,openai:m0,anthropic:y0,gemini:v0,semantic_dedup:x0,output:_0},Ta=[{name:"HIPAA-Compliant RAG",sector:"healthcare",isActive:!0,savedAt:new Date(Date.now()-1e3*60*60*2).toISOString(),estimatedSavings:"$4,200/mo",nodes:[{id:"input-0",type:"input",position:{x:100,y:200},data:{label:"INPUT",config:{},metrics:{hitRate:87,latency:48,savings:0}}},{id:"phi_filter-1",type:"phi_filter",position:{x:350,y:200},data:{label:"PHI FILTER",config:{threshold:.95,redaction:"mask"},metrics:{hitRate:87,latency:48,savings:0}}},{id:"cache_l1-2",type:"cache_l1",position:{x:600,y:200},data:{label:"CACHE L1",config:{ttl:300,max_size:"500MB"},metrics:{hitRate:88,latency:12,savings:1200}}},{id:"cache_l2-3",type:"cache_l2",position:{x:850,y:200},data:{label:"CACHE L2",config:{ttl:3600,storage:"redis"},metrics:{hitRate:85,latency:35,savings:1800}}},{id:"openai-4",type:"openai",position:{x:1100,y:200},data:{label:"OPENAI",config:{model:"gpt-4",temperature:.7},metrics:{hitRate:0,latency:850,savings:0}}},{id:"hipaa_audit-5",type:"hipaa_audit",position:{x:1350,y:200},data:{label:"HIPAA AUDIT",config:{retention:"7 years",log_level:"full"},metrics:{hitRate:0,latency:5,savings:0}}},{id:"output-6",type:"output",position:{x:1600,y:200},data:{label:"OUTPUT",config:{},metrics:{hitRate:87,latency:48,savings:0}}}],edges:[{id:"e0",source:"input-0",target:"phi_filter-1",animated:!0,type:"smoothstep"},{id:"e1",source:"phi_filter-1",target:"cache_l1-2",animated:!0,type:"smoothstep"},{id:"e2",source:"cache_l1-2",target:"cache_l2-3",label:"MISS",animated:!0,type:"smoothstep"},{id:"e3",source:"cache_l2-3",target:"openai-4",label:"MISS",animated:!0,type:"smoothstep"},{id:"e4",source:"openai-4",target:"hipaa_audit-5",animated:!0,type:"smoothstep"},{id:"e5",source:"hipaa_audit-5",target:"output-6",animated:!0,type:"smoothstep"}]},{name:"Real-Time Fraud Detection",sector:"finance",isActive:!0,savedAt:new Date(Date.now()-1e3*60*60*5).toISOString(),estimatedSavings:"$6,500/mo",nodes:[{id:"input-0",type:"input",position:{x:100,y:200},data:{label:"INPUT",config:{},metrics:{hitRate:85,latency:38,savings:0}}},{id:"fraud_detector-1",type:"fraud_detector",position:{x:350,y:200},data:{label:"FRAUD DETECTOR",config:{threshold:.8,check_velocity:!0},metrics:{hitRate:85,latency:38,savings:0}}},{id:"cache_l1-2",type:"cache_l1",position:{x:600,y:200},data:{label:"CACHE L1",config:{ttl:120,max_size:"500MB"},metrics:{hitRate:90,latency:8,savings:2200}}},{id:"openai-3",type:"openai",position:{x:850,y:200},data:{label:"OPENAI",config:{model:"gpt-4",temperature:.3},metrics:{hitRate:0,latency:780,savings:0}}},{id:"pci_audit-4",type:"pci_audit",position:{x:1100,y:200},data:{label:"PCI AUDIT",config:{retention:"7 years"},metrics:{hitRate:0,latency:3,savings:0}}},{id:"output-5",type:"output",position:{x:1350,y:200},data:{label:"OUTPUT",config:{},metrics:{hitRate:85,latency:38,savings:0}}}],edges:[{id:"e0",source:"input-0",target:"fraud_detector-1",animated:!0,type:"smoothstep"},{id:"e1",source:"fraud_detector-1",target:"cache_l1-2",animated:!0,type:"smoothstep"},{id:"e2",source:"cache_l1-2",target:"openai-3",label:"MISS",animated:!0,type:"smoothstep"},{id:"e3",source:"openai-3",target:"pci_audit-4",animated:!0,type:"smoothstep"},{id:"e4",source:"pci_audit-4",target:"output-5",animated:!0,type:"smoothstep"}]},{name:"Legal Contract Analysis",sector:"legal",isActive:!1,savedAt:new Date(Date.now()-1e3*60*60*24).toISOString(),estimatedSavings:"$5,200/mo",nodes:[{id:"input-0",type:"input",position:{x:100,y:200},data:{label:"INPUT",config:{},metrics:{hitRate:83,latency:78,savings:0}}},{id:"cache_l1-1",type:"cache_l1",position:{x:350,y:200},data:{label:"CACHE L1",config:{ttl:900,max_size:"750MB"},metrics:{hitRate:83,latency:15,savings:1600}}},{id:"cache_l2-2",type:"cache_l2",position:{x:600,y:200},data:{label:"CACHE L2",config:{ttl:7200,storage:"postgresql"},metrics:{hitRate:78,latency:45,savings:2400}}},{id:"anthropic-3",type:"anthropic",position:{x:850,y:200},data:{label:"ANTHROPIC",config:{model:"claude-3-opus",temperature:.2},metrics:{hitRate:0,latency:920,savings:0}}},{id:"output-4",type:"output",position:{x:1100,y:200},data:{label:"OUTPUT",config:{},metrics:{hitRate:83,latency:78,savings:0}}}],edges:[{id:"e0",source:"input-0",target:"cache_l1-1",animated:!0,type:"smoothstep"},{id:"e1",source:"cache_l1-1",target:"cache_l2-2",label:"MISS",animated:!0,type:"smoothstep"},{id:"e2",source:"cache_l2-2",target:"anthropic-3",label:"MISS",animated:!0,type:"smoothstep"},{id:"e3",source:"anthropic-3",target:"output-4",animated:!0,type:"smoothstep"}]},{name:"E-commerce Recommendations",sector:"ecommerce",isActive:!0,savedAt:new Date(Date.now()-1e3*60*30).toISOString(),estimatedSavings:"$4,100/mo",nodes:[{id:"input-0",type:"input",position:{x:100,y:200},data:{label:"INPUT",config:{},metrics:{hitRate:94,latency:35,savings:0}}},{id:"cache_l1-1",type:"cache_l1",position:{x:350,y:200},data:{label:"CACHE L1",config:{ttl:180,max_size:"1GB"},metrics:{hitRate:94,latency:8,savings:1800}}},{id:"cache_l2-2",type:"cache_l2",position:{x:600,y:200},data:{label:"CACHE L2",config:{ttl:1800,storage:"redis"},metrics:{hitRate:89,latency:22,savings:1500}}},{id:"openai-3",type:"openai",position:{x:850,y:200},data:{label:"OPENAI",config:{model:"gpt-3.5-turbo",temperature:.7},metrics:{hitRate:0,latency:650,savings:0}}},{id:"output-4",type:"output",position:{x:1100,y:200},data:{label:"OUTPUT",config:{},metrics:{hitRate:94,latency:35,savings:0}}}],edges:[{id:"e0",source:"input-0",target:"cache_l1-1",animated:!0,type:"smoothstep"},{id:"e1",source:"cache_l1-1",target:"cache_l2-2",label:"MISS",animated:!0,type:"smoothstep"},{id:"e2",source:"cache_l2-2",target:"openai-3",label:"MISS",animated:!0,type:"smoothstep"},{id:"e3",source:"openai-3",target:"output-4",animated:!0,type:"smoothstep"}]},{name:"Multi-Tenant SaaS Cache",sector:"saas",isActive:!1,savedAt:new Date(Date.now()-1e3*60*60*12).toISOString(),estimatedSavings:"$3,800/mo",nodes:[{id:"input-0",type:"input",position:{x:100,y:200},data:{label:"INPUT",config:{},metrics:{hitRate:89,latency:52,savings:0}}},{id:"cache_l1-1",type:"cache_l1",position:{x:350,y:200},data:{label:"CACHE L1",config:{ttl:300,namespace_isolation:!0},metrics:{hitRate:89,latency:10,savings:1400}}},{id:"cache_l2-2",type:"cache_l2",position:{x:600,y:200},data:{label:"CACHE L2",config:{ttl:1800,storage:"redis"},metrics:{hitRate:84,latency:32,savings:1600}}},{id:"semantic_dedup-3",type:"semantic_dedup",position:{x:850,y:200},data:{label:"SEMANTIC DEDUP",config:{threshold:.92},metrics:{hitRate:78,latency:45,savings:800}}},{id:"openai-4",type:"openai",position:{x:1100,y:200},data:{label:"OPENAI",config:{model:"gpt-4"},metrics:{hitRate:0,latency:820,savings:0}}},{id:"output-5",type:"output",position:{x:1350,y:200},data:{label:"OUTPUT",config:{},metrics:{hitRate:89,latency:52,savings:0}}}],edges:[{id:"e0",source:"input-0",target:"cache_l1-1",animated:!0,type:"smoothstep"},{id:"e1",source:"cache_l1-1",target:"cache_l2-2",label:"MISS",animated:!0,type:"smoothstep"},{id:"e2",source:"cache_l2-2",target:"semantic_dedup-3",label:"MISS",animated:!0,type:"smoothstep"},{id:"e3",source:"semantic_dedup-3",target:"openai-4",animated:!0,type:"smoothstep"},{id:"e4",source:"openai-4",target:"output-5",animated:!0,type:"smoothstep"}]}];function w0(e=!1){const t=localStorage.getItem("savedPipelines");return!t||e||t==="[]"?(localStorage.setItem("savedPipelines",JSON.stringify(Ta)),console.log(" Demo data loaded:",Ta.length,"pipelines"),!0):(console.log(" Demo data already exists, skipping load"),!1)}function S0(){return window.location.search.includes("demo=true")||window.location.pathname.includes("/demo")}function C0(){S0()&&w0(!0)}class Ze extends Error{constructor(t,o=null){super(t),this.name="ValidationError",this.field=o}}function Ma(e){if(!e||typeof e!="object")throw new Ze("Pipeline must be an object");if(!e.name||typeof e.name!="string")throw new Ze("Pipeline must have a valid name","name");if(e.name.length>255)throw new Ze("Pipeline name must be less than 255 characters","name");if(!Array.isArray(e.nodes))throw new Ze("Pipeline must have a nodes array","nodes");if(e.nodes.length===0)throw new Ze("Pipeline must have at least one node","nodes");if(!Array.isArray(e.edges))throw new Ze("Pipeline must have an edges array","edges");const t=new Set;for(const a of e.nodes){if(!a.id)throw new Ze("All nodes must have an ID","nodes");if(t.has(a.id))throw new Ze(`Duplicate node ID found: ${a.id}`,"nodes");t.add(a.id)}for(const a of e.edges){if(!a.source||!a.target)throw new Ze("All edges must have source and target","edges");if(!t.has(a.source))throw new Ze(`Edge references non-existent source node: ${a.source}`,"edges");if(!t.has(a.target))throw new Ze(`Edge references non-existent target node: ${a.target}`,"edges")}if(E0(e.nodes,e.edges))throw new Ze("Pipeline contains circular dependencies","edges");const o=["healthcare","finance","legal","ecommerce","saas","general"];if(e.sector&&!o.includes(e.sector))throw new Ze(`Invalid sector: ${e.sector}`,"sector");return!0}function E0(e,t){const o={};e.forEach(i=>{o[i.id]=[]}),t.forEach(i=>{o[i.source].push(i.target)});const a=new Set,r=new Set;function n(i){a.add(i),r.add(i);for(const c of o[i]||[])if(a.has(c)){if(r.has(c))return!0}else if(n(c))return!0;return r.delete(i),!1}for(const i of Object.keys(o))if(!a.has(i)&&n(i))return!0;return!1}function N0(e){return typeof e!="string"?"":e.replace(/<[^>]*>/g,"").replace(/[\x00-\x1F\x7F]/g,"").slice(0,255).trim()}const xr=2,Un="agentcache_",nn=5*1024*1024;class zn{static save(t,o){try{const a=Un+t,r=JSON.stringify(o);return r.length>nn?{success:!1,error:"quota",message:"Data exceeds 5MB storage limit. Consider deleting old pipelines.",size:r.length}:(localStorage.setItem(a,r),{success:!0,size:r.length})}catch(a){return a.name==="QuotaExceededError"?{success:!1,error:"quota",message:"Storage quota exceeded. Clear old data to continue.",cause:a}:{success:!1,error:"storage",message:`Failed to save data: ${a.message}`,cause:a}}}static load(t,o=null){try{const a=Un+t,r=localStorage.getItem(a);return r===null?o:JSON.parse(r)}catch(a){return console.error(`Failed to load ${t}:`,a),o}}static remove(t){try{const o=Un+t;return localStorage.removeItem(o),!0}catch(o){return console.error(`Failed to remove ${t}:`,o),!1}}static getStorageStats(){try{let t=0,o=0;for(let a=0;a<localStorage.length;a++){const r=localStorage.key(a);if(r.startsWith(Un)){const n=localStorage.getItem(r);t+=n?n.length:0,o++}}return{totalSize:t,itemCount:o,percentUsed:t/nn*100,maxSize:nn,available:nn-t}}catch(t){return console.error("Failed to get storage stats:",t),{totalSize:0,itemCount:0,percentUsed:0,maxSize:nn,available:nn}}}static clearAll(){try{const t=[];for(let o=0;o<localStorage.length;o++){const a=localStorage.key(o);a.startsWith(Un)&&t.push(a)}return t.forEach(o=>localStorage.removeItem(o)),!0}catch(t){return console.error("Failed to clear storage:",t),!1}}}class Pa{static savePipeline(t){try{t.name=N0(t.name),Ma(t);const o={...t,_v:xr,savedAt:new Date().toISOString(),updatedAt:new Date().toISOString()},a=this.loadAllPipelines(),r=a.findIndex(i=>i.name===t.name);r!==-1?a[r]={...o,savedAt:a[r].savedAt}:a.push(o);const n=zn.save("pipelines",a);return n.success?{success:!0,pipeline:o,isNew:r===-1}:n}catch(o){return{success:!1,error:"validation",message:o.message,field:o.field||null}}}static loadAllPipelines(){return zn.load("pipelines",[]).map(o=>this.migratePipeline(o))}static loadPipeline(t){return this.loadAllPipelines().find(a=>a.name===t)||null}static deletePipeline(t){try{const o=this.loadAllPipelines(),a=o.filter(n=>n.name!==t);return a.length===o.length?{success:!1,error:"not_found",message:`Pipeline "${t}" not found`}:zn.save("pipelines",a)}catch(o){return{success:!1,error:"storage",message:o.message}}}static migratePipeline(t){return t._v?(t._v===xr,t):{...t,_v:xr,updatedAt:t.savedAt||new Date().toISOString()}}static getPipelineStats(){const t=this.loadAllPipelines(),o={total:t.length,active:t.filter(a=>a.isActive).length,inactive:t.filter(a=>!a.isActive).length,bySector:{}};return t.forEach(a=>{const r=a.sector||"general";o.bySector[r]=(o.bySector[r]||0)+1}),o}static exportPipelines(t=null){const o=this.loadAllPipelines(),a=t?o.filter(r=>t.includes(r.name)):o;return JSON.stringify({version:xr,exportedAt:new Date().toISOString(),pipelines:a},null,2)}static importPipelines(t){try{const o=JSON.parse(t);if(!o.pipelines||!Array.isArray(o.pipelines))return{success:!1,error:"invalid_format",message:"Invalid import format"};const a=this.loadAllPipelines();let r=0,n=0;for(const c of o.pipelines)try{Ma(c),a.find(s=>s.name===c.name)?n++:(a.push(this.migratePipeline(c)),r++)}catch(s){console.warn(`Skipping invalid pipeline: ${s.message}`),n++}const i=zn.save("pipelines",a);return i.success?{success:!0,imported:r,skipped:n}:i}catch(o){return{success:!1,error:"parse_error",message:`Failed to parse JSON: ${o.message}`}}}}const k0=({id:e,sourceX:t,sourceY:o,targetX:a,targetY:r,sourcePosition:n,targetPosition:i,style:c={},markerEnd:s,data:l})=>{const[u]=si({sourceX:t,sourceY:o,sourcePosition:n,targetX:a,targetY:r,targetPosition:i}),d=l?.packets||[];return h.jsxs(h.Fragment,{children:[h.jsx(hn,{path:u,markerEnd:s,style:c}),d.map(f=>h.jsx("circle",{r:"4",className:`traffic-packet ${f.type}`,children:h.jsx("animateMotion",{dur:`${f.speed}s`,repeatCount:"1",path:u,begin:"0s",fill:"freeze"})},f.id))]})},A0=F.memo(k0),T0=e=>typeof e=="object"&&typeof e.then=="function",_r=[];function M0(e,t,o=(a,r)=>a===r){if(e===t)return!0;if(!e||!t)return!1;const a=e.length;if(t.length!==a)return!1;for(let r=0;r<a;r++)if(!o(e[r],t[r]))return!1;return!0}function P0(e,t=null,o=!1,a={}){t===null&&(t=[e]);for(const n of _r)if(M0(t,n.keys,n.equal)){if(o)return;if(Object.prototype.hasOwnProperty.call(n,"error"))throw n.error;if(Object.prototype.hasOwnProperty.call(n,"response"))return a.lifespan&&a.lifespan>0&&(n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(n.remove,a.lifespan)),n.response;if(!o)throw n.promise}const r={keys:t,equal:a.equal,remove:()=>{const n=_r.indexOf(r);n!==-1&&_r.splice(n,1)},promise:(T0(e)?e:e(...t)).then(n=>{r.response=n,a.lifespan&&a.lifespan>0&&(r.timeout=setTimeout(r.remove,a.lifespan))}).catch(n=>r.error=n)};if(_r.push(r),!o)throw r.promise}const D0=(e,t,o)=>P0(e,t,!1,o);function R0(){var e=Object.create(null);function t(r,n){var i=r.id,c=r.name,s=r.dependencies;s===void 0&&(s=[]);var l=r.init;l===void 0&&(l=function(){});var u=r.getTransferables;if(u===void 0&&(u=null),!e[i])try{s=s.map(function(f){return f&&f.isWorkerModule&&(t(f,function(p){if(p instanceof Error)throw p}),f=e[f.id].value),f}),l=a("<"+c+">.init",l),u&&(u=a("<"+c+">.getTransferables",u));var d=null;typeof l=="function"?d=l.apply(void 0,s):console.error("worker module init function failed to rehydrate"),e[i]={id:i,value:d,getTransferables:u},n(d)}catch(f){f&&f.noLog||console.error(f),n(f)}}function o(r,n){var i,c=r.id,s=r.args;(!e[c]||typeof e[c].value!="function")&&n(new Error("Worker module "+c+": not found or its 'init' did not return a function"));try{var l=(i=e[c]).value.apply(i,s);l&&typeof l.then=="function"?l.then(u,function(d){return n(d instanceof Error?d:new Error(""+d))}):u(l)}catch(d){n(d)}function u(d){try{var f=e[c].getTransferables&&e[c].getTransferables(d);(!f||!Array.isArray(f)||!f.length)&&(f=void 0),n(d,f)}catch(p){console.error(p),n(p)}}}function a(r,n){var i=void 0;self.troikaDefine=function(s){return i=s};var c=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+n+`
)`],{type:"application/javascript"}));try{importScripts(c)}catch(s){console.error(s)}return URL.revokeObjectURL(c),delete self.troikaDefine,i}self.addEventListener("message",function(r){var n=r.data,i=n.messageId,c=n.action,s=n.data;try{c==="registerModule"&&t(s,function(l){l instanceof Error?postMessage({messageId:i,success:!1,error:l.message}):postMessage({messageId:i,success:!0,result:{isCallable:typeof l=="function"}})}),c==="callModule"&&o(s,function(l,u){l instanceof Error?postMessage({messageId:i,success:!1,error:l.message}):postMessage({messageId:i,success:!0,result:l},u||void 0)})}catch(l){postMessage({messageId:i,success:!1,error:l.stack})}})}function I0(e){var t=function(){for(var o=[],a=arguments.length;a--;)o[a]=arguments[a];return t._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,o);throw new Error("Worker module function was called but `init` did not return a callable function")})};return t._getInitResult=function(){var o=e.dependencies,a=e.init;o=Array.isArray(o)?o.map(function(n){return n&&(n=n.onMainThread||n,n._getInitResult&&(n=n._getInitResult())),n}):[];var r=Promise.all(o).then(function(n){return a.apply(null,n)});return t._getInitResult=function(){return r},r},t}var Sc=function(){var e=!1;if(typeof window<"u"&&typeof window.document<"u")try{var t=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));t.terminate(),e=!0}catch(o){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+o.message+"]")}return Sc=function(){return e},e},U0=0,j0=0,wo=!1,Gn=Object.create(null),Hn=Object.create(null),Go=Object.create(null);function pn(e){if((!e||typeof e.init!="function")&&!wo)throw new Error("requires `options.init` function");var t=e.dependencies,o=e.init,a=e.getTransferables,r=e.workerId,n=I0(e);r==null&&(r="#default");var i="workerModule"+ ++U0,c=e.name||i,s=null;t=t&&t.map(function(u){return typeof u=="function"&&!u.workerModuleData&&(wo=!0,u=pn({workerId:r,name:"<"+c+"> function dependency: "+u.name,init:`function(){return (
`+kr(u)+`
)}`}),wo=!1),u&&u.workerModuleData&&(u=u.workerModuleData),u});function l(){for(var u=[],d=arguments.length;d--;)u[d]=arguments[d];if(!Sc())return n.apply(void 0,u);if(!s){s=Da(r,"registerModule",l.workerModuleData);var f=function(){s=null,Hn[r].delete(f)};(Hn[r]||(Hn[r]=new Set)).add(f)}return s.then(function(p){var y=p.isCallable;if(y)return Da(r,"callModule",{id:i,args:u});throw new Error("Worker module function was called but `init` did not return a callable function")})}return l.workerModuleData={isWorkerModule:!0,id:i,name:c,dependencies:t,init:kr(o),getTransferables:a&&kr(a)},l.onMainThread=n,l}function F0(e){Hn[e]&&Hn[e].forEach(function(t){t()}),Gn[e]&&(Gn[e].terminate(),delete Gn[e])}function kr(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function O0(e){var t=Gn[e];if(!t){var o=kr(R0);t=Gn[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+` **/

;(`+o+")()"],{type:"application/javascript"}))),t.onmessage=function(a){var r=a.data,n=r.messageId,i=Go[n];if(!i)throw new Error("WorkerModule response with empty or unknown messageId");delete Go[n],i(r)}}return t}function Da(e,t,o){return new Promise(function(a,r){var n=++j0;Go[n]=function(i){i.success?a(i.result):r(new Error("Error in worker "+t+" call: "+i.error))},O0(e).postMessage({messageId:n,action:t,data:o})})}function Cc(){var e=(function(t){function o(N,R,b,M,O,L,z,$){var V=1-z;$.x=V*V*N+2*V*z*b+z*z*O,$.y=V*V*R+2*V*z*M+z*z*L}function a(N,R,b,M,O,L,z,$,V,Y){var Z=1-V;Y.x=Z*Z*Z*N+3*Z*Z*V*b+3*Z*V*V*O+V*V*V*z,Y.y=Z*Z*Z*R+3*Z*Z*V*M+3*Z*V*V*L+V*V*V*$}function r(N,R){for(var b=/([MLQCZ])([^MLQCZ]*)/g,M,O,L,z,$;M=b.exec(N);){var V=M[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Y){return parseFloat(Y)});switch(M[1]){case"M":z=O=V[0],$=L=V[1];break;case"L":(V[0]!==z||V[1]!==$)&&R("L",z,$,z=V[0],$=V[1]);break;case"Q":{R("Q",z,$,z=V[2],$=V[3],V[0],V[1]);break}case"C":{R("C",z,$,z=V[4],$=V[5],V[0],V[1],V[2],V[3]);break}case"Z":(z!==O||$!==L)&&R("L",z,$,O,L);break}}}function n(N,R,b){b===void 0&&(b=16);var M={x:0,y:0};r(N,function(O,L,z,$,V,Y,Z,Q,J){switch(O){case"L":R(L,z,$,V);break;case"Q":{for(var q=L,ge=z,se=1;se<b;se++)o(L,z,Y,Z,$,V,se/(b-1),M),R(q,ge,M.x,M.y),q=M.x,ge=M.y;break}case"C":{for(var ee=L,oe=z,te=1;te<b;te++)a(L,z,Y,Z,Q,J,$,V,te/(b-1),M),R(ee,oe,M.x,M.y),ee=M.x,oe=M.y;break}}})}var i="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",c="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",s=new WeakMap,l={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(N,R){var b=N.getContext?N.getContext("webgl",l):N,M=s.get(b);if(!M){let Z=function(ee){var oe=L[ee];if(!oe&&(oe=L[ee]=b.getExtension(ee),!oe))throw new Error(ee+" not supported");return oe},Q=function(ee,oe){var te=b.createShader(oe);return b.shaderSource(te,ee),b.compileShader(te),te},J=function(ee,oe,te,W){if(!z[ee]){var re={},ae={},K=b.createProgram();b.attachShader(K,Q(oe,b.VERTEX_SHADER)),b.attachShader(K,Q(te,b.FRAGMENT_SHADER)),b.linkProgram(K),z[ee]={program:K,transaction:function(ie){b.useProgram(K),ie({setUniform:function(ne,Se){for(var le=[],ue=arguments.length-2;ue-- >0;)le[ue]=arguments[ue+2];var fe=ae[Se]||(ae[Se]=b.getUniformLocation(K,Se));b["uniform"+ne].apply(b,[fe].concat(le))},setAttribute:function(ne,Se,le,ue,fe){var ve=re[ne];ve||(ve=re[ne]={buf:b.createBuffer(),loc:b.getAttribLocation(K,ne),data:null}),b.bindBuffer(b.ARRAY_BUFFER,ve.buf),b.vertexAttribPointer(ve.loc,Se,b.FLOAT,!1,0,0),b.enableVertexAttribArray(ve.loc),O?b.vertexAttribDivisor(ve.loc,ue):Z("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ve.loc,ue),fe!==ve.data&&(b.bufferData(b.ARRAY_BUFFER,fe,le),ve.data=fe)}})}}}z[ee].transaction(W)},q=function(ee,oe){V++;try{b.activeTexture(b.TEXTURE0+V);var te=$[ee];te||(te=$[ee]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,te),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST)),b.bindTexture(b.TEXTURE_2D,te),oe(te,V)}finally{V--}},ge=function(ee,oe,te){var W=b.createFramebuffer();Y.push(W),b.bindFramebuffer(b.FRAMEBUFFER,W),b.activeTexture(b.TEXTURE0+oe),b.bindTexture(b.TEXTURE_2D,ee),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,ee,0);try{te(W)}finally{b.deleteFramebuffer(W),b.bindFramebuffer(b.FRAMEBUFFER,Y[--Y.length-1]||null)}},se=function(){L={},z={},$={},V=-1,Y.length=0};var O=typeof WebGL2RenderingContext<"u"&&b instanceof WebGL2RenderingContext,L={},z={},$={},V=-1,Y=[];b.canvas.addEventListener("webglcontextlost",function(ee){se(),ee.preventDefault()},!1),s.set(b,M={gl:b,isWebGL2:O,getExtension:Z,withProgram:J,withTexture:q,withTextureFramebuffer:ge,handleContextLoss:se})}R(M)}function d(N,R,b,M,O,L,z,$){z===void 0&&(z=15),$===void 0&&($=null),u(N,function(V){var Y=V.gl,Z=V.withProgram,Q=V.withTexture;Q("copy",function(J,q){Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,O,L,0,Y.RGBA,Y.UNSIGNED_BYTE,R),Z("copy",i,c,function(ge){var se=ge.setUniform,ee=ge.setAttribute;ee("aUV",2,Y.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),se("1i","image",q),Y.bindFramebuffer(Y.FRAMEBUFFER,$||null),Y.disable(Y.BLEND),Y.colorMask(z&8,z&4,z&2,z&1),Y.viewport(b,M,O,L),Y.scissor(b,M,O,L),Y.drawArrays(Y.TRIANGLES,0,3)})})})}function f(N,R,b){var M=N.width,O=N.height;u(N,function(L){var z=L.gl,$=new Uint8Array(M*O*4);z.readPixels(0,0,M,O,z.RGBA,z.UNSIGNED_BYTE,$),N.width=R,N.height=b,d(z,$,0,0,M,O)})}var p=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:d,resizeWebGLCanvasWithoutClearing:f});function y(N,R,b,M,O,L){L===void 0&&(L=1);var z=new Uint8Array(N*R),$=M[2]-M[0],V=M[3]-M[1],Y=[];n(b,function(ee,oe,te,W){Y.push({x1:ee,y1:oe,x2:te,y2:W,minX:Math.min(ee,te),minY:Math.min(oe,W),maxX:Math.max(ee,te),maxY:Math.max(oe,W)})}),Y.sort(function(ee,oe){return ee.maxX-oe.maxX});for(var Z=0;Z<N;Z++)for(var Q=0;Q<R;Q++){var J=ge(M[0]+$*(Z+.5)/N,M[1]+V*(Q+.5)/R),q=Math.pow(1-Math.abs(J)/O,L)/2;J<0&&(q=1-q),q=Math.max(0,Math.min(255,Math.round(q*255))),z[Q*N+Z]=q}return z;function ge(ee,oe){for(var te=1/0,W=1/0,re=Y.length;re--;){var ae=Y[re];if(ae.maxX+W<=ee)break;if(ee+W>ae.minX&&oe-W<ae.maxY&&oe+W>ae.minY){var K=_(ee,oe,ae.x1,ae.y1,ae.x2,ae.y2);K<te&&(te=K,W=Math.sqrt(te))}}return se(ee,oe)&&(W=-W),W}function se(ee,oe){for(var te=0,W=Y.length;W--;){var re=Y[W];if(re.maxX<=ee)break;var ae=re.y1>oe!=re.y2>oe&&ee<(re.x2-re.x1)*(oe-re.y1)/(re.y2-re.y1)+re.x1;ae&&(te+=re.y1<re.y2?1:-1)}return te!==0}}function m(N,R,b,M,O,L,z,$,V,Y){L===void 0&&(L=1),$===void 0&&($=0),V===void 0&&(V=0),Y===void 0&&(Y=0),v(N,R,b,M,O,L,z,null,$,V,Y)}function v(N,R,b,M,O,L,z,$,V,Y,Z){L===void 0&&(L=1),V===void 0&&(V=0),Y===void 0&&(Y=0),Z===void 0&&(Z=0);for(var Q=y(N,R,b,M,O,L),J=new Uint8Array(Q.length*4),q=0;q<Q.length;q++)J[q*4+Z]=Q[q];d(z,J,V,Y,N,R,1<<3-Z,$)}function _(N,R,b,M,O,L){var z=O-b,$=L-M,V=z*z+$*$,Y=V?Math.max(0,Math.min(1,((N-b)*z+(R-M)*$)/V)):0,Z=N-(b+Y*z),Q=R-(M+Y*$);return Z*Z+Q*Q}var w=Object.freeze({__proto__:null,generate:y,generateIntoCanvas:m,generateIntoFramebuffer:v}),C="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",x="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",A="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",D=new Float32Array([0,0,2,0,0,2]),S=null,P=!1,I={},j=new WeakMap;function H(N){if(!P&&!k(N))throw new Error("WebGL generation not supported")}function T(N,R,b,M,O,L,z){if(L===void 0&&(L=1),z===void 0&&(z=null),!z&&(z=S,!z)){var $=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!$)throw new Error("OffscreenCanvas or DOM canvas not supported");z=S=$.getContext("webgl",{depth:!1})}H(z);var V=new Uint8Array(N*R*4);u(z,function(J){var q=J.gl,ge=J.withTexture,se=J.withTextureFramebuffer;ge("readable",function(ee,oe){q.texImage2D(q.TEXTURE_2D,0,q.RGBA,N,R,0,q.RGBA,q.UNSIGNED_BYTE,null),se(ee,oe,function(te){g(N,R,b,M,O,L,q,te,0,0,0),q.readPixels(0,0,N,R,q.RGBA,q.UNSIGNED_BYTE,V)})})});for(var Y=new Uint8Array(N*R),Z=0,Q=0;Z<V.length;Z+=4)Y[Q++]=V[Z];return Y}function U(N,R,b,M,O,L,z,$,V,Y){L===void 0&&(L=1),$===void 0&&($=0),V===void 0&&(V=0),Y===void 0&&(Y=0),g(N,R,b,M,O,L,z,null,$,V,Y)}function g(N,R,b,M,O,L,z,$,V,Y,Z){L===void 0&&(L=1),V===void 0&&(V=0),Y===void 0&&(Y=0),Z===void 0&&(Z=0),H(z);var Q=[];n(b,function(J,q,ge,se){Q.push(J,q,ge,se)}),Q=new Float32Array(Q),u(z,function(J){var q=J.gl,ge=J.isWebGL2,se=J.getExtension,ee=J.withProgram,oe=J.withTexture,te=J.withTextureFramebuffer,W=J.handleContextLoss;if(oe("rawDistances",function(re,ae){(N!==re._lastWidth||R!==re._lastHeight)&&q.texImage2D(q.TEXTURE_2D,0,q.RGBA,re._lastWidth=N,re._lastHeight=R,0,q.RGBA,q.UNSIGNED_BYTE,null),ee("main",C,x,function(K){var ye=K.setAttribute,ie=K.setUniform,ce=!ge&&se("ANGLE_instanced_arrays"),ne=!ge&&se("EXT_blend_minmax");ye("aUV",2,q.STATIC_DRAW,0,D),ye("aLineSegment",4,q.DYNAMIC_DRAW,1,Q),ie.apply(void 0,["4f","uGlyphBounds"].concat(M)),ie("1f","uMaxDistance",O),ie("1f","uExponent",L),te(re,ae,function(Se){q.enable(q.BLEND),q.colorMask(!0,!0,!0,!0),q.viewport(0,0,N,R),q.scissor(0,0,N,R),q.blendFunc(q.ONE,q.ONE),q.blendEquationSeparate(q.FUNC_ADD,ge?q.MAX:ne.MAX_EXT),q.clear(q.COLOR_BUFFER_BIT),ge?q.drawArraysInstanced(q.TRIANGLES,0,3,Q.length/4):ce.drawArraysInstancedANGLE(q.TRIANGLES,0,3,Q.length/4)})}),ee("post",i,A,function(K){K.setAttribute("aUV",2,q.STATIC_DRAW,0,D),K.setUniform("1i","tex",ae),q.bindFramebuffer(q.FRAMEBUFFER,$),q.disable(q.BLEND),q.colorMask(Z===0,Z===1,Z===2,Z===3),q.viewport(V,Y,N,R),q.scissor(V,Y,N,R),q.drawArrays(q.TRIANGLES,0,3)})}),q.isContextLost())throw W(),new Error("webgl context lost")})}function k(N){var R=!N||N===S?I:N.canvas||N,b=j.get(R);if(b===void 0){P=!0;var M=null;try{var O=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],L=T(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,N);b=L&&O.length===L.length&&L.every(function(z,$){return z===O[$]}),b||(M="bad trial run results",console.info(O,L))}catch(z){b=!1,M=z.message}M&&console.warn("WebGL SDF generation not supported:",M),P=!1,j.set(R,b)}return b}var E=Object.freeze({__proto__:null,generate:T,generateIntoCanvas:U,generateIntoFramebuffer:g,isSupported:k});function B(N,R,b,M,O,L){O===void 0&&(O=Math.max(M[2]-M[0],M[3]-M[1])/2),L===void 0&&(L=1);try{return T.apply(E,arguments)}catch(z){return console.info("WebGL SDF generation failed, falling back to JS",z),y.apply(w,arguments)}}function G(N,R,b,M,O,L,z,$,V,Y){O===void 0&&(O=Math.max(M[2]-M[0],M[3]-M[1])/2),L===void 0&&(L=1),$===void 0&&($=0),V===void 0&&(V=0),Y===void 0&&(Y=0);try{return U.apply(E,arguments)}catch(Z){return console.info("WebGL SDF generation failed, falling back to JS",Z),m.apply(w,arguments)}}return t.forEachPathCommand=r,t.generate=B,t.generateIntoCanvas=G,t.javascript=w,t.pathToLineSegments=n,t.webgl=E,t.webglUtils=p,Object.defineProperty(t,"__esModule",{value:!0}),t})({});return e}function L0(){var e=(function(t){var o={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},a={},r={};a.L=1,r[1]="L",Object.keys(o).forEach(function(W,re){a[W]=1<<re+1,r[a[W]]=W}),Object.freeze(a);var n=a.LRI|a.RLI|a.FSI,i=a.L|a.R|a.AL,c=a.B|a.S|a.WS|a.ON|a.FSI|a.LRI|a.RLI|a.PDI,s=a.BN|a.RLE|a.LRE|a.RLO|a.LRO|a.PDF,l=a.S|a.WS|a.B|n|a.PDI|s,u=null;function d(){if(!u){u=new Map;var W=function(ae){if(o.hasOwnProperty(ae)){var K=0;o[ae].split(",").forEach(function(ye){var ie=ye.split("+"),ce=ie[0],ne=ie[1];ce=parseInt(ce,36),ne=ne?parseInt(ne,36):0,u.set(K+=ce,a[ae]);for(var Se=0;Se<ne;Se++)u.set(++K,a[ae])})}};for(var re in o)W(re)}}function f(W){return d(),u.get(W.codePointAt(0))||a.L}function p(W){return r[f(W)]}var y={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(W,re){var ae=36,K=0,ye=new Map,ie=re&&new Map,ce;return W.split(",").forEach(function ne(Se){if(Se.indexOf("+")!==-1)for(var le=+Se;le--;)ne(ce);else{ce=Se;var ue=Se.split(">"),fe=ue[0],ve=ue[1];fe=String.fromCodePoint(K+=parseInt(fe,ae)),ve=String.fromCodePoint(K+=parseInt(ve,ae)),ye.set(fe,ve),re&&ie.set(ve,fe)}}),{map:ye,reverseMap:ie}}var v,_,w;function C(){if(!v){var W=m(y.pairs,!0),re=W.map,ae=W.reverseMap;v=re,_=ae,w=m(y.canonical,!1).map}}function x(W){return C(),v.get(W)||null}function A(W){return C(),_.get(W)||null}function D(W){return C(),w.get(W)||null}var S=a.L,P=a.R,I=a.EN,j=a.ES,H=a.ET,T=a.AN,U=a.CS,g=a.B,k=a.S,E=a.ON,B=a.BN,G=a.NSM,N=a.AL,R=a.LRO,b=a.RLO,M=a.LRE,O=a.RLE,L=a.PDF,z=a.LRI,$=a.RLI,V=a.FSI,Y=a.PDI;function Z(W,re){for(var ae=125,K=new Uint32Array(W.length),ye=0;ye<W.length;ye++)K[ye]=f(W[ye]);var ie=new Map;function ce($e,it){var Xe=K[$e];K[$e]=it,ie.set(Xe,ie.get(Xe)-1),Xe&c&&ie.set(c,ie.get(c)-1),ie.set(it,(ie.get(it)||0)+1),it&c&&ie.set(c,(ie.get(c)||0)+1)}for(var ne=new Uint8Array(W.length),Se=new Map,le=[],ue=null,fe=0;fe<W.length;fe++)ue||le.push(ue={start:fe,end:W.length-1,level:re==="rtl"?1:re==="ltr"?0:Mi(fe,!1)}),K[fe]&g&&(ue.end=fe,ue=null);for(var ve=O|M|b|R|n|Y|L|g,be=function($e){return $e+($e&1?1:2)},ke=function($e){return $e+($e&1?2:1)},xe=0;xe<le.length;xe++){ue=le[xe];var _e=[{_level:ue.level,_override:0,_isolate:0}],de=void 0,Ae=0,Me=0,Le=0;ie.clear();for(var Pe=ue.start;Pe<=ue.end;Pe++){var me=K[Pe];if(de=_e[_e.length-1],ie.set(me,(ie.get(me)||0)+1),me&c&&ie.set(c,(ie.get(c)||0)+1),me&ve)if(me&(O|M)){ne[Pe]=de._level;var Te=(me===O?ke:be)(de._level);Te<=ae&&!Ae&&!Me?_e.push({_level:Te,_override:0,_isolate:0}):Ae||Me++}else if(me&(b|R)){ne[Pe]=de._level;var tt=(me===b?ke:be)(de._level);tt<=ae&&!Ae&&!Me?_e.push({_level:tt,_override:me&b?P:S,_isolate:0}):Ae||Me++}else if(me&n){me&V&&(me=Mi(Pe+1,!0)===1?$:z),ne[Pe]=de._level,de._override&&ce(Pe,de._override);var Ne=(me===$?ke:be)(de._level);Ne<=ae&&Ae===0&&Me===0?(Le++,_e.push({_level:Ne,_override:0,_isolate:1,_isolInitIndex:Pe})):Ae++}else if(me&Y){if(Ae>0)Ae--;else if(Le>0){for(Me=0;!_e[_e.length-1]._isolate;)_e.pop();var Ce=_e[_e.length-1]._isolInitIndex;Ce!=null&&(Se.set(Ce,Pe),Se.set(Pe,Ce)),_e.pop(),Le--}de=_e[_e.length-1],ne[Pe]=de._level,de._override&&ce(Pe,de._override)}else me&L?(Ae===0&&(Me>0?Me--:!de._isolate&&_e.length>1&&(_e.pop(),de=_e[_e.length-1])),ne[Pe]=de._level):me&g&&(ne[Pe]=ue.level);else ne[Pe]=de._level,de._override&&me!==B&&ce(Pe,de._override)}for(var Ue=[],De=null,we=ue.start;we<=ue.end;we++){var Re=K[we];if(!(Re&s)){var Ge=ne[we],ze=Re&n,Fe=Re===Y;De&&Ge===De._level?(De._end=we,De._endsWithIsolInit=ze):Ue.push(De={_start:we,_end:we,_level:Ge,_startsWithPDI:Fe,_endsWithIsolInit:ze})}}for(var qe=[],ut=0;ut<Ue.length;ut++){var nt=Ue[ut];if(!nt._startsWithPDI||nt._startsWithPDI&&!Se.has(nt._start)){for(var dt=[De=nt],gt=void 0;De&&De._endsWithIsolInit&&(gt=Se.get(De._end))!=null;)for(var rt=ut+1;rt<Ue.length;rt++)if(Ue[rt]._start===gt){dt.push(De=Ue[rt]);break}for(var He=[],mt=0;mt<dt.length;mt++)for(var gn=dt[mt],mn=gn._start;mn<=gn._end;mn++)He.push(mn);for(var Xr=ne[He[0]],er=ue.level,Gt=He[0]-1;Gt>=0;Gt--)if(!(K[Gt]&s)){er=ne[Gt];break}var yn=He[He.length-1],Yr=ne[yn],tr=ue.level;if(!(K[yn]&n)){for(var Ht=yn+1;Ht<=ue.end;Ht++)if(!(K[Ht]&s)){tr=ne[Ht];break}}qe.push({_seqIndices:He,_sosType:Math.max(er,Xr)%2?P:S,_eosType:Math.max(tr,Yr)%2?P:S})}}for(var Vt=0;Vt<qe.length;Vt++){var vn=qe[Vt],he=vn._seqIndices,Pt=vn._sosType,qr=vn._eosType,St=ne[he[0]]&1?P:S;if(ie.get(G))for(var Wt=0;Wt<he.length;Wt++){var xn=he[Wt];if(K[xn]&G){for(var _n=Pt,$t=Wt-1;$t>=0;$t--)if(!(K[he[$t]]&s)){_n=K[he[$t]];break}ce(xn,_n&(n|Y)?E:_n)}}if(ie.get(I))for(var Xt=0;Xt<he.length;Xt++){var Yt=he[Xt];if(K[Yt]&I)for(var nr=Xt-1;nr>=-1;nr--){var gi=nr===-1?Pt:K[he[nr]];if(gi&i){gi===N&&ce(Yt,T);break}}}if(ie.get(N))for(var Kr=0;Kr<he.length;Kr++){var mi=he[Kr];K[mi]&N&&ce(mi,P)}if(ie.get(j)||ie.get(U))for(var bn=1;bn<he.length-1;bn++){var Zr=he[bn];if(K[Zr]&(j|U)){for(var qt=0,Jr=0,Qr=bn-1;Qr>=0&&(qt=K[he[Qr]],!!(qt&s));Qr--);for(var eo=bn+1;eo<he.length&&(Jr=K[he[eo]],!!(Jr&s));eo++);qt===Jr&&(K[Zr]===j?qt===I:qt&(I|T))&&ce(Zr,qt)}}if(ie.get(I))for(var ft=0;ft<he.length;ft++){var Uc=he[ft];if(K[Uc]&I){for(var rr=ft-1;rr>=0&&K[he[rr]]&(H|s);rr--)ce(he[rr],I);for(ft++;ft<he.length&&K[he[ft]]&(H|s|I);ft++)K[he[ft]]!==I&&ce(he[ft],I)}}if(ie.get(H)||ie.get(j)||ie.get(U))for(var wn=0;wn<he.length;wn++){var yi=he[wn];if(K[yi]&(H|j|U)){ce(yi,E);for(var or=wn-1;or>=0&&K[he[or]]&s;or--)ce(he[or],E);for(var ir=wn+1;ir<he.length&&K[he[ir]]&s;ir++)ce(he[ir],E)}}if(ie.get(I))for(var to=0,vi=Pt;to<he.length;to++){var xi=he[to],no=K[xi];no&I?vi===S&&ce(xi,S):no&i&&(vi=no)}if(ie.get(c)){var Sn=P|I|T,_i=Sn|S,ar=[];{for(var Kt=[],Zt=0;Zt<he.length;Zt++)if(K[he[Zt]]&c){var Cn=W[he[Zt]],bi=void 0;if(x(Cn)!==null)if(Kt.length<63)Kt.push({char:Cn,seqIndex:Zt});else break;else if((bi=A(Cn))!==null)for(var En=Kt.length-1;En>=0;En--){var ro=Kt[En].char;if(ro===bi||ro===A(D(Cn))||x(D(ro))===Cn){ar.push([Kt[En].seqIndex,Zt]),Kt.length=En;break}}}ar.sort(function($e,it){return $e[0]-it[0]})}for(var oo=0;oo<ar.length;oo++){for(var wi=ar[oo],sr=wi[0],io=wi[1],Si=!1,ot=0,ao=sr+1;ao<io;ao++){var Ci=he[ao];if(K[Ci]&_i){Si=!0;var Ei=K[Ci]&Sn?P:S;if(Ei===St){ot=Ei;break}}}if(Si&&!ot){ot=Pt;for(var so=sr-1;so>=0;so--){var Ni=he[so];if(K[Ni]&_i){var ki=K[Ni]&Sn?P:S;ki!==St?ot=ki:ot=St;break}}}if(ot){if(K[he[sr]]=K[he[io]]=ot,ot!==St){for(var Nn=sr+1;Nn<he.length;Nn++)if(!(K[he[Nn]]&s)){f(W[he[Nn]])&G&&(K[he[Nn]]=ot);break}}if(ot!==St){for(var kn=io+1;kn<he.length;kn++)if(!(K[he[kn]]&s)){f(W[he[kn]])&G&&(K[he[kn]]=ot);break}}}}for(var Ct=0;Ct<he.length;Ct++)if(K[he[Ct]]&c){for(var Ai=Ct,co=Ct,lo=Pt,An=Ct-1;An>=0;An--)if(K[he[An]]&s)Ai=An;else{lo=K[he[An]]&Sn?P:S;break}for(var Ti=qr,Tn=Ct+1;Tn<he.length;Tn++)if(K[he[Tn]]&(c|s))co=Tn;else{Ti=K[he[Tn]]&Sn?P:S;break}for(var uo=Ai;uo<=co;uo++)K[he[uo]]=lo===Ti?lo:St;Ct=co}}}for(var Ke=ue.start;Ke<=ue.end;Ke++){var jc=ne[Ke],cr=K[Ke];if(jc&1?cr&(S|I|T)&&ne[Ke]++:cr&P?ne[Ke]++:cr&(T|I)&&(ne[Ke]+=2),cr&s&&(ne[Ke]=Ke===0?ue.level:ne[Ke-1]),Ke===ue.end||f(W[Ke])&(k|g))for(var lr=Ke;lr>=0&&f(W[lr])&l;lr--)ne[lr]=ue.level}}return{levels:ne,paragraphs:le};function Mi($e,it){for(var Xe=$e;Xe<W.length;Xe++){var Et=K[Xe];if(Et&(P|N))return 1;if(Et&(g|S)||it&&Et===Y)return 0;if(Et&n){var Pi=Fc(Xe);Xe=Pi===-1?W.length:Pi}}return 0}function Fc($e){for(var it=1,Xe=$e+1;Xe<W.length;Xe++){var Et=K[Xe];if(Et&g)break;if(Et&Y){if(--it===0)return Xe}else Et&n&&it++}return-1}}var Q="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",J;function q(){if(!J){var W=m(Q,!0),re=W.map,ae=W.reverseMap;ae.forEach(function(K,ye){re.set(ye,K)}),J=re}}function ge(W){return q(),J.get(W)||null}function se(W,re,ae,K){var ye=W.length;ae=Math.max(0,ae==null?0:+ae),K=Math.min(ye-1,K==null?ye-1:+K);for(var ie=new Map,ce=ae;ce<=K;ce++)if(re[ce]&1){var ne=ge(W[ce]);ne!==null&&ie.set(ce,ne)}return ie}function ee(W,re,ae,K){var ye=W.length;ae=Math.max(0,ae==null?0:+ae),K=Math.min(ye-1,K==null?ye-1:+K);var ie=[];return re.paragraphs.forEach(function(ce){var ne=Math.max(ae,ce.start),Se=Math.min(K,ce.end);if(ne<Se){for(var le=re.levels.slice(ne,Se+1),ue=Se;ue>=ne&&f(W[ue])&l;ue--)le[ue]=ce.level;for(var fe=ce.level,ve=1/0,be=0;be<le.length;be++){var ke=le[be];ke>fe&&(fe=ke),ke<ve&&(ve=ke|1)}for(var xe=fe;xe>=ve;xe--)for(var _e=0;_e<le.length;_e++)if(le[_e]>=xe){for(var de=_e;_e+1<le.length&&le[_e+1]>=xe;)_e++;_e>de&&ie.push([de+ne,_e+ne])}}}),ie}function oe(W,re,ae,K){var ye=te(W,re,ae,K),ie=[].concat(W);return ye.forEach(function(ce,ne){ie[ne]=(re.levels[ce]&1?ge(W[ce]):null)||W[ce]}),ie.join("")}function te(W,re,ae,K){for(var ye=ee(W,re,ae,K),ie=[],ce=0;ce<W.length;ce++)ie[ce]=ce;return ye.forEach(function(ne){for(var Se=ne[0],le=ne[1],ue=ie.slice(Se,le+1),fe=ue.length;fe--;)ie[le-fe]=ue[fe]}),ie}return t.closingToOpeningBracket=A,t.getBidiCharType=f,t.getBidiCharTypeName=p,t.getCanonicalBracket=D,t.getEmbeddingLevels=Z,t.getMirroredCharacter=ge,t.getMirroredCharactersMap=se,t.getReorderSegments=ee,t.getReorderedIndices=te,t.getReorderedString=oe,t.openingToClosingBracket=x,Object.defineProperty(t,"__esModule",{value:!0}),t})({});return e}const Ec=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Ho(e){const t=/^[ \t]*#include +<([\w\d./]+)>/gm;function o(a,r){let n=Vc[r];return n?Ho(n):a}return e.replace(t,o)}const Ve=[];for(let e=0;e<256;e++)Ve[e]=(e<16?"0":"")+e.toString(16);function z0(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,o=Math.random()*4294967295|0,a=Math.random()*4294967295|0;return(Ve[e&255]+Ve[e>>8&255]+Ve[e>>16&255]+Ve[e>>24&255]+"-"+Ve[t&255]+Ve[t>>8&255]+"-"+Ve[t>>16&15|64]+Ve[t>>24&255]+"-"+Ve[o&63|128]+Ve[o>>8&255]+"-"+Ve[o>>16&255]+Ve[o>>24&255]+Ve[a&255]+Ve[a>>8&255]+Ve[a>>16&255]+Ve[a>>24&255]).toUpperCase()}const Dt=Object.assign||function(){let e=arguments[0];for(let t=1,o=arguments.length;t<o;t++){let a=arguments[t];if(a)for(let r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},B0=Date.now(),Ra=new WeakMap,Ia=new Map;let G0=1e10;function Vo(e,t){const o=$0(t);let a=Ra.get(e);if(a||Ra.set(e,a=Object.create(null)),a[o])return new a[o];const r=`_onBeforeCompile${o}`,n=function(l,u){e.onBeforeCompile.call(this,l,u);const d=this.customProgramCacheKey()+"|"+l.vertexShader+"|"+l.fragmentShader;let f=Ia[d];if(!f){const p=H0(this,l,t,o);f=Ia[d]=p}l.vertexShader=f.vertexShader,l.fragmentShader=f.fragmentShader,Dt(l.uniforms,this.uniforms),t.timeUniform&&(l.uniforms[t.timeUniform]={get value(){return Date.now()-B0}}),this[r]&&this[r](l)},i=function(){return c(t.chained?e:e.clone())},c=function(l){const u=Object.create(l,s);return Object.defineProperty(u,"baseMaterial",{value:e}),Object.defineProperty(u,"id",{value:G0++}),u.uuid=z0(),u.uniforms=Dt({},l.uniforms,t.uniforms),u.defines=Dt({},l.defines,t.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${o}`]="",u.extensions=Dt({},l.extensions,t.extensions),u._listeners=void 0,u},s={constructor:{value:i},isDerivedMaterial:{value:!0},type:{get:()=>e.type,set:l=>{e.type=l}},isDerivedFrom:{writable:!0,configurable:!0,value:function(l){const u=this.baseMaterial;return l===u||u.isDerivedMaterial&&u.isDerivedFrom(l)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return e.customProgramCacheKey()+"|"+o}},onBeforeCompile:{get(){return n},set(l){this[r]=l}},copy:{writable:!0,configurable:!0,value:function(l){return e.copy.call(this,l),!e.isShaderMaterial&&!e.isDerivedMaterial&&(Dt(this.extensions,l.extensions),Dt(this.defines,l.defines),Dt(this.uniforms,Hc.clone(l.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const l=new e.constructor;return c(l).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let l=this._depthMaterial;return l||(l=this._depthMaterial=Vo(e.isDerivedMaterial?e.getDepthMaterial():new Bc({depthPacking:Gc}),t),l.defines.IS_DEPTH_MATERIAL="",l.uniforms=this.uniforms),l}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let l=this._distanceMaterial;return l||(l=this._distanceMaterial=Vo(e.isDerivedMaterial?e.getDistanceMaterial():new zc,t),l.defines.IS_DISTANCE_MATERIAL="",l.uniforms=this.uniforms),l}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:l,_distanceMaterial:u}=this;l&&l.dispose(),u&&u.dispose(),e.dispose.call(this)}}};return a[o]=i,new i}function H0(e,{vertexShader:t,fragmentShader:o},a,r){let{vertexDefs:n,vertexMainIntro:i,vertexMainOutro:c,vertexTransform:s,fragmentDefs:l,fragmentMainIntro:u,fragmentMainOutro:d,fragmentColorTransform:f,customRewriter:p,timeUniform:y}=a;if(n=n||"",i=i||"",c=c||"",l=l||"",u=u||"",d=d||"",(s||p)&&(t=Ho(t)),(f||p)&&(o=o.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),o=Ho(o)),p){let m=p({vertexShader:t,fragmentShader:o});t=m.vertexShader,o=m.fragmentShader}if(f){let m=[];o=o.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,v=>(m.push(v),"")),d=`${f}
${m.join(`
`)}
${d}`}if(y){const m=`
uniform float ${y};
`;n=m+n,l=m+l}return s&&(t=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${t}
`,n=`${n}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${s}
}
`,i=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${i}
`,t=t.replace(/\b(position|normal|uv)\b/g,(m,v,_,w)=>/\battribute\s+vec[23]\s+$/.test(w.substr(0,_))?v:`troika_${v}_${r}`),e.map&&e.map.channel>0||(t=t.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),t=Ua(t,r,n,i,c),o=Ua(o,r,l,u,d),{vertexShader:t,fragmentShader:o}}function Ua(e,t,o,a,r){return(a||r||o)&&(e=e.replace(Ec,`
${o}
void troikaOrigMain${t}() {`),e+=`
void main() {
  ${a}
  troikaOrigMain${t}();
  ${r}
}`),e}function V0(e,t){return e==="uniforms"?void 0:typeof t=="function"?t.toString():t}let W0=0;const ja=new Map;function $0(e){const t=JSON.stringify(e,V0);let o=ja.get(t);return o==null&&ja.set(t,o=++W0),o}function X0(){return typeof window>"u"&&(self.window=self),(function(e){var t={parse:function(r){var n=t._bin,i=new Uint8Array(r);if(n.readASCII(i,0,4)=="ttcf"){var c=4;n.readUshort(i,c),c+=2,n.readUshort(i,c),c+=2;var s=n.readUint(i,c);c+=4;for(var l=[],u=0;u<s;u++){var d=n.readUint(i,c);c+=4,l.push(t._readFont(i,d))}return l}return[t._readFont(i,0)]},_readFont:function(r,n){var i=t._bin,c=n;i.readFixed(r,n),n+=4;var s=i.readUshort(r,n);n+=2,i.readUshort(r,n),n+=2,i.readUshort(r,n),n+=2,i.readUshort(r,n),n+=2;for(var l=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:r,_offset:c},d={},f=0;f<s;f++){var p=i.readASCII(r,n,4);n+=4,i.readUint(r,n),n+=4;var y=i.readUint(r,n);n+=4;var m=i.readUint(r,n);n+=4,d[p]={offset:y,length:m}}for(f=0;f<l.length;f++){var v=l[f];d[v]&&(u[v.trim()]=t[v.trim()].parse(r,d[v].offset,d[v].length,u))}return u},_tabOffset:function(r,n,i){for(var c=t._bin,s=c.readUshort(r,i+4),l=i+12,u=0;u<s;u++){var d=c.readASCII(r,l,4);l+=4,c.readUint(r,l),l+=4;var f=c.readUint(r,l);if(l+=4,c.readUint(r,l),l+=4,d==n)return f}return 0}};t._bin={readFixed:function(r,n){return(r[n]<<8|r[n+1])+(r[n+2]<<8|r[n+3])/65540},readF2dot14:function(r,n){return t._bin.readShort(r,n)/16384},readInt:function(r,n){return t._bin._view(r).getInt32(n)},readInt8:function(r,n){return t._bin._view(r).getInt8(n)},readShort:function(r,n){return t._bin._view(r).getInt16(n)},readUshort:function(r,n){return t._bin._view(r).getUint16(n)},readUshorts:function(r,n,i){for(var c=[],s=0;s<i;s++)c.push(t._bin.readUshort(r,n+2*s));return c},readUint:function(r,n){return t._bin._view(r).getUint32(n)},readUint64:function(r,n){return 4294967296*t._bin.readUint(r,n)+t._bin.readUint(r,n+4)},readASCII:function(r,n,i){for(var c="",s=0;s<i;s++)c+=String.fromCharCode(r[n+s]);return c},readUnicode:function(r,n,i){for(var c="",s=0;s<i;s++){var l=r[n++]<<8|r[n++];c+=String.fromCharCode(l)}return c},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,n,i){var c=t._bin._tdec;return c&&n==0&&i==r.length?c.decode(r):t._bin.readASCII(r,n,i)},readBytes:function(r,n,i){for(var c=[],s=0;s<i;s++)c.push(r[n+s]);return c},readASCIIArray:function(r,n,i){for(var c=[],s=0;s<i;s++)c.push(String.fromCharCode(r[n+s]));return c},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},t._lctf={},t._lctf.parse=function(r,n,i,c,s){var l=t._bin,u={},d=n;l.readFixed(r,n),n+=4;var f=l.readUshort(r,n);n+=2;var p=l.readUshort(r,n);n+=2;var y=l.readUshort(r,n);return n+=2,u.scriptList=t._lctf.readScriptList(r,d+f),u.featureList=t._lctf.readFeatureList(r,d+p),u.lookupList=t._lctf.readLookupList(r,d+y,s),u},t._lctf.readLookupList=function(r,n,i){var c=t._bin,s=n,l=[],u=c.readUshort(r,n);n+=2;for(var d=0;d<u;d++){var f=c.readUshort(r,n);n+=2;var p=t._lctf.readLookupTable(r,s+f,i);l.push(p)}return l},t._lctf.readLookupTable=function(r,n,i){var c=t._bin,s=n,l={tabs:[]};l.ltype=c.readUshort(r,n),n+=2,l.flag=c.readUshort(r,n),n+=2;var u=c.readUshort(r,n);n+=2;for(var d=l.ltype,f=0;f<u;f++){var p=c.readUshort(r,n);n+=2;var y=i(r,d,s+p,l);l.tabs.push(y)}return l},t._lctf.numOfOnes=function(r){for(var n=0,i=0;i<32;i++)(r>>>i&1)!=0&&n++;return n},t._lctf.readClassDef=function(r,n){var i=t._bin,c=[],s=i.readUshort(r,n);if(n+=2,s==1){var l=i.readUshort(r,n);n+=2;var u=i.readUshort(r,n);n+=2;for(var d=0;d<u;d++)c.push(l+d),c.push(l+d),c.push(i.readUshort(r,n)),n+=2}if(s==2){var f=i.readUshort(r,n);for(n+=2,d=0;d<f;d++)c.push(i.readUshort(r,n)),n+=2,c.push(i.readUshort(r,n)),n+=2,c.push(i.readUshort(r,n)),n+=2}return c},t._lctf.getInterval=function(r,n){for(var i=0;i<r.length;i+=3){var c=r[i],s=r[i+1];if(r[i+2],c<=n&&n<=s)return i}return-1},t._lctf.readCoverage=function(r,n){var i=t._bin,c={};c.fmt=i.readUshort(r,n),n+=2;var s=i.readUshort(r,n);return n+=2,c.fmt==1&&(c.tab=i.readUshorts(r,n,s)),c.fmt==2&&(c.tab=i.readUshorts(r,n,3*s)),c},t._lctf.coverageIndex=function(r,n){var i=r.tab;if(r.fmt==1)return i.indexOf(n);if(r.fmt==2){var c=t._lctf.getInterval(i,n);if(c!=-1)return i[c+2]+(n-i[c])}return-1},t._lctf.readFeatureList=function(r,n){var i=t._bin,c=n,s=[],l=i.readUshort(r,n);n+=2;for(var u=0;u<l;u++){var d=i.readASCII(r,n,4);n+=4;var f=i.readUshort(r,n);n+=2;var p=t._lctf.readFeatureTable(r,c+f);p.tag=d.trim(),s.push(p)}return s},t._lctf.readFeatureTable=function(r,n){var i=t._bin,c=n,s={},l=i.readUshort(r,n);n+=2,l>0&&(s.featureParams=c+l);var u=i.readUshort(r,n);n+=2,s.tab=[];for(var d=0;d<u;d++)s.tab.push(i.readUshort(r,n+2*d));return s},t._lctf.readScriptList=function(r,n){var i=t._bin,c=n,s={},l=i.readUshort(r,n);n+=2;for(var u=0;u<l;u++){var d=i.readASCII(r,n,4);n+=4;var f=i.readUshort(r,n);n+=2,s[d.trim()]=t._lctf.readScriptTable(r,c+f)}return s},t._lctf.readScriptTable=function(r,n){var i=t._bin,c=n,s={},l=i.readUshort(r,n);n+=2,l>0&&(s.default=t._lctf.readLangSysTable(r,c+l));var u=i.readUshort(r,n);n+=2;for(var d=0;d<u;d++){var f=i.readASCII(r,n,4);n+=4;var p=i.readUshort(r,n);n+=2,s[f.trim()]=t._lctf.readLangSysTable(r,c+p)}return s},t._lctf.readLangSysTable=function(r,n){var i=t._bin,c={};i.readUshort(r,n),n+=2,c.reqFeature=i.readUshort(r,n),n+=2;var s=i.readUshort(r,n);return n+=2,c.features=i.readUshorts(r,n,s),c},t.CFF={},t.CFF.parse=function(r,n,i){var c=t._bin;(r=new Uint8Array(r.buffer,n,i))[n=0],r[++n],r[++n],r[++n],n++;var s=[];n=t.CFF.readIndex(r,n,s);for(var l=[],u=0;u<s.length-1;u++)l.push(c.readASCII(r,n+s[u],s[u+1]-s[u]));n+=s[s.length-1];var d=[];n=t.CFF.readIndex(r,n,d);var f=[];for(u=0;u<d.length-1;u++)f.push(t.CFF.readDict(r,n+d[u],n+d[u+1]));n+=d[d.length-1];var p=f[0],y=[];n=t.CFF.readIndex(r,n,y);var m=[];for(u=0;u<y.length-1;u++)m.push(c.readASCII(r,n+y[u],y[u+1]-y[u]));if(n+=y[y.length-1],t.CFF.readSubrs(r,n,p),p.CharStrings){n=p.CharStrings,y=[],n=t.CFF.readIndex(r,n,y);var v=[];for(u=0;u<y.length-1;u++)v.push(c.readBytes(r,n+y[u],y[u+1]-y[u]));p.CharStrings=v}if(p.ROS){n=p.FDArray;var _=[];for(n=t.CFF.readIndex(r,n,_),p.FDArray=[],u=0;u<_.length-1;u++){var w=t.CFF.readDict(r,n+_[u],n+_[u+1]);t.CFF._readFDict(r,w,m),p.FDArray.push(w)}n+=_[_.length-1],n=p.FDSelect,p.FDSelect=[];var C=r[n];if(n++,C!=3)throw C;var x=c.readUshort(r,n);for(n+=2,u=0;u<x+1;u++)p.FDSelect.push(c.readUshort(r,n),r[n+2]),n+=3}return p.Encoding&&(p.Encoding=t.CFF.readEncoding(r,p.Encoding,p.CharStrings.length)),p.charset&&(p.charset=t.CFF.readCharset(r,p.charset,p.CharStrings.length)),t.CFF._readFDict(r,p,m),p},t.CFF._readFDict=function(r,n,i){var c;for(var s in n.Private&&(c=n.Private[1],n.Private=t.CFF.readDict(r,c,c+n.Private[0]),n.Private.Subrs&&t.CFF.readSubrs(r,c+n.Private.Subrs,n.Private)),n)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(s)!=-1&&(n[s]=i[n[s]-426+35])},t.CFF.readSubrs=function(r,n,i){var c=t._bin,s=[];n=t.CFF.readIndex(r,n,s);var l,u=s.length;l=u<1240?107:u<33900?1131:32768,i.Bias=l,i.Subrs=[];for(var d=0;d<s.length-1;d++)i.Subrs.push(c.readBytes(r,n+s[d],s[d+1]-s[d]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(r,n){for(var i=0;i<r.charset.length;i++)if(r.charset[i]==n)return i;return-1},t.CFF.glyphBySE=function(r,n){return n<0||n>255?-1:t.CFF.glyphByUnicode(r,t.CFF.tableSE[n])},t.CFF.readEncoding=function(r,n,i){t._bin;var c=[".notdef"],s=r[n];if(n++,s!=0)throw"error: unknown encoding format: "+s;var l=r[n];n++;for(var u=0;u<l;u++)c.push(r[n+u]);return c},t.CFF.readCharset=function(r,n,i){var c=t._bin,s=[".notdef"],l=r[n];if(n++,l==0)for(var u=0;u<i;u++){var d=c.readUshort(r,n);n+=2,s.push(d)}else{if(l!=1&&l!=2)throw"error: format: "+l;for(;s.length<i;){d=c.readUshort(r,n),n+=2;var f=0;for(l==1?(f=r[n],n++):(f=c.readUshort(r,n),n+=2),u=0;u<=f;u++)s.push(d),d++}}return s},t.CFF.readIndex=function(r,n,i){var c=t._bin,s=c.readUshort(r,n)+1,l=r[n+=2];if(n++,l==1)for(var u=0;u<s;u++)i.push(r[n+u]);else if(l==2)for(u=0;u<s;u++)i.push(c.readUshort(r,n+2*u));else if(l==3)for(u=0;u<s;u++)i.push(16777215&c.readUint(r,n+3*u-1));else if(s!=1)throw"unsupported offset size: "+l+", count: "+s;return(n+=s*l)-1},t.CFF.getCharString=function(r,n,i){var c=t._bin,s=r[n],l=r[n+1];r[n+2],r[n+3],r[n+4];var u=1,d=null,f=null;s<=20&&(d=s,u=1),s==12&&(d=100*s+l,u=2),21<=s&&s<=27&&(d=s,u=1),s==28&&(f=c.readShort(r,n+1),u=3),29<=s&&s<=31&&(d=s,u=1),32<=s&&s<=246&&(f=s-139,u=1),247<=s&&s<=250&&(f=256*(s-247)+l+108,u=2),251<=s&&s<=254&&(f=256*-(s-251)-l-108,u=2),s==255&&(f=c.readInt(r,n+1)/65535,u=5),i.val=f??"o"+d,i.size=u},t.CFF.readCharString=function(r,n,i){for(var c=n+i,s=t._bin,l=[];n<c;){var u=r[n],d=r[n+1];r[n+2],r[n+3],r[n+4];var f=1,p=null,y=null;u<=20&&(p=u,f=1),u==12&&(p=100*u+d,f=2),u!=19&&u!=20||(p=u,f=2),21<=u&&u<=27&&(p=u,f=1),u==28&&(y=s.readShort(r,n+1),f=3),29<=u&&u<=31&&(p=u,f=1),32<=u&&u<=246&&(y=u-139,f=1),247<=u&&u<=250&&(y=256*(u-247)+d+108,f=2),251<=u&&u<=254&&(y=256*-(u-251)-d-108,f=2),u==255&&(y=s.readInt(r,n+1)/65535,f=5),l.push(y??"o"+p),n+=f}return l},t.CFF.readDict=function(r,n,i){for(var c=t._bin,s={},l=[];n<i;){var u=r[n],d=r[n+1];r[n+2],r[n+3],r[n+4];var f=1,p=null,y=null;if(u==28&&(y=c.readShort(r,n+1),f=3),u==29&&(y=c.readInt(r,n+1),f=5),32<=u&&u<=246&&(y=u-139,f=1),247<=u&&u<=250&&(y=256*(u-247)+d+108,f=2),251<=u&&u<=254&&(y=256*-(u-251)-d-108,f=2),u==255)throw y=c.readInt(r,n+1)/65535,f=5,"unknown number";if(u==30){var m=[];for(f=1;;){var v=r[n+f];f++;var _=v>>4,w=15&v;if(_!=15&&m.push(_),w!=15&&m.push(w),w==15)break}for(var C="",x=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],A=0;A<m.length;A++)C+=x[m[A]];y=parseFloat(C)}u<=21&&(p=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],f=1,u==12&&(p=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][d],f=2)),p!=null?(s[p]=l.length==1?l[0]:l,l=[]):l.push(y),n+=f}return s},t.cmap={},t.cmap.parse=function(r,n,i){r=new Uint8Array(r.buffer,n,i),n=0;var c=t._bin,s={};c.readUshort(r,n),n+=2;var l=c.readUshort(r,n);n+=2;var u=[];s.tables=[];for(var d=0;d<l;d++){var f=c.readUshort(r,n);n+=2;var p=c.readUshort(r,n);n+=2;var y=c.readUint(r,n);n+=4;var m="p"+f+"e"+p,v=u.indexOf(y);if(v==-1){var _;v=s.tables.length,u.push(y);var w=c.readUshort(r,y);w==0?_=t.cmap.parse0(r,y):w==4?_=t.cmap.parse4(r,y):w==6?_=t.cmap.parse6(r,y):w==12?_=t.cmap.parse12(r,y):console.debug("unknown format: "+w,f,p,y),s.tables.push(_)}if(s[m]!=null)throw"multiple tables for one platform+encoding";s[m]=v}return s},t.cmap.parse0=function(r,n){var i=t._bin,c={};c.format=i.readUshort(r,n),n+=2;var s=i.readUshort(r,n);n+=2,i.readUshort(r,n),n+=2,c.map=[];for(var l=0;l<s-6;l++)c.map.push(r[n+l]);return c},t.cmap.parse4=function(r,n){var i=t._bin,c=n,s={};s.format=i.readUshort(r,n),n+=2;var l=i.readUshort(r,n);n+=2,i.readUshort(r,n),n+=2;var u=i.readUshort(r,n);n+=2;var d=u/2;s.searchRange=i.readUshort(r,n),n+=2,s.entrySelector=i.readUshort(r,n),n+=2,s.rangeShift=i.readUshort(r,n),n+=2,s.endCount=i.readUshorts(r,n,d),n+=2*d,n+=2,s.startCount=i.readUshorts(r,n,d),n+=2*d,s.idDelta=[];for(var f=0;f<d;f++)s.idDelta.push(i.readShort(r,n)),n+=2;for(s.idRangeOffset=i.readUshorts(r,n,d),n+=2*d,s.glyphIdArray=[];n<c+l;)s.glyphIdArray.push(i.readUshort(r,n)),n+=2;return s},t.cmap.parse6=function(r,n){var i=t._bin,c={};c.format=i.readUshort(r,n),n+=2,i.readUshort(r,n),n+=2,i.readUshort(r,n),n+=2,c.firstCode=i.readUshort(r,n),n+=2;var s=i.readUshort(r,n);n+=2,c.glyphIdArray=[];for(var l=0;l<s;l++)c.glyphIdArray.push(i.readUshort(r,n)),n+=2;return c},t.cmap.parse12=function(r,n){var i=t._bin,c={};c.format=i.readUshort(r,n),n+=2,n+=2,i.readUint(r,n),n+=4,i.readUint(r,n),n+=4;var s=i.readUint(r,n);n+=4,c.groups=[];for(var l=0;l<s;l++){var u=n+12*l,d=i.readUint(r,u+0),f=i.readUint(r,u+4),p=i.readUint(r,u+8);c.groups.push([d,f,p])}return c},t.glyf={},t.glyf.parse=function(r,n,i,c){for(var s=[],l=0;l<c.maxp.numGlyphs;l++)s.push(null);return s},t.glyf._parseGlyf=function(r,n){var i=t._bin,c=r._data,s=t._tabOffset(c,"glyf",r._offset)+r.loca[n];if(r.loca[n]==r.loca[n+1])return null;var l={};if(l.noc=i.readShort(c,s),s+=2,l.xMin=i.readShort(c,s),s+=2,l.yMin=i.readShort(c,s),s+=2,l.xMax=i.readShort(c,s),s+=2,l.yMax=i.readShort(c,s),s+=2,l.xMin>=l.xMax||l.yMin>=l.yMax)return null;if(l.noc>0){l.endPts=[];for(var u=0;u<l.noc;u++)l.endPts.push(i.readUshort(c,s)),s+=2;var d=i.readUshort(c,s);if(s+=2,c.length-s<d)return null;l.instructions=i.readBytes(c,s,d),s+=d;var f=l.endPts[l.noc-1]+1;for(l.flags=[],u=0;u<f;u++){var p=c[s];if(s++,l.flags.push(p),(8&p)!=0){var y=c[s];s++;for(var m=0;m<y;m++)l.flags.push(p),u++}}for(l.xs=[],u=0;u<f;u++){var v=(2&l.flags[u])!=0,_=(16&l.flags[u])!=0;v?(l.xs.push(_?c[s]:-c[s]),s++):_?l.xs.push(0):(l.xs.push(i.readShort(c,s)),s+=2)}for(l.ys=[],u=0;u<f;u++)v=(4&l.flags[u])!=0,_=(32&l.flags[u])!=0,v?(l.ys.push(_?c[s]:-c[s]),s++):_?l.ys.push(0):(l.ys.push(i.readShort(c,s)),s+=2);var w=0,C=0;for(u=0;u<f;u++)w+=l.xs[u],C+=l.ys[u],l.xs[u]=w,l.ys[u]=C}else{var x;l.parts=[];do{x=i.readUshort(c,s),s+=2;var A={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(l.parts.push(A),A.glyphIndex=i.readUshort(c,s),s+=2,1&x){var D=i.readShort(c,s);s+=2;var S=i.readShort(c,s);s+=2}else D=i.readInt8(c,s),s++,S=i.readInt8(c,s),s++;2&x?(A.m.tx=D,A.m.ty=S):(A.p1=D,A.p2=S),8&x?(A.m.a=A.m.d=i.readF2dot14(c,s),s+=2):64&x?(A.m.a=i.readF2dot14(c,s),s+=2,A.m.d=i.readF2dot14(c,s),s+=2):128&x&&(A.m.a=i.readF2dot14(c,s),s+=2,A.m.b=i.readF2dot14(c,s),s+=2,A.m.c=i.readF2dot14(c,s),s+=2,A.m.d=i.readF2dot14(c,s),s+=2)}while(32&x);if(256&x){var P=i.readUshort(c,s);for(s+=2,l.instr=[],u=0;u<P;u++)l.instr.push(c[s]),s++}}return l},t.GDEF={},t.GDEF.parse=function(r,n,i,c){var s=n;n+=4;var l=t._bin.readUshort(r,n);return{glyphClassDef:l===0?null:t._lctf.readClassDef(r,s+l)}},t.GPOS={},t.GPOS.parse=function(r,n,i,c){return t._lctf.parse(r,n,i,c,t.GPOS.subt)},t.GPOS.subt=function(r,n,i,c){var s=t._bin,l=i,u={};if(u.fmt=s.readUshort(r,i),i+=2,n==1||n==2||n==3||n==7||n==8&&u.fmt<=2){var d=s.readUshort(r,i);i+=2,u.coverage=t._lctf.readCoverage(r,d+l)}if(n==1&&u.fmt==1){var f=s.readUshort(r,i);i+=2,f!=0&&(u.pos=t.GPOS.readValueRecord(r,i,f))}else if(n==2&&u.fmt>=1&&u.fmt<=2){f=s.readUshort(r,i),i+=2;var p=s.readUshort(r,i);i+=2;var y=t._lctf.numOfOnes(f),m=t._lctf.numOfOnes(p);if(u.fmt==1){u.pairsets=[];var v=s.readUshort(r,i);i+=2;for(var _=0;_<v;_++){var w=l+s.readUshort(r,i);i+=2;var C=s.readUshort(r,w);w+=2;for(var x=[],A=0;A<C;A++){var D=s.readUshort(r,w);w+=2,f!=0&&(T=t.GPOS.readValueRecord(r,w,f),w+=2*y),p!=0&&(U=t.GPOS.readValueRecord(r,w,p),w+=2*m),x.push({gid2:D,val1:T,val2:U})}u.pairsets.push(x)}}if(u.fmt==2){var S=s.readUshort(r,i);i+=2;var P=s.readUshort(r,i);i+=2;var I=s.readUshort(r,i);i+=2;var j=s.readUshort(r,i);for(i+=2,u.classDef1=t._lctf.readClassDef(r,l+S),u.classDef2=t._lctf.readClassDef(r,l+P),u.matrix=[],_=0;_<I;_++){var H=[];for(A=0;A<j;A++){var T=null,U=null;f!=0&&(T=t.GPOS.readValueRecord(r,i,f),i+=2*y),p!=0&&(U=t.GPOS.readValueRecord(r,i,p),i+=2*m),H.push({val1:T,val2:U})}u.matrix.push(H)}}}else if(n==4&&u.fmt==1)u.markCoverage=t._lctf.readCoverage(r,s.readUshort(r,i)+l),u.baseCoverage=t._lctf.readCoverage(r,s.readUshort(r,i+2)+l),u.markClassCount=s.readUshort(r,i+4),u.markArray=t.GPOS.readMarkArray(r,s.readUshort(r,i+6)+l),u.baseArray=t.GPOS.readBaseArray(r,s.readUshort(r,i+8)+l,u.markClassCount);else if(n==6&&u.fmt==1)u.mark1Coverage=t._lctf.readCoverage(r,s.readUshort(r,i)+l),u.mark2Coverage=t._lctf.readCoverage(r,s.readUshort(r,i+2)+l),u.markClassCount=s.readUshort(r,i+4),u.mark1Array=t.GPOS.readMarkArray(r,s.readUshort(r,i+6)+l),u.mark2Array=t.GPOS.readBaseArray(r,s.readUshort(r,i+8)+l,u.markClassCount);else{if(n==9&&u.fmt==1){var g=s.readUshort(r,i);i+=2;var k=s.readUint(r,i);if(i+=4,c.ltype==9)c.ltype=g;else if(c.ltype!=g)throw"invalid extension substitution";return t.GPOS.subt(r,c.ltype,l+k)}console.debug("unsupported GPOS table LookupType",n,"format",u.fmt)}return u},t.GPOS.readValueRecord=function(r,n,i){var c=t._bin,s=[];return s.push(1&i?c.readShort(r,n):0),n+=1&i?2:0,s.push(2&i?c.readShort(r,n):0),n+=2&i?2:0,s.push(4&i?c.readShort(r,n):0),n+=4&i?2:0,s.push(8&i?c.readShort(r,n):0),n+=8&i?2:0,s},t.GPOS.readBaseArray=function(r,n,i){var c=t._bin,s=[],l=n,u=c.readUshort(r,n);n+=2;for(var d=0;d<u;d++){for(var f=[],p=0;p<i;p++)f.push(t.GPOS.readAnchorRecord(r,l+c.readUshort(r,n))),n+=2;s.push(f)}return s},t.GPOS.readMarkArray=function(r,n){var i=t._bin,c=[],s=n,l=i.readUshort(r,n);n+=2;for(var u=0;u<l;u++){var d=t.GPOS.readAnchorRecord(r,i.readUshort(r,n+2)+s);d.markClass=i.readUshort(r,n),c.push(d),n+=4}return c},t.GPOS.readAnchorRecord=function(r,n){var i=t._bin,c={};return c.fmt=i.readUshort(r,n),c.x=i.readShort(r,n+2),c.y=i.readShort(r,n+4),c},t.GSUB={},t.GSUB.parse=function(r,n,i,c){return t._lctf.parse(r,n,i,c,t.GSUB.subt)},t.GSUB.subt=function(r,n,i,c){var s=t._bin,l=i,u={};if(u.fmt=s.readUshort(r,i),i+=2,n!=1&&n!=2&&n!=4&&n!=5&&n!=6)return null;if(n==1||n==2||n==4||n==5&&u.fmt<=2||n==6&&u.fmt<=2){var d=s.readUshort(r,i);i+=2,u.coverage=t._lctf.readCoverage(r,l+d)}if(n==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=s.readShort(r,i),i+=2;else if(u.fmt==2){var f=s.readUshort(r,i);i+=2,u.newg=s.readUshorts(r,i,f),i+=2*u.newg.length}}else if(n==2&&u.fmt==1){f=s.readUshort(r,i),i+=2,u.seqs=[];for(var p=0;p<f;p++){var y=s.readUshort(r,i)+l;i+=2;var m=s.readUshort(r,y);u.seqs.push(s.readUshorts(r,y+2,m))}}else if(n==4)for(u.vals=[],f=s.readUshort(r,i),i+=2,p=0;p<f;p++){var v=s.readUshort(r,i);i+=2,u.vals.push(t.GSUB.readLigatureSet(r,l+v))}else if(n==5&&u.fmt==2){if(u.fmt==2){var _=s.readUshort(r,i);i+=2,u.cDef=t._lctf.readClassDef(r,l+_),u.scset=[];var w=s.readUshort(r,i);for(i+=2,p=0;p<w;p++){var C=s.readUshort(r,i);i+=2,u.scset.push(C==0?null:t.GSUB.readSubClassSet(r,l+C))}}}else if(n==6&&u.fmt==3){if(u.fmt==3){for(p=0;p<3;p++){f=s.readUshort(r,i),i+=2;for(var x=[],A=0;A<f;A++)x.push(t._lctf.readCoverage(r,l+s.readUshort(r,i+2*A)));i+=2*f,p==0&&(u.backCvg=x),p==1&&(u.inptCvg=x),p==2&&(u.ahedCvg=x)}f=s.readUshort(r,i),i+=2,u.lookupRec=t.GSUB.readSubstLookupRecords(r,i,f)}}else{if(n==7&&u.fmt==1){var D=s.readUshort(r,i);i+=2;var S=s.readUint(r,i);if(i+=4,c.ltype==9)c.ltype=D;else if(c.ltype!=D)throw"invalid extension substitution";return t.GSUB.subt(r,c.ltype,l+S)}console.debug("unsupported GSUB table LookupType",n,"format",u.fmt)}return u},t.GSUB.readSubClassSet=function(r,n){var i=t._bin.readUshort,c=n,s=[],l=i(r,n);n+=2;for(var u=0;u<l;u++){var d=i(r,n);n+=2,s.push(t.GSUB.readSubClassRule(r,c+d))}return s},t.GSUB.readSubClassRule=function(r,n){var i=t._bin.readUshort,c={},s=i(r,n),l=i(r,n+=2);n+=2,c.input=[];for(var u=0;u<s-1;u++)c.input.push(i(r,n)),n+=2;return c.substLookupRecords=t.GSUB.readSubstLookupRecords(r,n,l),c},t.GSUB.readSubstLookupRecords=function(r,n,i){for(var c=t._bin.readUshort,s=[],l=0;l<i;l++)s.push(c(r,n),c(r,n+2)),n+=4;return s},t.GSUB.readChainSubClassSet=function(r,n){var i=t._bin,c=n,s=[],l=i.readUshort(r,n);n+=2;for(var u=0;u<l;u++){var d=i.readUshort(r,n);n+=2,s.push(t.GSUB.readChainSubClassRule(r,c+d))}return s},t.GSUB.readChainSubClassRule=function(r,n){for(var i=t._bin,c={},s=["backtrack","input","lookahead"],l=0;l<s.length;l++){var u=i.readUshort(r,n);n+=2,l==1&&u--,c[s[l]]=i.readUshorts(r,n,u),n+=2*c[s[l]].length}return u=i.readUshort(r,n),n+=2,c.subst=i.readUshorts(r,n,2*u),n+=2*c.subst.length,c},t.GSUB.readLigatureSet=function(r,n){var i=t._bin,c=n,s=[],l=i.readUshort(r,n);n+=2;for(var u=0;u<l;u++){var d=i.readUshort(r,n);n+=2,s.push(t.GSUB.readLigature(r,c+d))}return s},t.GSUB.readLigature=function(r,n){var i=t._bin,c={chain:[]};c.nglyph=i.readUshort(r,n),n+=2;var s=i.readUshort(r,n);n+=2;for(var l=0;l<s-1;l++)c.chain.push(i.readUshort(r,n)),n+=2;return c},t.head={},t.head.parse=function(r,n,i){var c=t._bin,s={};return c.readFixed(r,n),n+=4,s.fontRevision=c.readFixed(r,n),n+=4,c.readUint(r,n),n+=4,c.readUint(r,n),n+=4,s.flags=c.readUshort(r,n),n+=2,s.unitsPerEm=c.readUshort(r,n),n+=2,s.created=c.readUint64(r,n),n+=8,s.modified=c.readUint64(r,n),n+=8,s.xMin=c.readShort(r,n),n+=2,s.yMin=c.readShort(r,n),n+=2,s.xMax=c.readShort(r,n),n+=2,s.yMax=c.readShort(r,n),n+=2,s.macStyle=c.readUshort(r,n),n+=2,s.lowestRecPPEM=c.readUshort(r,n),n+=2,s.fontDirectionHint=c.readShort(r,n),n+=2,s.indexToLocFormat=c.readShort(r,n),n+=2,s.glyphDataFormat=c.readShort(r,n),n+=2,s},t.hhea={},t.hhea.parse=function(r,n,i){var c=t._bin,s={};return c.readFixed(r,n),n+=4,s.ascender=c.readShort(r,n),n+=2,s.descender=c.readShort(r,n),n+=2,s.lineGap=c.readShort(r,n),n+=2,s.advanceWidthMax=c.readUshort(r,n),n+=2,s.minLeftSideBearing=c.readShort(r,n),n+=2,s.minRightSideBearing=c.readShort(r,n),n+=2,s.xMaxExtent=c.readShort(r,n),n+=2,s.caretSlopeRise=c.readShort(r,n),n+=2,s.caretSlopeRun=c.readShort(r,n),n+=2,s.caretOffset=c.readShort(r,n),n+=2,n+=8,s.metricDataFormat=c.readShort(r,n),n+=2,s.numberOfHMetrics=c.readUshort(r,n),n+=2,s},t.hmtx={},t.hmtx.parse=function(r,n,i,c){for(var s=t._bin,l={aWidth:[],lsBearing:[]},u=0,d=0,f=0;f<c.maxp.numGlyphs;f++)f<c.hhea.numberOfHMetrics&&(u=s.readUshort(r,n),n+=2,d=s.readShort(r,n),n+=2),l.aWidth.push(u),l.lsBearing.push(d);return l},t.kern={},t.kern.parse=function(r,n,i,c){var s=t._bin,l=s.readUshort(r,n);if(n+=2,l==1)return t.kern.parseV1(r,n-2,i,c);var u=s.readUshort(r,n);n+=2;for(var d={glyph1:[],rval:[]},f=0;f<u;f++){n+=2,i=s.readUshort(r,n),n+=2;var p=s.readUshort(r,n);n+=2;var y=p>>>8;if((y&=15)!=0)throw"unknown kern table format: "+y;n=t.kern.readFormat0(r,n,d)}return d},t.kern.parseV1=function(r,n,i,c){var s=t._bin;s.readFixed(r,n),n+=4;var l=s.readUint(r,n);n+=4;for(var u={glyph1:[],rval:[]},d=0;d<l;d++){s.readUint(r,n),n+=4;var f=s.readUshort(r,n);n+=2,s.readUshort(r,n),n+=2;var p=f>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;n=t.kern.readFormat0(r,n,u)}return u},t.kern.readFormat0=function(r,n,i){var c=t._bin,s=-1,l=c.readUshort(r,n);n+=2,c.readUshort(r,n),n+=2,c.readUshort(r,n),n+=2,c.readUshort(r,n),n+=2;for(var u=0;u<l;u++){var d=c.readUshort(r,n);n+=2;var f=c.readUshort(r,n);n+=2;var p=c.readShort(r,n);n+=2,d!=s&&(i.glyph1.push(d),i.rval.push({glyph2:[],vals:[]}));var y=i.rval[i.rval.length-1];y.glyph2.push(f),y.vals.push(p),s=d}return n},t.loca={},t.loca.parse=function(r,n,i,c){var s=t._bin,l=[],u=c.head.indexToLocFormat,d=c.maxp.numGlyphs+1;if(u==0)for(var f=0;f<d;f++)l.push(s.readUshort(r,n+(f<<1))<<1);if(u==1)for(f=0;f<d;f++)l.push(s.readUint(r,n+(f<<2)));return l},t.maxp={},t.maxp.parse=function(r,n,i){var c=t._bin,s={},l=c.readUint(r,n);return n+=4,s.numGlyphs=c.readUshort(r,n),n+=2,l==65536&&(s.maxPoints=c.readUshort(r,n),n+=2,s.maxContours=c.readUshort(r,n),n+=2,s.maxCompositePoints=c.readUshort(r,n),n+=2,s.maxCompositeContours=c.readUshort(r,n),n+=2,s.maxZones=c.readUshort(r,n),n+=2,s.maxTwilightPoints=c.readUshort(r,n),n+=2,s.maxStorage=c.readUshort(r,n),n+=2,s.maxFunctionDefs=c.readUshort(r,n),n+=2,s.maxInstructionDefs=c.readUshort(r,n),n+=2,s.maxStackElements=c.readUshort(r,n),n+=2,s.maxSizeOfInstructions=c.readUshort(r,n),n+=2,s.maxComponentElements=c.readUshort(r,n),n+=2,s.maxComponentDepth=c.readUshort(r,n),n+=2),s},t.name={},t.name.parse=function(r,n,i){var c=t._bin,s={};c.readUshort(r,n),n+=2;var l=c.readUshort(r,n);n+=2,c.readUshort(r,n);for(var u,d=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],f=n+=2,p=0;p<l;p++){var y=c.readUshort(r,n);n+=2;var m=c.readUshort(r,n);n+=2;var v=c.readUshort(r,n);n+=2;var _=c.readUshort(r,n);n+=2;var w=c.readUshort(r,n);n+=2;var C=c.readUshort(r,n);n+=2;var x,A=d[_],D=f+12*l+C;if(y==0)x=c.readUnicode(r,D,w/2);else if(y==3&&m==0)x=c.readUnicode(r,D,w/2);else if(m==0)x=c.readASCII(r,D,w);else if(m==1)x=c.readUnicode(r,D,w/2);else if(m==3)x=c.readUnicode(r,D,w/2);else{if(y!=1)throw"unknown encoding "+m+", platformID: "+y;x=c.readASCII(r,D,w),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var S="p"+y+","+v.toString(16);s[S]==null&&(s[S]={}),s[S][A!==void 0?A:_]=x,s[S]._lang=v}for(var P in s)if(s[P].postScriptName!=null&&s[P]._lang==1033)return s[P];for(var P in s)if(s[P].postScriptName!=null&&s[P]._lang==0)return s[P];for(var P in s)if(s[P].postScriptName!=null&&s[P]._lang==3084)return s[P];for(var P in s)if(s[P].postScriptName!=null)return s[P];for(var P in s){u=P;break}return console.debug("returning name table with languageID "+s[u]._lang),s[u]},t["OS/2"]={},t["OS/2"].parse=function(r,n,i){var c=t._bin.readUshort(r,n);n+=2;var s={};if(c==0)t["OS/2"].version0(r,n,s);else if(c==1)t["OS/2"].version1(r,n,s);else if(c==2||c==3||c==4)t["OS/2"].version2(r,n,s);else{if(c!=5)throw"unknown OS/2 table version: "+c;t["OS/2"].version5(r,n,s)}return s},t["OS/2"].version0=function(r,n,i){var c=t._bin;return i.xAvgCharWidth=c.readShort(r,n),n+=2,i.usWeightClass=c.readUshort(r,n),n+=2,i.usWidthClass=c.readUshort(r,n),n+=2,i.fsType=c.readUshort(r,n),n+=2,i.ySubscriptXSize=c.readShort(r,n),n+=2,i.ySubscriptYSize=c.readShort(r,n),n+=2,i.ySubscriptXOffset=c.readShort(r,n),n+=2,i.ySubscriptYOffset=c.readShort(r,n),n+=2,i.ySuperscriptXSize=c.readShort(r,n),n+=2,i.ySuperscriptYSize=c.readShort(r,n),n+=2,i.ySuperscriptXOffset=c.readShort(r,n),n+=2,i.ySuperscriptYOffset=c.readShort(r,n),n+=2,i.yStrikeoutSize=c.readShort(r,n),n+=2,i.yStrikeoutPosition=c.readShort(r,n),n+=2,i.sFamilyClass=c.readShort(r,n),n+=2,i.panose=c.readBytes(r,n,10),n+=10,i.ulUnicodeRange1=c.readUint(r,n),n+=4,i.ulUnicodeRange2=c.readUint(r,n),n+=4,i.ulUnicodeRange3=c.readUint(r,n),n+=4,i.ulUnicodeRange4=c.readUint(r,n),n+=4,i.achVendID=[c.readInt8(r,n),c.readInt8(r,n+1),c.readInt8(r,n+2),c.readInt8(r,n+3)],n+=4,i.fsSelection=c.readUshort(r,n),n+=2,i.usFirstCharIndex=c.readUshort(r,n),n+=2,i.usLastCharIndex=c.readUshort(r,n),n+=2,i.sTypoAscender=c.readShort(r,n),n+=2,i.sTypoDescender=c.readShort(r,n),n+=2,i.sTypoLineGap=c.readShort(r,n),n+=2,i.usWinAscent=c.readUshort(r,n),n+=2,i.usWinDescent=c.readUshort(r,n),n+=2},t["OS/2"].version1=function(r,n,i){var c=t._bin;return n=t["OS/2"].version0(r,n,i),i.ulCodePageRange1=c.readUint(r,n),n+=4,i.ulCodePageRange2=c.readUint(r,n),n+=4},t["OS/2"].version2=function(r,n,i){var c=t._bin;return n=t["OS/2"].version1(r,n,i),i.sxHeight=c.readShort(r,n),n+=2,i.sCapHeight=c.readShort(r,n),n+=2,i.usDefault=c.readUshort(r,n),n+=2,i.usBreak=c.readUshort(r,n),n+=2,i.usMaxContext=c.readUshort(r,n),n+=2},t["OS/2"].version5=function(r,n,i){var c=t._bin;return n=t["OS/2"].version2(r,n,i),i.usLowerOpticalPointSize=c.readUshort(r,n),n+=2,i.usUpperOpticalPointSize=c.readUshort(r,n),n+=2},t.post={},t.post.parse=function(r,n,i){var c=t._bin,s={};return s.version=c.readFixed(r,n),n+=4,s.italicAngle=c.readFixed(r,n),n+=4,s.underlinePosition=c.readShort(r,n),n+=2,s.underlineThickness=c.readShort(r,n),n+=2,s},t==null&&(t={}),t.U==null&&(t.U={}),t.U.codeToGlyph=function(r,n){var i=r.cmap,c=-1;if(i.p0e4!=null?c=i.p0e4:i.p3e1!=null?c=i.p3e1:i.p1e0!=null?c=i.p1e0:i.p0e3!=null&&(c=i.p0e3),c==-1)throw"no familiar platform and encoding!";var s=i.tables[c];if(s.format==0)return n>=s.map.length?0:s.map[n];if(s.format==4){for(var l=-1,u=0;u<s.endCount.length;u++)if(n<=s.endCount[u]){l=u;break}return l==-1||s.startCount[l]>n?0:65535&(s.idRangeOffset[l]!=0?s.glyphIdArray[n-s.startCount[l]+(s.idRangeOffset[l]>>1)-(s.idRangeOffset.length-l)]:n+s.idDelta[l])}if(s.format==12){if(n>s.groups[s.groups.length-1][1])return 0;for(u=0;u<s.groups.length;u++){var d=s.groups[u];if(d[0]<=n&&n<=d[1])return d[2]+(n-d[0])}return 0}throw"unknown cmap table format "+s.format},t.U.glyphToPath=function(r,n){var i={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[n]){var c=r.SVG.entries[n];return c==null?i:(typeof c=="string"&&(c=t.SVG.toPath(c),r.SVG.entries[n]=c),c)}if(r.CFF){var s={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},l=r.CFF,u=r.CFF.Private;if(l.ROS){for(var d=0;l.FDSelect[d+2]<=n;)d+=2;u=l.FDArray[l.FDSelect[d+1]].Private}t.U._drawCFF(r.CFF.CharStrings[n],s,l,u,i)}else r.glyf&&t.U._drawGlyf(n,r,i);return i},t.U._drawGlyf=function(r,n,i){var c=n.glyf[r];c==null&&(c=n.glyf[r]=t.glyf._parseGlyf(n,r)),c!=null&&(c.noc>-1?t.U._simpleGlyph(c,i):t.U._compoGlyph(c,n,i))},t.U._simpleGlyph=function(r,n){for(var i=0;i<r.noc;i++){for(var c=i==0?0:r.endPts[i-1]+1,s=r.endPts[i],l=c;l<=s;l++){var u=l==c?s:l-1,d=l==s?c:l+1,f=1&r.flags[l],p=1&r.flags[u],y=1&r.flags[d],m=r.xs[l],v=r.ys[l];if(l==c)if(f){if(!p){t.U.P.moveTo(n,m,v);continue}t.U.P.moveTo(n,r.xs[u],r.ys[u])}else p?t.U.P.moveTo(n,r.xs[u],r.ys[u]):t.U.P.moveTo(n,(r.xs[u]+m)/2,(r.ys[u]+v)/2);f?p&&t.U.P.lineTo(n,m,v):y?t.U.P.qcurveTo(n,m,v,r.xs[d],r.ys[d]):t.U.P.qcurveTo(n,m,v,(m+r.xs[d])/2,(v+r.ys[d])/2)}t.U.P.closePath(n)}},t.U._compoGlyph=function(r,n,i){for(var c=0;c<r.parts.length;c++){var s={cmds:[],crds:[]},l=r.parts[c];t.U._drawGlyf(l.glyphIndex,n,s);for(var u=l.m,d=0;d<s.crds.length;d+=2){var f=s.crds[d],p=s.crds[d+1];i.crds.push(f*u.a+p*u.b+u.tx),i.crds.push(f*u.c+p*u.d+u.ty)}for(d=0;d<s.cmds.length;d++)i.cmds.push(s.cmds[d])}},t.U._getGlyphClass=function(r,n){var i=t._lctf.getInterval(n,r);return i==-1?0:n[i+2]},t.U._applySubs=function(r,n,i,c){for(var s=r.length-n-1,l=0;l<i.tabs.length;l++)if(i.tabs[l]!=null){var u,d=i.tabs[l];if(!d.coverage||(u=t._lctf.coverageIndex(d.coverage,r[n]))!=-1){if(i.ltype==1)r[n],d.fmt==1?r[n]=r[n]+d.delta:r[n]=d.newg[u];else if(i.ltype==4)for(var f=d.vals[u],p=0;p<f.length;p++){var y=f[p],m=y.chain.length;if(!(m>s)){for(var v=!0,_=0,w=0;w<m;w++){for(;r[n+_+(1+w)]==-1;)_++;y.chain[w]!=r[n+_+(1+w)]&&(v=!1)}if(v){for(r[n]=y.nglyph,w=0;w<m+_;w++)r[n+w+1]=-1;break}}}else if(i.ltype==5&&d.fmt==2)for(var C=t._lctf.getInterval(d.cDef,r[n]),x=d.cDef[C+2],A=d.scset[x],D=0;D<A.length;D++){var S=A[D],P=S.input;if(!(P.length>s)){for(v=!0,w=0;w<P.length;w++){var I=t._lctf.getInterval(d.cDef,r[n+1+w]);if(C==-1&&d.cDef[I+2]!=P[w]){v=!1;break}}if(v){var j=S.substLookupRecords;for(p=0;p<j.length;p+=2)j[p],j[p+1]}}}else if(i.ltype==6&&d.fmt==3){if(!t.U._glsCovered(r,d.backCvg,n-d.backCvg.length)||!t.U._glsCovered(r,d.inptCvg,n)||!t.U._glsCovered(r,d.ahedCvg,n+d.inptCvg.length))continue;var H=d.lookupRec;for(D=0;D<H.length;D+=2){C=H[D];var T=c[H[D+1]];t.U._applySubs(r,n+C,T,c)}}}}},t.U._glsCovered=function(r,n,i){for(var c=0;c<n.length;c++)if(t._lctf.coverageIndex(n[c],r[i+c])==-1)return!1;return!0},t.U.glyphsToPath=function(r,n,i){for(var c={cmds:[],crds:[]},s=0,l=0;l<n.length;l++){var u=n[l];if(u!=-1){for(var d=l<n.length-1&&n[l+1]!=-1?n[l+1]:0,f=t.U.glyphToPath(r,u),p=0;p<f.crds.length;p+=2)c.crds.push(f.crds[p]+s),c.crds.push(f.crds[p+1]);for(i&&c.cmds.push(i),p=0;p<f.cmds.length;p++)c.cmds.push(f.cmds[p]);i&&c.cmds.push("X"),s+=r.hmtx.aWidth[u],l<n.length-1&&(s+=t.U.getPairAdjustment(r,u,d))}}return c},t.U.P={},t.U.P.moveTo=function(r,n,i){r.cmds.push("M"),r.crds.push(n,i)},t.U.P.lineTo=function(r,n,i){r.cmds.push("L"),r.crds.push(n,i)},t.U.P.curveTo=function(r,n,i,c,s,l,u){r.cmds.push("C"),r.crds.push(n,i,c,s,l,u)},t.U.P.qcurveTo=function(r,n,i,c,s){r.cmds.push("Q"),r.crds.push(n,i,c,s)},t.U.P.closePath=function(r){r.cmds.push("Z")},t.U._drawCFF=function(r,n,i,c,s){for(var l=n.stack,u=n.nStems,d=n.haveWidth,f=n.width,p=n.open,y=0,m=n.x,v=n.y,_=0,w=0,C=0,x=0,A=0,D=0,S=0,P=0,I=0,j=0,H={val:0,size:0};y<r.length;){t.CFF.getCharString(r,y,H);var T=H.val;if(y+=H.size,T=="o1"||T=="o18")l.length%2!=0&&!d&&(f=l.shift()+c.nominalWidthX),u+=l.length>>1,l.length=0,d=!0;else if(T=="o3"||T=="o23")l.length%2!=0&&!d&&(f=l.shift()+c.nominalWidthX),u+=l.length>>1,l.length=0,d=!0;else if(T=="o4")l.length>1&&!d&&(f=l.shift()+c.nominalWidthX,d=!0),p&&t.U.P.closePath(s),v+=l.pop(),t.U.P.moveTo(s,m,v),p=!0;else if(T=="o5")for(;l.length>0;)m+=l.shift(),v+=l.shift(),t.U.P.lineTo(s,m,v);else if(T=="o6"||T=="o7")for(var U=l.length,g=T=="o6",k=0;k<U;k++){var E=l.shift();g?m+=E:v+=E,g=!g,t.U.P.lineTo(s,m,v)}else if(T=="o8"||T=="o24"){U=l.length;for(var B=0;B+6<=U;)_=m+l.shift(),w=v+l.shift(),C=_+l.shift(),x=w+l.shift(),m=C+l.shift(),v=x+l.shift(),t.U.P.curveTo(s,_,w,C,x,m,v),B+=6;T=="o24"&&(m+=l.shift(),v+=l.shift(),t.U.P.lineTo(s,m,v))}else{if(T=="o11")break;if(T=="o1234"||T=="o1235"||T=="o1236"||T=="o1237")T=="o1234"&&(w=v,C=(_=m+l.shift())+l.shift(),j=x=w+l.shift(),D=x,P=v,m=(S=(A=(I=C+l.shift())+l.shift())+l.shift())+l.shift(),t.U.P.curveTo(s,_,w,C,x,I,j),t.U.P.curveTo(s,A,D,S,P,m,v)),T=="o1235"&&(_=m+l.shift(),w=v+l.shift(),C=_+l.shift(),x=w+l.shift(),I=C+l.shift(),j=x+l.shift(),A=I+l.shift(),D=j+l.shift(),S=A+l.shift(),P=D+l.shift(),m=S+l.shift(),v=P+l.shift(),l.shift(),t.U.P.curveTo(s,_,w,C,x,I,j),t.U.P.curveTo(s,A,D,S,P,m,v)),T=="o1236"&&(_=m+l.shift(),w=v+l.shift(),C=_+l.shift(),j=x=w+l.shift(),D=x,S=(A=(I=C+l.shift())+l.shift())+l.shift(),P=D+l.shift(),m=S+l.shift(),t.U.P.curveTo(s,_,w,C,x,I,j),t.U.P.curveTo(s,A,D,S,P,m,v)),T=="o1237"&&(_=m+l.shift(),w=v+l.shift(),C=_+l.shift(),x=w+l.shift(),I=C+l.shift(),j=x+l.shift(),A=I+l.shift(),D=j+l.shift(),S=A+l.shift(),P=D+l.shift(),Math.abs(S-m)>Math.abs(P-v)?m=S+l.shift():v=P+l.shift(),t.U.P.curveTo(s,_,w,C,x,I,j),t.U.P.curveTo(s,A,D,S,P,m,v));else if(T=="o14"){if(l.length>0&&!d&&(f=l.shift()+i.nominalWidthX,d=!0),l.length==4){var G=l.shift(),N=l.shift(),R=l.shift(),b=l.shift(),M=t.CFF.glyphBySE(i,R),O=t.CFF.glyphBySE(i,b);t.U._drawCFF(i.CharStrings[M],n,i,c,s),n.x=G,n.y=N,t.U._drawCFF(i.CharStrings[O],n,i,c,s)}p&&(t.U.P.closePath(s),p=!1)}else if(T=="o19"||T=="o20")l.length%2!=0&&!d&&(f=l.shift()+c.nominalWidthX),u+=l.length>>1,l.length=0,d=!0,y+=u+7>>3;else if(T=="o21")l.length>2&&!d&&(f=l.shift()+c.nominalWidthX,d=!0),v+=l.pop(),m+=l.pop(),p&&t.U.P.closePath(s),t.U.P.moveTo(s,m,v),p=!0;else if(T=="o22")l.length>1&&!d&&(f=l.shift()+c.nominalWidthX,d=!0),m+=l.pop(),p&&t.U.P.closePath(s),t.U.P.moveTo(s,m,v),p=!0;else if(T=="o25"){for(;l.length>6;)m+=l.shift(),v+=l.shift(),t.U.P.lineTo(s,m,v);_=m+l.shift(),w=v+l.shift(),C=_+l.shift(),x=w+l.shift(),m=C+l.shift(),v=x+l.shift(),t.U.P.curveTo(s,_,w,C,x,m,v)}else if(T=="o26")for(l.length%2&&(m+=l.shift());l.length>0;)_=m,w=v+l.shift(),m=C=_+l.shift(),v=(x=w+l.shift())+l.shift(),t.U.P.curveTo(s,_,w,C,x,m,v);else if(T=="o27")for(l.length%2&&(v+=l.shift());l.length>0;)w=v,C=(_=m+l.shift())+l.shift(),x=w+l.shift(),m=C+l.shift(),v=x,t.U.P.curveTo(s,_,w,C,x,m,v);else if(T=="o10"||T=="o29"){var L=T=="o10"?c:i;if(l.length==0)console.debug("error: empty stack");else{var z=l.pop(),$=L.Subrs[z+L.Bias];n.x=m,n.y=v,n.nStems=u,n.haveWidth=d,n.width=f,n.open=p,t.U._drawCFF($,n,i,c,s),m=n.x,v=n.y,u=n.nStems,d=n.haveWidth,f=n.width,p=n.open}}else if(T=="o30"||T=="o31"){var V=l.length,Y=(B=0,T=="o31");for(B+=V-(U=-3&V);B<U;)Y?(w=v,C=(_=m+l.shift())+l.shift(),v=(x=w+l.shift())+l.shift(),U-B==5?(m=C+l.shift(),B++):m=C,Y=!1):(_=m,w=v+l.shift(),C=_+l.shift(),x=w+l.shift(),m=C+l.shift(),U-B==5?(v=x+l.shift(),B++):v=x,Y=!0),t.U.P.curveTo(s,_,w,C,x,m,v),B+=4}else{if((T+"").charAt(0)=="o")throw console.debug("Unknown operation: "+T,r),T;l.push(T)}}}n.x=m,n.y=v,n.nStems=u,n.haveWidth=d,n.width=f,n.open=p};var o=t,a={Typr:o};return e.Typr=o,e.default=a,Object.defineProperty(e,"__esModule",{value:!0}),e})({}).Typr}function Y0(){return(function(e){var t=Uint8Array,o=Uint16Array,a=Uint32Array,r=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),n=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),i=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(T,U){for(var g=new o(31),k=0;k<31;++k)g[k]=U+=1<<T[k-1];var E=new a(g[30]);for(k=1;k<30;++k)for(var B=g[k];B<g[k+1];++B)E[B]=B-g[k]<<5|k;return[g,E]},s=c(r,2),l=s[0],u=s[1];l[28]=258,u[258]=28;for(var d=c(n,0)[0],f=new o(32768),p=0;p<32768;++p){var y=(43690&p)>>>1|(21845&p)<<1;y=(61680&(y=(52428&y)>>>2|(13107&y)<<2))>>>4|(3855&y)<<4,f[p]=((65280&y)>>>8|(255&y)<<8)>>>1}var m=function(T,U,g){for(var k=T.length,E=0,B=new o(U);E<k;++E)++B[T[E]-1];var G,N=new o(U);for(E=0;E<U;++E)N[E]=N[E-1]+B[E-1]<<1;{G=new o(1<<U);var R=15-U;for(E=0;E<k;++E)if(T[E])for(var b=E<<4|T[E],M=U-T[E],O=N[T[E]-1]++<<M,L=O|(1<<M)-1;O<=L;++O)G[f[O]>>>R]=b}return G},v=new t(288);for(p=0;p<144;++p)v[p]=8;for(p=144;p<256;++p)v[p]=9;for(p=256;p<280;++p)v[p]=7;for(p=280;p<288;++p)v[p]=8;var _=new t(32);for(p=0;p<32;++p)_[p]=5;var w=m(v,9),C=m(_,5),x=function(T){for(var U=T[0],g=1;g<T.length;++g)T[g]>U&&(U=T[g]);return U},A=function(T,U,g){var k=U/8|0;return(T[k]|T[k+1]<<8)>>(7&U)&g},D=function(T,U){var g=U/8|0;return(T[g]|T[g+1]<<8|T[g+2]<<16)>>(7&U)},S=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],P=function(T,U,g){var k=new Error(U||S[T]);if(k.code=T,Error.captureStackTrace&&Error.captureStackTrace(k,P),!g)throw k;return k},I=function(T,U,g){var k=T.length;if(!k||g&&!g.l&&k<5)return U||new t(0);var E=!U||g,B=!g||g.i;g||(g={}),U||(U=new t(3*k));var G,N=function(de){var Ae=U.length;if(de>Ae){var Me=new t(Math.max(2*Ae,de));Me.set(U),U=Me}},R=g.f||0,b=g.p||0,M=g.b||0,O=g.l,L=g.d,z=g.m,$=g.n,V=8*k;do{if(!O){g.f=R=A(T,b,1);var Y=A(T,b+1,3);if(b+=3,!Y){var Z=T[(ae=((G=b)/8|0)+(7&G&&1)+4)-4]|T[ae-3]<<8,Q=ae+Z;if(Q>k){B&&P(0);break}E&&N(M+Z),U.set(T.subarray(ae,Q),M),g.b=M+=Z,g.p=b=8*Q;continue}if(Y==1)O=w,L=C,z=9,$=5;else if(Y==2){var J=A(T,b,31)+257,q=A(T,b+10,15)+4,ge=J+A(T,b+5,31)+1;b+=14;for(var se=new t(ge),ee=new t(19),oe=0;oe<q;++oe)ee[i[oe]]=A(T,b+3*oe,7);b+=3*q;var te=x(ee),W=(1<<te)-1,re=m(ee,te);for(oe=0;oe<ge;){var ae,K=re[A(T,b,W)];if(b+=15&K,(ae=K>>>4)<16)se[oe++]=ae;else{var ye=0,ie=0;for(ae==16?(ie=3+A(T,b,3),b+=2,ye=se[oe-1]):ae==17?(ie=3+A(T,b,7),b+=3):ae==18&&(ie=11+A(T,b,127),b+=7);ie--;)se[oe++]=ye}}var ce=se.subarray(0,J),ne=se.subarray(J);z=x(ce),$=x(ne),O=m(ce,z),L=m(ne,$)}else P(1);if(b>V){B&&P(0);break}}E&&N(M+131072);for(var Se=(1<<z)-1,le=(1<<$)-1,ue=b;;ue=b){var fe=(ye=O[D(T,b)&Se])>>>4;if((b+=15&ye)>V){B&&P(0);break}if(ye||P(2),fe<256)U[M++]=fe;else{if(fe==256){ue=b,O=null;break}var ve=fe-254;if(fe>264){var be=r[oe=fe-257];ve=A(T,b,(1<<be)-1)+l[oe],b+=be}var ke=L[D(T,b)&le],xe=ke>>>4;if(ke||P(3),b+=15&ke,ne=d[xe],xe>3&&(be=n[xe],ne+=D(T,b)&(1<<be)-1,b+=be),b>V){B&&P(0);break}E&&N(M+131072);for(var _e=M+ve;M<_e;M+=4)U[M]=U[M-ne],U[M+1]=U[M+1-ne],U[M+2]=U[M+2-ne],U[M+3]=U[M+3-ne];M=_e}}g.l=O,g.p=ue,g.b=M,O&&(R=1,g.m=z,g.d=L,g.n=$)}while(!R);return M==U.length?U:(function(de,Ae,Me){(Me==null||Me>de.length)&&(Me=de.length);var Le=new(de instanceof o?o:de instanceof a?a:t)(Me-Ae);return Le.set(de.subarray(Ae,Me)),Le})(U,0,M)},j=new t(0),H=typeof TextDecoder<"u"&&new TextDecoder;try{H.decode(j,{stream:!0})}catch{}return e.convert_streams=function(T){var U=new DataView(T),g=0;function k(){var J=U.getUint16(g);return g+=2,J}function E(){var J=U.getUint32(g);return g+=4,J}function B(J){Z.setUint16(Q,J),Q+=2}function G(J){Z.setUint32(Q,J),Q+=4}for(var N={signature:E(),flavor:E(),length:E(),numTables:k(),reserved:k(),totalSfntSize:E(),majorVersion:k(),minorVersion:k(),metaOffset:E(),metaLength:E(),metaOrigLength:E(),privOffset:E(),privLength:E()},R=0;Math.pow(2,R)<=N.numTables;)R++;R--;for(var b=16*Math.pow(2,R),M=16*N.numTables-b,O=12,L=[],z=0;z<N.numTables;z++)L.push({tag:E(),offset:E(),compLength:E(),origLength:E(),origChecksum:E()}),O+=16;var $,V=new Uint8Array(12+16*L.length+L.reduce((function(J,q){return J+q.origLength+4}),0)),Y=V.buffer,Z=new DataView(Y),Q=0;return G(N.flavor),B(N.numTables),B(b),B(R),B(M),L.forEach((function(J){G(J.tag),G(J.origChecksum),G(O),G(J.origLength),J.outOffset=O,(O+=J.origLength)%4!=0&&(O+=4-O%4)})),L.forEach((function(J){var q,ge=T.slice(J.offset,J.offset+J.compLength);if(J.compLength!=J.origLength){var se=new Uint8Array(J.origLength);q=new Uint8Array(ge,2),I(q,se)}else se=new Uint8Array(ge);V.set(se,J.outOffset);var ee=0;(O=J.outOffset+J.origLength)%4!=0&&(ee=4-O%4),V.set(new Uint8Array(ee).buffer,J.outOffset+J.origLength),$=O+ee})),Y.slice(0,$)},Object.defineProperty(e,"__esModule",{value:!0}),e})({}).convert_streams}function q0(e,t){const o={M:2,L:2,Q:4,C:6,Z:0},a={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,n=2,i=4,c=8,s=16,l=32;let u;function d(S){if(!u){const P={R:n,L:r,D:i,C:s,U:l,T:c};u=new Map;for(let I in a){let j=0;a[I].split(",").forEach(H=>{let[T,U]=H.split("+");T=parseInt(T,36),U=U?parseInt(U,36):0,u.set(j+=T,P[I]);for(let g=U;g--;)u.set(++j,P[I])})}}return u.get(S)||l}const f=1,p=2,y=3,m=4,v=[null,"isol","init","fina","medi"];function _(S){const P=new Uint8Array(S.length);let I=l,j=f,H=-1;for(let T=0;T<S.length;T++){const U=S.codePointAt(T);let g=d(U)|0,k=f;g&c||(I&(r|i|s)?g&(n|i|s)?(k=y,(j===f||j===y)&&P[H]++):g&(r|l)&&(j===p||j===m)&&P[H]--:I&(n|l)&&(j===p||j===m)&&P[H]--,j=P[T]=k,I=g,H=T,U>65535&&T++)}return P}function w(S,P){const I=[];for(let H=0;H<P.length;H++){const T=P.codePointAt(H);T>65535&&H++,I.push(e.U.codeToGlyph(S,T))}const j=S.GSUB;if(j){const{lookupList:H,featureList:T}=j;let U;const g=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,k=[];T.forEach(E=>{if(g.test(E.tag))for(let B=0;B<E.tab.length;B++){if(k[E.tab[B]])continue;k[E.tab[B]]=!0;const G=H[E.tab[B]],N=/^(isol|init|fina|medi)$/.test(E.tag);N&&!U&&(U=_(P));for(let R=0;R<I.length;R++)(!U||!N||v[U[R]]===E.tag)&&e.U._applySubs(I,R,G,H)}})}return I}function C(S,P){const I=new Int16Array(P.length*3);let j=0;for(;j<P.length;j++){const g=P[j];if(g===-1)continue;I[j*3+2]=S.hmtx.aWidth[g];const k=S.GPOS;if(k){const E=k.lookupList;for(let B=0;B<E.length;B++){const G=E[B];for(let N=0;N<G.tabs.length;N++){const R=G.tabs[N];if(G.ltype===1){if(e._lctf.coverageIndex(R.coverage,g)!==-1&&R.pos){U(R.pos,j);break}}else if(G.ltype===2){let b=null,M=H();if(M!==-1){const O=e._lctf.coverageIndex(R.coverage,P[M]);if(O!==-1){if(R.fmt===1){const L=R.pairsets[O];for(let z=0;z<L.length;z++)L[z].gid2===g&&(b=L[z])}else if(R.fmt===2){const L=e.U._getGlyphClass(P[M],R.classDef1),z=e.U._getGlyphClass(g,R.classDef2);b=R.matrix[L][z]}if(b){b.val1&&U(b.val1,M),b.val2&&U(b.val2,j);break}}}}else if(G.ltype===4){const b=e._lctf.coverageIndex(R.markCoverage,g);if(b!==-1){const M=H(T),O=M===-1?-1:e._lctf.coverageIndex(R.baseCoverage,P[M]);if(O!==-1){const L=R.markArray[b],z=R.baseArray[O][L.markClass];I[j*3]=z.x-L.x+I[M*3]-I[M*3+2],I[j*3+1]=z.y-L.y+I[M*3+1];break}}}else if(G.ltype===6){const b=e._lctf.coverageIndex(R.mark1Coverage,g);if(b!==-1){const M=H();if(M!==-1){const O=P[M];if(x(S,O)===3){const L=e._lctf.coverageIndex(R.mark2Coverage,O);if(L!==-1){const z=R.mark1Array[b],$=R.mark2Array[L][z.markClass];I[j*3]=$.x-z.x+I[M*3]-I[M*3+2],I[j*3+1]=$.y-z.y+I[M*3+1];break}}}}}}}}else if(S.kern&&!S.cff){const E=H();if(E!==-1){const B=S.kern.glyph1.indexOf(P[E]);if(B!==-1){const G=S.kern.rval[B].glyph2.indexOf(g);G!==-1&&(I[E*3+2]+=S.kern.rval[B].vals[G])}}}}return I;function H(g){for(let k=j-1;k>=0;k--)if(P[k]!==-1&&(!g||g(P[k])))return k;return-1}function T(g){return x(S,g)===1}function U(g,k){for(let E=0;E<3;E++)I[k*3+E]+=g[E]||0}}function x(S,P){const I=S.GDEF&&S.GDEF.glyphClassDef;return I?e.U._getGlyphClass(P,I):0}function A(...S){for(let P=0;P<S.length;P++)if(typeof S[P]=="number")return S[P]}function D(S){const P=Object.create(null),I=S["OS/2"],j=S.hhea,H=S.head.unitsPerEm,T=A(I&&I.sTypoAscender,j&&j.ascender,H),U={unitsPerEm:H,ascender:T,descender:A(I&&I.sTypoDescender,j&&j.descender,0),capHeight:A(I&&I.sCapHeight,T),xHeight:A(I&&I.sxHeight,T),lineGap:A(I&&I.sTypoLineGap,j&&j.lineGap),supportsCodePoint(g){return e.U.codeToGlyph(S,g)>0},forEachGlyph(g,k,E,B){let G=0;const N=1/U.unitsPerEm*k,R=w(S,g);let b=0;const M=C(S,R);return R.forEach((O,L)=>{if(O!==-1){let z=P[O];if(!z){const{cmds:$,crds:V}=e.U.glyphToPath(S,O);let Y="",Z=0;for(let se=0,ee=$.length;se<ee;se++){const oe=o[$[se]];Y+=$[se];for(let te=1;te<=oe;te++)Y+=(te>1?",":"")+V[Z++]}let Q,J,q,ge;if(V.length){Q=J=1/0,q=ge=-1/0;for(let se=0,ee=V.length;se<ee;se+=2){let oe=V[se],te=V[se+1];oe<Q&&(Q=oe),te<J&&(J=te),oe>q&&(q=oe),te>ge&&(ge=te)}}else Q=q=J=ge=0;z=P[O]={index:O,advanceWidth:S.hmtx.aWidth[O],xMin:Q,yMin:J,xMax:q,yMax:ge,path:Y}}B.call(null,z,G+M[L*3]*N,M[L*3+1]*N,b),G+=M[L*3+2]*N,E&&(G+=E*k)}b+=g.codePointAt(b)>65535?2:1}),G}};return U}return function(P){const I=new Uint8Array(P,0,4),j=e._bin.readASCII(I,0,4);if(j==="wOFF")P=t(P);else if(j==="wOF2")throw new Error("woff2 fonts not supported");return D(e.parse(P)[0])}}const K0=pn({name:"Typr Font Parser",dependencies:[X0,Y0,q0],init(e,t,o){const a=e(),r=t();return o(a,r)}});function Z0(){return(function(e){var t=function(){this.buckets=new Map};t.prototype.add=function(C){var x=C>>5;this.buckets.set(x,(this.buckets.get(x)||0)|1<<(31&C))},t.prototype.has=function(C){var x=this.buckets.get(C>>5);return x!==void 0&&(x&1<<(31&C))!=0},t.prototype.serialize=function(){var C=[];return this.buckets.forEach((function(x,A){C.push((+A).toString(36)+":"+x.toString(36))})),C.join(",")},t.prototype.deserialize=function(C){var x=this;this.buckets.clear(),C.split(",").forEach((function(A){var D=A.split(":");x.buckets.set(parseInt(D[0],36),parseInt(D[1],36))}))};var o=Math.pow(2,8),a=o-1,r=~a;function n(C){var x=(function(D){return D&r})(C).toString(16),A=(function(D){return(D&r)+o-1})(C).toString(16);return"codepoint-index/plane"+(C>>16)+"/"+x+"-"+A+".json"}function i(C,x){var A=C&a,D=x.codePointAt(A/6|0);return((D=(D||48)-48)&1<<A%6)!=0}function c(C,x){var A;(A=C,A.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(D){return D.split("-").map((function(S){return parseInt(S.trim(),16)}))}))).forEach((function(D){var S=D[0],P=D[1];P===void 0&&(P=S),x(S,P)}))}function s(C,x){c(C,(function(A,D){for(var S=A;S<=D;S++)x(S)}))}var l={},u={},d=new WeakMap,f="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function p(C){var x=d.get(C);return x||(x=new t,s(C.ranges,(function(A){return x.add(A)})),d.set(C,x)),x}var y,m=new Map;function v(C,x,A){return C[x]?x:C[A]?A:(function(D){for(var S in D)return S})(C)}function _(C,x){var A=x;if(!C.includes(A)){A=1/0;for(var D=0;D<C.length;D++)Math.abs(C[D]-x)<Math.abs(A-x)&&(A=C[D])}return A}function w(C){return y||(y=new Set,s("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(x){y.add(x)}))),y.has(C)}return e.CodePointSet=t,e.clearCache=function(){l={},u={}},e.getFontsForString=function(C,x){x===void 0&&(x={});var A,D=x.lang;D===void 0&&(D=new RegExp("\\p{Script=Hangul}","u").test(A=C)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(A)?"ja":"en");var S=x.category;S===void 0&&(S="sans-serif");var P=x.style;P===void 0&&(P="normal");var I=x.weight;I===void 0&&(I=400);var j=(x.dataUrl||f).replace(/\/$/g,""),H=new Map,T=new Uint8Array(C.length),U={},g={},k=new Array(C.length),E=new Map,B=!1;function G(b){var M=m.get(b);return M||(M=fetch(j+"/"+b).then((function(O){if(!O.ok)throw new Error(O.statusText);return O.json().then((function(L){if(!Array.isArray(L)||L[0]!==1)throw new Error("Incorrect schema version; need 1, got "+L[0]);return L[1]}))})).catch((function(O){if(j!==f)return B||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+j+'", trying default CDN. '+O.message),B=!0),j=f,m.delete(b),G(b);throw O})),m.set(b,M)),M}for(var N=function(b){var M=C.codePointAt(b),O=n(M);k[b]=O,l[O]||E.has(O)||E.set(O,G(O).then((function(L){l[O]=L}))),M>65535&&(b++,R=b)},R=0;R<C.length;R++)N(R);return Promise.all(E.values()).then((function(){E.clear();for(var b=function(O){var L=C.codePointAt(O),z=null,$=l[k[O]],V=void 0;for(var Y in $){var Z=g[Y];if(Z===void 0&&(Z=g[Y]=new RegExp(Y).test(D||"en")),Z){for(var Q in V=Y,$[Y])if(i(L,$[Y][Q])){z=Q;break}break}}if(!z){e:for(var J in $)if(J!==V){for(var q in $[J])if(i(L,$[J][q])){z=q;break e}}}z||(console.debug("No font coverage for U+"+L.toString(16)),z="latin"),k[O]=z,u[z]||E.has(z)||E.set(z,G("font-meta/"+z+".json").then((function(ge){u[z]=ge}))),L>65535&&(O++,M=O)},M=0;M<C.length;M++)b(M);return Promise.all(E.values())})).then((function(){for(var b,M=null,O=0;O<C.length;O++){var L=C.codePointAt(O);if(M&&(w(L)||p(M).has(L)))T[O]=T[O-1];else{M=u[k[O]];var z=U[M.id];if(!z){var $=M.typeforms,V=v($,S,"sans-serif"),Y=v($[V],P,"normal"),Z=_((b=$[V])===null||b===void 0?void 0:b[Y],I);z=U[M.id]=j+"/font-files/"+M.id+"/"+V+"."+Y+"."+Z+".woff"}var Q=H.get(z);Q==null&&(Q=H.size,H.set(z,Q)),T[O]=Q}L>65535&&(O++,T[O]=T[O-1])}return{fontUrls:Array.from(H.keys()),chars:T}}))},Object.defineProperty(e,"__esModule",{value:!0}),e})({})}function J0(e,t){const o=Object.create(null),a=Object.create(null);function r(i,c){const s=l=>{console.error(`Failure loading font ${i}`,l)};try{const l=new XMLHttpRequest;l.open("get",i,!0),l.responseType="arraybuffer",l.onload=function(){if(l.status>=400)s(new Error(l.statusText));else if(l.status>0)try{const u=e(l.response);u.src=i,c(u)}catch(u){s(u)}},l.onerror=s,l.send()}catch(l){s(l)}}function n(i,c){let s=o[i];s?c(s):a[i]?a[i].push(c):(a[i]=[c],r(i,l=>{l.src=i,o[i]=l,a[i].forEach(u=>u(l)),delete a[i]}))}return function(i,c,{lang:s,fonts:l=[],style:u="normal",weight:d="normal",unicodeFontsURL:f}={}){const p=new Uint8Array(i.length),y=[];i.length||w();const m=new Map,v=[];if(u!=="italic"&&(u="normal"),typeof d!="number"&&(d=d==="bold"?700:400),l&&!Array.isArray(l)&&(l=[l]),l=l.slice().filter(x=>!x.lang||x.lang.test(s)).reverse(),l.length){let S=0;(function P(I=0){for(let j=I,H=i.length;j<H;j++){const T=i.codePointAt(j);if(S===1&&y[p[j-1]].supportsCodePoint(T)||j>0&&/\s/.test(i[j]))p[j]=p[j-1],S===2&&(v[v.length-1][1]=j);else for(let U=p[j],g=l.length;U<=g;U++)if(U===g){const k=S===2?v[v.length-1]:v[v.length]=[j,j];k[1]=j,S=2}else{p[j]=U;const{src:k,unicodeRange:E}=l[U];if(!E||C(T,E)){const B=o[k];if(!B){n(k,()=>{P(j)});return}if(B.supportsCodePoint(T)){let G=m.get(B);typeof G!="number"&&(G=y.length,y.push(B),m.set(B,G)),p[j]=G,S=1;break}}}T>65535&&j+1<H&&(p[j+1]=p[j],j++,S===2&&(v[v.length-1][1]=j))}_()})()}else v.push([0,i.length-1]),_();function _(){if(v.length){const x=v.map(A=>i.substring(A[0],A[1]+1)).join(`
`);t.getFontsForString(x,{lang:s||void 0,style:u,weight:d,dataUrl:f}).then(({fontUrls:A,chars:D})=>{const S=y.length;let P=0;v.forEach(j=>{for(let H=0,T=j[1]-j[0];H<=T;H++)p[j[0]+H]=D[P++]+S;P++});let I=0;A.forEach((j,H)=>{n(j,T=>{y[H+S]=T,++I===A.length&&w()})})})}else w()}function w(){c({chars:p,fonts:y})}function C(x,A){for(let D=0;D<A.length;D++){const[S,P=S]=A[D];if(S<=x&&x<=P)return!0}return!1}}}const Q0=pn({name:"FontResolver",dependencies:[J0,K0,Z0],init(e,t,o){return e(t,o())}});function eg(e,t){const a=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",n=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function i({text:y,lang:m,fonts:v,style:_,weight:w,preResolvedFonts:C,unicodeFontsURL:x},A){const D=({chars:S,fonts:P})=>{let I,j;const H=[];for(let T=0;T<S.length;T++)S[T]!==j?(j=S[T],H.push(I={start:T,end:T,fontObj:P[S[T]]})):I.end=T;A(H)};C?D(C):e(y,D,{lang:m,fonts:v,style:_,weight:w,unicodeFontsURL:x})}function c({text:y="",font:m,lang:v,sdfGlyphSize:_=64,fontSize:w=400,fontWeight:C=1,fontStyle:x="normal",letterSpacing:A=0,lineHeight:D="normal",maxWidth:S=1/0,direction:P,textAlign:I="left",textIndent:j=0,whiteSpace:H="normal",overflowWrap:T="normal",anchorX:U=0,anchorY:g=0,metricsOnly:k=!1,unicodeFontsURL:E,preResolvedFonts:B=null,includeCaretPositions:G=!1,chunkedBoundsSize:N=8192,colorRanges:R=null},b){const M=d(),O={fontLoad:0,typesetting:0};y.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),y=y.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),w=+w,A=+A,S=+S,D=D||"normal",j=+j,i({text:y,lang:v,style:x,weight:C,fonts:typeof m=="string"?[{src:m}]:m,unicodeFontsURL:E,preResolvedFonts:B},L=>{O.fontLoad=d()-M;const z=isFinite(S);let $=null,V=null,Y=null,Z=null,Q=null,J=null,q=null,ge=null,se=0,ee=0,oe=H!=="nowrap";const te=new Map,W=d();let re=j,ae=0,K=new f;const ye=[K];L.forEach(le=>{const{fontObj:ue}=le,{ascender:fe,descender:ve,unitsPerEm:be,lineGap:ke,capHeight:xe,xHeight:_e}=ue;let de=te.get(ue);if(!de){const me=w/be,Te=D==="normal"?(fe-ve+ke)*me:D*w,tt=(Te-(fe-ve)*me)/2,Ne=Math.min(Te,(fe-ve)*me),Ce=(fe+ve)/2*me+Ne/2;de={index:te.size,src:ue.src,fontObj:ue,fontSizeMult:me,unitsPerEm:be,ascender:fe*me,descender:ve*me,capHeight:xe*me,xHeight:_e*me,lineHeight:Te,baseline:-tt-fe*me,caretTop:Ce,caretBottom:Ce-Ne},te.set(ue,de)}const{fontSizeMult:Ae}=de,Me=y.slice(le.start,le.end+1);let Le,Pe;ue.forEachGlyph(Me,w,A,(me,Te,tt,Ne)=>{Te+=ae,Ne+=le.start,Le=Te,Pe=me;const Ce=y.charAt(Ne),Ue=me.advanceWidth*Ae,De=K.count;let we;if("isEmpty"in me||(me.isWhitespace=!!Ce&&new RegExp(r).test(Ce),me.canBreakAfter=!!Ce&&n.test(Ce),me.isEmpty=me.xMin===me.xMax||me.yMin===me.yMax||a.test(Ce)),!me.isWhitespace&&!me.isEmpty&&ee++,oe&&z&&!me.isWhitespace&&Te+Ue+re>S&&De){if(K.glyphAt(De-1).glyphObj.canBreakAfter)we=new f,re=-Te;else for(let Ge=De;Ge--;)if(Ge===0&&T==="break-word"){we=new f,re=-Te;break}else if(K.glyphAt(Ge).glyphObj.canBreakAfter){we=K.splitAt(Ge+1);const ze=we.glyphAt(0).x;re-=ze;for(let Fe=we.count;Fe--;)we.glyphAt(Fe).x-=ze;break}we&&(K.isSoftWrapped=!0,K=we,ye.push(K),se=S)}let Re=K.glyphAt(K.count);Re.glyphObj=me,Re.x=Te+re,Re.y=tt,Re.width=Ue,Re.charIndex=Ne,Re.fontData=de,Ce===`
`&&(K=new f,ye.push(K),re=-(Te+Ue+A*w)+j)}),ae=Le+Pe.advanceWidth*Ae+A*w});let ie=0;ye.forEach(le=>{let ue=!0;for(let fe=le.count;fe--;){const ve=le.glyphAt(fe);ue&&!ve.glyphObj.isWhitespace&&(le.width=ve.x+ve.width,le.width>se&&(se=le.width),ue=!1);let{lineHeight:be,capHeight:ke,xHeight:xe,baseline:_e}=ve.fontData;be>le.lineHeight&&(le.lineHeight=be);const de=_e-le.baseline;de<0&&(le.baseline+=de,le.cap+=de,le.ex+=de),le.cap=Math.max(le.cap,le.baseline+ke),le.ex=Math.max(le.ex,le.baseline+xe)}le.baseline-=ie,le.cap-=ie,le.ex-=ie,ie+=le.lineHeight});let ce=0,ne=0;if(U&&(typeof U=="number"?ce=-U:typeof U=="string"&&(ce=-se*(U==="left"?0:U==="center"?.5:U==="right"?1:l(U)))),g&&(typeof g=="number"?ne=-g:typeof g=="string"&&(ne=g==="top"?0:g==="top-baseline"?-ye[0].baseline:g==="top-cap"?-ye[0].cap:g==="top-ex"?-ye[0].ex:g==="middle"?ie/2:g==="bottom"?ie:g==="bottom-baseline"?-ye[ye.length-1].baseline:l(g)*ie)),!k){const le=t.getEmbeddingLevels(y,P);$=new Uint16Array(ee),V=new Uint8Array(ee),Y=new Float32Array(ee*2),Z={},q=[1/0,1/0,-1/0,-1/0],ge=[],G&&(J=new Float32Array(y.length*4)),R&&(Q=new Uint8Array(ee*3));let ue=0,fe=-1,ve=-1,be,ke;if(ye.forEach((xe,_e)=>{let{count:de,width:Ae}=xe;if(de>0){let Me=0;for(let Ne=de;Ne--&&xe.glyphAt(Ne).glyphObj.isWhitespace;)Me++;let Le=0,Pe=0;if(I==="center")Le=(se-Ae)/2;else if(I==="right")Le=se-Ae;else if(I==="justify"&&xe.isSoftWrapped){let Ne=0;for(let Ce=de-Me;Ce--;)xe.glyphAt(Ce).glyphObj.isWhitespace&&Ne++;Pe=(se-Ae)/Ne}if(Pe||Le){let Ne=0;for(let Ce=0;Ce<de;Ce++){let Ue=xe.glyphAt(Ce);const De=Ue.glyphObj;Ue.x+=Le+Ne,Pe!==0&&De.isWhitespace&&Ce<de-Me&&(Ne+=Pe,Ue.width+=Pe)}}const me=t.getReorderSegments(y,le,xe.glyphAt(0).charIndex,xe.glyphAt(xe.count-1).charIndex);for(let Ne=0;Ne<me.length;Ne++){const[Ce,Ue]=me[Ne];let De=1/0,we=-1/0;for(let Re=0;Re<de;Re++)if(xe.glyphAt(Re).charIndex>=Ce){let Ge=Re,ze=Re;for(;ze<de;ze++){let Fe=xe.glyphAt(ze);if(Fe.charIndex>Ue)break;ze<de-Me&&(De=Math.min(De,Fe.x),we=Math.max(we,Fe.x+Fe.width))}for(let Fe=Ge;Fe<ze;Fe++){const qe=xe.glyphAt(Fe);qe.x=we-(qe.x+qe.width-De)}break}}let Te;const tt=Ne=>Te=Ne;for(let Ne=0;Ne<de;Ne++){const Ce=xe.glyphAt(Ne);Te=Ce.glyphObj;const Ue=Te.index,De=le.levels[Ce.charIndex]&1;if(De){const we=t.getMirroredCharacter(y[Ce.charIndex]);we&&Ce.fontData.fontObj.forEachGlyph(we,0,0,tt)}if(G){const{charIndex:we,fontData:Re}=Ce,Ge=Ce.x+ce,ze=Ce.x+Ce.width+ce;J[we*4]=De?ze:Ge,J[we*4+1]=De?Ge:ze,J[we*4+2]=xe.baseline+Re.caretBottom+ne,J[we*4+3]=xe.baseline+Re.caretTop+ne;const Fe=we-fe;Fe>1&&u(J,fe,Fe),fe=we}if(R){const{charIndex:we}=Ce;for(;we>ve;)ve++,R.hasOwnProperty(ve)&&(ke=R[ve])}if(!Te.isWhitespace&&!Te.isEmpty){const we=ue++,{fontSizeMult:Re,src:Ge,index:ze}=Ce.fontData,Fe=Z[Ge]||(Z[Ge]={});Fe[Ue]||(Fe[Ue]={path:Te.path,pathBounds:[Te.xMin,Te.yMin,Te.xMax,Te.yMax]});const qe=Ce.x+ce,ut=Ce.y+xe.baseline+ne;Y[we*2]=qe,Y[we*2+1]=ut;const nt=qe+Te.xMin*Re,dt=ut+Te.yMin*Re,gt=qe+Te.xMax*Re,rt=ut+Te.yMax*Re;nt<q[0]&&(q[0]=nt),dt<q[1]&&(q[1]=dt),gt>q[2]&&(q[2]=gt),rt>q[3]&&(q[3]=rt),we%N===0&&(be={start:we,end:we,rect:[1/0,1/0,-1/0,-1/0]},ge.push(be)),be.end++;const He=be.rect;if(nt<He[0]&&(He[0]=nt),dt<He[1]&&(He[1]=dt),gt>He[2]&&(He[2]=gt),rt>He[3]&&(He[3]=rt),$[we]=Ue,V[we]=ze,R){const mt=we*3;Q[mt]=ke>>16&255,Q[mt+1]=ke>>8&255,Q[mt+2]=ke&255}}}}}),J){const xe=y.length-fe;xe>1&&u(J,fe,xe)}}const Se=[];te.forEach(({index:le,src:ue,unitsPerEm:fe,ascender:ve,descender:be,lineHeight:ke,capHeight:xe,xHeight:_e})=>{Se[le]={src:ue,unitsPerEm:fe,ascender:ve,descender:be,lineHeight:ke,capHeight:xe,xHeight:_e}}),O.typesetting=d()-W,b({glyphIds:$,glyphFontIndices:V,glyphPositions:Y,glyphData:Z,fontData:Se,caretPositions:J,glyphColors:Q,chunkedBounds:ge,fontSize:w,topBaseline:ne+ye[0].baseline,blockBounds:[ce,ne-ie,ce+se,ne],visibleBounds:q,timings:O})})}function s(y,m){c({...y,metricsOnly:!0},v=>{const[_,w,C,x]=v.blockBounds;m({width:C-_,height:x-w})})}function l(y){let m=y.match(/^([\d.]+)%$/),v=m?parseFloat(m[1]):NaN;return isNaN(v)?0:v/100}function u(y,m,v){const _=y[m*4],w=y[m*4+1],C=y[m*4+2],x=y[m*4+3],A=(w-_)/v;for(let D=0;D<v;D++){const S=(m+D)*4;y[S]=_+A*D,y[S+1]=_+A*(D+1),y[S+2]=C,y[S+3]=x}}function d(){return(self.performance||Date).now()}function f(){this.data=[]}const p=["glyphObj","x","y","width","charIndex","fontData"];return f.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/p.length)},glyphAt(y){let m=f.flyweight;return m.data=this.data,m.index=y,m},splitAt(y){let m=new f;return m.data=this.data.splice(y*p.length),m}},f.flyweight=p.reduce((y,m,v,_)=>(Object.defineProperty(y,m,{get(){return this.data[this.index*p.length+v]},set(w){this.data[this.index*p.length+v]=w}}),y),{data:null,index:0}),{typeset:c,measure:s}}const Lt=()=>(self.performance||Date).now(),$r=Cc();let Fa;function tg(e,t,o,a,r,n,i,c,s,l,u=!0){return u?rg(e,t,o,a,r,n,i,c,s,l).then(null,d=>(Fa||(console.warn("WebGL SDF generation failed, falling back to JS",d),Fa=!0),La(e,t,o,a,r,n,i,c,s,l))):La(e,t,o,a,r,n,i,c,s,l)}const Ar=[],ng=5;let Wo=0;function Nc(){const e=Lt();for(;Ar.length&&Lt()-e<ng;)Ar.shift()();Wo=Ar.length?setTimeout(Nc,0):0}const rg=(...e)=>new Promise((t,o)=>{Ar.push(()=>{const a=Lt();try{$r.webgl.generateIntoCanvas(...e),t({timing:Lt()-a})}catch(r){o(r)}}),Wo||(Wo=setTimeout(Nc,0))}),og=4,ig=2e3,Oa={};let ag=0;function La(e,t,o,a,r,n,i,c,s,l){const u="TroikaTextSDFGenerator_JS_"+ag++%og;let d=Oa[u];return d||(d=Oa[u]={workerModule:pn({name:u,workerId:u,dependencies:[Cc,Lt],init(f,p){const y=f().javascript.generate;return function(...m){const v=p();return{textureData:y(...m),timing:p()-v}}},getTransferables(f){return[f.textureData.buffer]}}),requests:0,idleTimer:null}),d.requests++,clearTimeout(d.idleTimer),d.workerModule(e,t,o,a,r,n).then(({textureData:f,timing:p})=>{const y=Lt(),m=new Uint8Array(f.length*4);for(let v=0;v<f.length;v++)m[v*4+l]=f[v];return $r.webglUtils.renderImageData(i,m,c,s,e,t,1<<3-l),p+=Lt()-y,--d.requests===0&&(d.idleTimer=setTimeout(()=>{F0(u)},ig)),{timing:p}})}function sg(e){e._warm||($r.webgl.isSupported(e),e._warm=!0)}const cg=$r.webglUtils.resizeWebGLCanvasWithoutClearing,Bn={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},lg=new fn;function rn(){return(self.performance||Date).now()}const za=Object.create(null);function kc(e,t){e=fg({},e);const o=rn(),a=[];if(e.font&&a.push({label:"user",src:hg(e.font)}),e.font=a,e.text=""+e.text,e.sdfGlyphSize=e.sdfGlyphSize||Bn.sdfGlyphSize,e.unicodeFontsURL=e.unicodeFontsURL||Bn.unicodeFontsURL,e.colorRanges!=null){let f={};for(let p in e.colorRanges)if(e.colorRanges.hasOwnProperty(p)){let y=e.colorRanges[p];typeof y!="number"&&(y=lg.set(y).getHex()),f[p]=y}e.colorRanges=f}Object.freeze(e);const{textureWidth:r,sdfExponent:n}=Bn,{sdfGlyphSize:i}=e,c=r/i*4;let s=za[i];if(!s){const f=document.createElement("canvas");f.width=r,f.height=i*256/c,s=za[i]={glyphCount:0,sdfGlyphSize:i,sdfCanvas:f,sdfTexture:new Kc(f,void 0,void 0,void 0,Di,Di),contextLost:!1,glyphsByFont:new Map},s.sdfTexture.generateMipmaps=!1,ug(s)}const{sdfTexture:l,sdfCanvas:u}=s;Mc(e).then(f=>{const{glyphIds:p,glyphFontIndices:y,fontData:m,glyphPositions:v,fontSize:_,timings:w}=f,C=[],x=new Float32Array(p.length*4);let A=0,D=0;const S=rn(),P=m.map(U=>{let g=s.glyphsByFont.get(U.src);return g||s.glyphsByFont.set(U.src,g=new Map),g});p.forEach((U,g)=>{const k=y[g],{src:E,unitsPerEm:B}=m[k];let G=P[k].get(U);if(!G){const{path:O,pathBounds:L}=f.glyphData[E][U],z=Math.max(L[2]-L[0],L[3]-L[1])/i*(Bn.sdfMargin*i+.5),$=s.glyphCount++,V=[L[0]-z,L[1]-z,L[2]+z,L[3]+z];P[k].set(U,G={path:O,atlasIndex:$,sdfViewBox:V}),C.push(G)}const{sdfViewBox:N}=G,R=v[D++],b=v[D++],M=_/B;x[A++]=R+N[0]*M,x[A++]=b+N[1]*M,x[A++]=R+N[2]*M,x[A++]=b+N[3]*M,p[g]=G.atlasIndex}),w.quads=(w.quads||0)+(rn()-S);const I=rn();w.sdf={};const j=u.height,H=Math.ceil(s.glyphCount/c),T=Math.pow(2,Math.ceil(Math.log2(H*i)));T>j&&(console.info(`Increasing SDF texture size ${j}->${T}`),cg(u,r,T),l.dispose()),Promise.all(C.map(U=>Ac(U,s,e.gpuAccelerateSDF).then(({timing:g})=>{w.sdf[U.atlasIndex]=g}))).then(()=>{C.length&&!s.contextLost&&(Tc(s),l.needsUpdate=!0),w.sdfTotal=rn()-I,w.total=rn()-o,t(Object.freeze({parameters:e,sdfTexture:l,sdfGlyphSize:i,sdfExponent:n,glyphBounds:x,glyphAtlasIndices:p,glyphColors:f.glyphColors,caretPositions:f.caretPositions,chunkedBounds:f.chunkedBounds,ascender:f.ascender,descender:f.descender,lineHeight:f.lineHeight,capHeight:f.capHeight,xHeight:f.xHeight,topBaseline:f.topBaseline,blockBounds:f.blockBounds,visibleBounds:f.visibleBounds,timings:f.timings}))})}),Promise.resolve().then(()=>{s.contextLost||sg(u)})}function Ac({path:e,atlasIndex:t,sdfViewBox:o},{sdfGlyphSize:a,sdfCanvas:r,contextLost:n},i){if(n)return Promise.resolve({timing:-1});const{textureWidth:c,sdfExponent:s}=Bn,l=Math.max(o[2]-o[0],o[3]-o[1]),u=Math.floor(t/4),d=u%(c/a)*a,f=Math.floor(u/(c/a))*a,p=t%4;return tg(a,a,e,o,l,s,r,d,f,p,i)}function ug(e){const t=e.sdfCanvas;t.addEventListener("webglcontextlost",o=>{console.log("Context Lost",o),o.preventDefault(),e.contextLost=!0}),t.addEventListener("webglcontextrestored",o=>{console.log("Context Restored",o),e.contextLost=!1;const a=[];e.glyphsByFont.forEach(r=>{r.forEach(n=>{a.push(Ac(n,e,!0))})}),Promise.all(a).then(()=>{Tc(e),e.sdfTexture.needsUpdate=!0})})}function dg({font:e,characters:t,sdfGlyphSize:o},a){let r=Array.isArray(t)?t.join(`
`):""+t;kc({font:e,sdfGlyphSize:o,text:r},a)}function fg(e,t){for(let o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}let br;function hg(e){return br||(br=typeof document>"u"?{}:document.createElement("a")),br.href=e,br.href}function Tc(e){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:t,sdfTexture:o}=e,{width:a,height:r}=t,n=e.sdfCanvas.getContext("webgl");let i=o.image.data;(!i||i.length!==a*r*4)&&(i=new Uint8Array(a*r*4),o.image={width:a,height:r,data:i},o.flipY=!1,o.isDataTexture=!0),n.readPixels(0,0,a,r,n.RGBA,n.UNSIGNED_BYTE,i)}}const pg=pn({name:"Typesetter",dependencies:[eg,Q0,L0],init(e,t,o){return e(t,o())}}),Mc=pn({name:"Typesetter",dependencies:[pg],init(e){return function(t){return new Promise(o=>{e.typeset(t,o)})}},getTransferables(e){const t=[];for(let o in e)e[o]&&e[o].buffer&&t.push(e[o].buffer);return t}});Mc.onMainThread;const Ba={};function gg(e){let t=Ba[e];return t||(t=Ba[e]=new Yo(1,1,e,e).translate(.5,.5,0)),t}const mg="aTroikaGlyphBounds",Ga="aTroikaGlyphIndex",yg="aTroikaGlyphColor";class vg extends Xc{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Yc,this.boundingBox=new $a}computeBoundingSphere(){}computeBoundingBox(){}set detail(t){if(t!==this._detail){this._detail=t,(typeof t!="number"||t<1)&&(t=1);let o=gg(t);["position","normal","uv"].forEach(a=>{this.attributes[a]=o.attributes[a].clone()}),this.setIndex(o.getIndex().clone())}}get detail(){return this._detail}set curveRadius(t){t!==this._curveRadius&&(this._curveRadius=t,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(t,o,a,r,n){this.updateAttributeData(mg,t,4),this.updateAttributeData(Ga,o,1),this.updateAttributeData(yg,n,3),this._blockBounds=a,this._chunkedBounds=r,this.instanceCount=o.length,this._updateBounds()}_updateBounds(){const t=this._blockBounds;if(t){const{curveRadius:o,boundingBox:a}=this;if(o){const{PI:r,floor:n,min:i,max:c,sin:s,cos:l}=Math,u=r/2,d=r*2,f=Math.abs(o),p=t[0]/f,y=t[2]/f,m=n((p+u)/d)!==n((y+u)/d)?-f:i(s(p)*f,s(y)*f),v=n((p-u)/d)!==n((y-u)/d)?f:c(s(p)*f,s(y)*f),_=n((p+r)/d)!==n((y+r)/d)?f*2:c(f-l(p)*f,f-l(y)*f);a.min.set(m,t[1],o<0?-_:0),a.max.set(v,t[3],o<0?0:_)}else a.min.set(t[0],t[1],0),a.max.set(t[2],t[3],0);a.getBoundingSphere(this.boundingSphere)}}applyClipRect(t){let o=this.getAttribute(Ga).count,a=this._chunkedBounds;if(a)for(let r=a.length;r--;){o=a[r].end;let n=a[r].rect;if(n[1]<t.w&&n[3]>t.y&&n[0]<t.z&&n[2]>t.x)break}this.instanceCount=o}updateAttributeData(t,o,a){const r=this.getAttribute(t);o?r&&r.array.length===o.length?(r.array.set(o),r.needsUpdate=!0):(this.setAttribute(t,new qc(o,a)),delete this._maxInstanceCount,this.dispose()):r&&this.deleteAttribute(t)}}const xg=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,_g=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,bg=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,wg=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Sg(e){const t=Vo(e,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Tr},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Ri(0,0,0,0)},uTroikaClipRect:{value:new Ri(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Tr},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new fn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Zc},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:xg,vertexTransform:_g,fragmentDefs:bg,fragmentColorTransform:wg,customRewriter({vertexShader:o,fragmentShader:a}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(a)&&(a=a.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(o)||(o=o.replace(Ec,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:o,fragmentShader:a}}});return t.transparent=!0,t.forceSinglePass=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),t}const pi=new Wc({color:16777215,side:Jc,transparent:!0}),Ha=8421504,Va=new $c,wr=new Xo,So=new Xo,jn=[],Cg=new Xo,Co="+x+y";function Wa(e){return Array.isArray(e)?e[0]:e}let Pc=()=>{const e=new $o(new Yo(1,1),pi);return Pc=()=>e,e},Dc=()=>{const e=new $o(new Yo(1,1,32,1),pi);return Dc=()=>e,e};const Eg={type:"syncstart"},Ng={type:"synccomplete"},Rc=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],kg=Rc.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Ic=class extends $o{constructor(){const t=new vg;super(t,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=Ha,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Co,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(t){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(t):(this._isSyncing=!0,this.dispatchEvent(Eg),kc({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},o=>{this._isSyncing=!1,this._textRenderInfo=o,this.geometry.updateGlyphs(o.glyphBounds,o.glyphAtlasIndices,o.blockBounds,o.chunkedBounds,o.glyphColors);const a=this._queuedSyncs;a&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{a.forEach(r=>r&&r())})),this.dispatchEvent(Ng),t&&t()})))}onBeforeRender(t,o,a,r,n,i){this.sync(),n.isTroikaTextMaterial&&this._prepareForRender(n)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(t){return Sg(t)}get material(){let t=this._derivedMaterial;const o=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=pi.clone());if((!t||!t.isDerivedFrom(o))&&(t=this._derivedMaterial=this.createDerivedMaterial(o),o.addEventListener("dispose",function a(){o.removeEventListener("dispose",a),t.dispose()})),this.hasOutline()){let a=t._outlineMtl;return a||(a=t._outlineMtl=Object.create(t,{id:{value:t.id+.1}}),a.isTextOutlineMaterial=!0,a.depthWrite=!1,a.map=null,t.addEventListener("dispose",function r(){t.removeEventListener("dispose",r),a.dispose()})),[a,t]}else return t}set material(t){t&&t.isTroikaTextMaterial?(this._derivedMaterial=t,this._baseMaterial=t.baseMaterial):this._baseMaterial=t}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(t){this.geometry.detail=t}get curveRadius(){return this.geometry.curveRadius}set curveRadius(t){this.geometry.curveRadius=t}get customDepthMaterial(){return Wa(this.material).getDepthMaterial()}set customDepthMaterial(t){}get customDistanceMaterial(){return Wa(this.material).getDistanceMaterial()}set customDistanceMaterial(t){}_prepareForRender(t){const o=t.isTextOutlineMaterial,a=t.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:c,blockBounds:s}=r;a.uTroikaSDFTexture.value=c,a.uTroikaSDFTextureSize.value.set(c.image.width,c.image.height),a.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,a.uTroikaSDFExponent.value=r.sdfExponent,a.uTroikaTotalBounds.value.fromArray(s),a.uTroikaUseGlyphColors.value=!o&&!!r.glyphColors;let l=0,u=0,d=0,f,p,y,m=0,v=0;if(o){let{outlineWidth:w,outlineOffsetX:C,outlineOffsetY:x,outlineBlur:A,outlineOpacity:D}=this;l=this._parsePercent(w)||0,u=Math.max(0,this._parsePercent(A)||0),f=D,m=this._parsePercent(C)||0,v=this._parsePercent(x)||0}else d=Math.max(0,this._parsePercent(this.strokeWidth)||0),d&&(y=this.strokeColor,a.uTroikaStrokeColor.value.set(y??Ha),p=this.strokeOpacity,p==null&&(p=1)),f=this.fillOpacity;a.uTroikaEdgeOffset.value=l,a.uTroikaPositionOffset.value.set(m,v),a.uTroikaBlurRadius.value=u,a.uTroikaStrokeWidth.value=d,a.uTroikaStrokeOpacity.value=p,a.uTroikaFillOpacity.value=f??1,a.uTroikaCurveRadius.value=this.curveRadius||0;let _=this.clipRect;if(_&&Array.isArray(_)&&_.length===4)a.uTroikaClipRect.value.fromArray(_);else{const w=(this.fontSize||.1)*100;a.uTroikaClipRect.value.set(s[0]-w,s[1]-w,s[2]+w,s[3]+w)}this.geometry.applyClipRect(a.uTroikaClipRect.value)}a.uTroikaSDFDebug.value=!!this.debugSDF,t.polygonOffset=!!this.depthOffset,t.polygonOffsetFactor=t.polygonOffsetUnits=this.depthOffset||0;const n=o?this.outlineColor||0:this.color;if(n==null)delete t.color;else{const c=t.hasOwnProperty("color")?t.color:t.color=new fn;(n!==c._input||typeof n=="object")&&c.set(c._input=n)}let i=this.orientation||Co;if(i!==t._orientation){let c=a.uTroikaOrient.value;i=i.replace(/[^-+xyz]/g,"");let s=i!==Co&&i.match(/^([-+])([xyz])([-+])([xyz])$/);if(s){let[,l,u,d,f]=s;wr.set(0,0,0)[u]=l==="-"?1:-1,So.set(0,0,0)[f]=d==="-"?-1:1,Va.lookAt(Cg,wr.cross(So),So),c.setFromMatrix4(Va)}else c.identity();t._orientation=i}}_parsePercent(t){if(typeof t=="string"){let o=t.match(/^(-?[\d.]+)%$/),a=o?parseFloat(o[1]):NaN;t=(isNaN(a)?0:a/100)*this.fontSize}return t}localPositionToTextCoords(t,o=new Tr){o.copy(t);const a=this.curveRadius;return a&&(o.x=Math.atan2(t.x,Math.abs(a)-Math.abs(t.z))*Math.abs(a)),o}worldPositionToTextCoords(t,o=new Tr){return wr.copy(t),this.localPositionToTextCoords(this.worldToLocal(wr),o)}raycast(t,o){const{textRenderInfo:a,curveRadius:r}=this;if(a){const n=a.blockBounds,i=r?Dc():Pc(),c=i.geometry,{position:s,uv:l}=c.attributes;for(let u=0;u<l.count;u++){let d=n[0]+l.getX(u)*(n[2]-n[0]);const f=n[1]+l.getY(u)*(n[3]-n[1]);let p=0;r&&(p=r-Math.cos(d/r)*r,d=Math.sin(d/r)*r),s.setXYZ(u,d,f,p)}c.boundingSphere=this.geometry.boundingSphere,c.boundingBox=this.geometry.boundingBox,i.matrixWorld=this.matrixWorld,i.material.side=this.material.side,jn.length=0,i.raycast(t,jn);for(let u=0;u<jn.length;u++)jn[u].object=this,o.push(jn[u])}}copy(t){const o=this.geometry;return super.copy(t),this.geometry=o,kg.forEach(a=>{this[a]=t[a]}),this}clone(){return new this.constructor().copy(this)}};Rc.forEach(e=>{const t="_private_"+e;Object.defineProperty(Ic.prototype,e,{get(){return this[t]},set(o){o!==this[t]&&(this[t]=o,this._needsSync=!0)}})});new $a;new fn;const Ag=F.forwardRef(({sdfGlyphSize:e=64,anchorX:t="center",anchorY:o="middle",font:a,fontSize:r=1,children:n,characters:i,onSync:c,...s},l)=>{const u=Qc(({invalidate:y})=>y),[d]=F.useState(()=>new Ic),[f,p]=F.useMemo(()=>{const y=[];let m="";return F.Children.forEach(n,v=>{typeof v=="string"||typeof v=="number"?m+=v:y.push(v)}),[y,m]},[n]);return D0(()=>new Promise(y=>dg({font:a,characters:i},y)),["troika-text",a,i]),F.useLayoutEffect(()=>void d.sync(()=>{u(),c&&c(d)})),F.useEffect(()=>()=>d.dispose(),[d]),F.createElement("primitive",el({object:d,ref:l,font:a,text:p,anchorX:t,anchorY:o,fontSize:r,sdfGlyphSize:e},s),f)});function Tg({data:e,onHover:t}){const o=F.useRef(),a=F.useMemo(()=>{if(!e||e.length===0)return{pos:new Float32Array(0),col:new Float32Array(0)};const r=new Float32Array(e.length*3),n=new Float32Array(e.length*3),i={coding:"#00f3ff",creative:"#7000ff",analysis:"#00ff9d",chat:"#ff0055"};return e.forEach((c,s)=>{const[l,u,d]=c.embedding||[0,0,0];r[s*3]=l,r[s*3+1]=u,r[s*3+2]=d;const f=new fn(i[c.category]||"#ffffff");n[s*3]=f.r,n[s*3+1]=f.g,n[s*3+2]=f.b}),{pos:r,col:n}},[e]);return Xa(()=>{o.current&&(o.current.rotation.y+=.002)}),h.jsxs("points",{ref:o,onPointerOver:r=>{r.stopPropagation();const n=r.index;n!==void 0&&e[n]&&t(e[n])},onPointerOut:()=>t(null),children:[h.jsxs("bufferGeometry",{children:[h.jsx("bufferAttribute",{attach:"attributes-position",count:a.pos.length/3,array:a.pos,itemSize:3}),h.jsx("bufferAttribute",{attach:"attributes-color",count:a.col.length/3,array:a.col,itemSize:3})]}),h.jsx("pointsMaterial",{size:.8,vertexColors:!0,transparent:!0,opacity:1,sizeAttenuation:!0,blending:Ya,depthWrite:!1})]})}function Mg({count:e=5e3}){const t=F.useRef(),o=F.useMemo(()=>{const r=[],n=[{color:"#00f3ff",x:12,y:4,z:2},{color:"#7000ff",x:-12,y:-4,z:6},{color:"#00ff9d",x:4,y:-12,z:-6},{color:"#ff0055",x:-6,y:12,z:1}];for(let i=0;i<e;i++){const c=n[Math.floor(Math.random()*n.length)],s=6,l=c.x+(Math.random()-.5)*s*2,u=c.y+(Math.random()-.5)*s*2,d=c.z+(Math.random()-.5)*s*2;r.push({x:l,y:u,z:d,color:c.color})}return r},[e]),a=F.useMemo(()=>{const r=new Float32Array(e*3),n=new Float32Array(e*3);return o.forEach((i,c)=>{r[c*3]=i.x,r[c*3+1]=i.y,r[c*3+2]=i.z;const s=new fn(i.color);n[c*3]=s.r*.4,n[c*3+1]=s.g*.4,n[c*3+2]=s.b*.4}),{pos:r,col:n}},[o,e]);return Xa(()=>{t.current&&(t.current.rotation.y+=5e-4)}),h.jsxs("points",{ref:t,children:[h.jsxs("bufferGeometry",{children:[h.jsx("bufferAttribute",{attach:"attributes-position",count:a.pos.length/3,array:a.pos,itemSize:3}),h.jsx("bufferAttribute",{attach:"attributes-color",count:a.col.length/3,array:a.col,itemSize:3})]}),h.jsx("pointsMaterial",{size:.2,vertexColors:!0,transparent:!0,opacity:.4,sizeAttenuation:!0,blending:Ya,depthWrite:!1})]})}function Pg(){const e=[{position:[12,4,2],label:"Coding",color:"#00f3ff"},{position:[-12,-4,6],label:"Creative",color:"#7000ff"},{position:[4,-12,-6],label:"Analysis",color:"#00ff9d"},{position:[-6,12,1],label:"Chat",color:"#ff0055"}];return h.jsx("group",{children:e.map((t,o)=>h.jsx(Ag,{position:t.position,fontSize:1.2,color:t.color,anchorX:"center",anchorY:"middle",outlineWidth:.05,outlineColor:"#000000",children:t.label},o))})}function Dg(){const[e,t]=F.useState([]),[o,a]=F.useState(null);return F.useEffect(()=>{Bo.loadDataset().then(t)},[]),h.jsxs("div",{style:{width:"100%",height:"100%",background:"#030508"},children:[h.jsxs(tl,{camera:{position:[0,0,35],fov:60},children:[h.jsx("color",{attach:"background",args:["#030508"]}),h.jsx("fog",{attach:"fog",args:["#030508",20,80]}),h.jsx("ambientLight",{intensity:.5}),h.jsx("pointLight",{position:[10,10,10]}),h.jsx(nl,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0,speed:1}),h.jsx(Mg,{count:8e3}),e.length>0&&h.jsx(Tg,{data:e,onHover:a}),h.jsx(Pg,{}),h.jsx(rl,{enablePan:!0,enableZoom:!0,enableRotate:!0,autoRotate:!0,autoRotateSpeed:.5})]}),h.jsxs("div",{style:{position:"absolute",bottom:"20px",left:"20px",color:"rgba(0, 243, 255, 0.8)",fontFamily:"Rajdhani, sans-serif",pointerEvents:"none",zIndex:10},children:[h.jsx("h3",{style:{margin:0,fontSize:"1.2rem",textTransform:"uppercase"},children:"Semantic Space"}),h.jsxs("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:[e.length," Active Nodes  8,000+ Historical Vectors"]})]}),o&&h.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",background:"rgba(6, 11, 20, 0.9)",border:`1px solid ${o.category==="coding"?"#00f3ff":"#ffffff"}`,padding:"15px",borderRadius:"8px",maxWidth:"300px",color:"#fff",fontFamily:"Rajdhani, sans-serif",zIndex:20,backdropFilter:"blur(10px)",boxShadow:"0 0 20px rgba(0,0,0,0.5)"},children:[h.jsxs("div",{style:{fontSize:"0.8rem",textTransform:"uppercase",color:"#888",marginBottom:"5px"},children:[o.category,"  ",o.tokens," tokens"]}),h.jsxs("div",{style:{fontSize:"1rem"},children:['"',o.text,'"']})]})]})}function Rg(e,t){const[o,a]=F.useState({}),r=F.useRef(),n=.05,i=1,c=2.5,s=F.useCallback(()=>{a(l=>{const u={...l},d=Date.now();return e.filter(p=>p.type==="input"||p.type==="source").forEach(p=>{Math.random()<n&&t.filter(m=>m.source===p.id).forEach(m=>{u[m.id]||(u[m.id]=[]),u[m.id].push({id:`pkt-${d}-${Math.random()}`,type:"request",startTime:d,speed:c,progress:0})})}),Object.keys(u).forEach(p=>{const y=t.find(_=>_.id===p);if(!y){delete u[p];return}const m=u[p]||[],v=[];m.forEach(_=>{if((d-_.startTime)/1e3/_.speed>=1){const x=e.find(A=>A.id===y.target);if(x){let A=_.type,D=_.speed;if(x.type.startsWith("cache_")){const P=Math.random()>.3;A=P?"hit":"miss",D=P?i:c}t.filter(P=>P.source===x.id).forEach(P=>{u[P.id]||(u[P.id]=[]),u[P.id].push({id:`pkt-${d}-${Math.random()}`,type:A,startTime:d,speed:D,progress:0})})}}else v.push(_)}),u[p]=v}),u}),r.current=requestAnimationFrame(s)},[e,t]);return F.useEffect(()=>(r.current=requestAnimationFrame(s),()=>cancelAnimationFrame(r.current)),[s]),o}const Ig={traffic:A0};function Ug(){const{sector:e,config:t,selectSector:o,showSectorModal:a,setShowSectorModal:r}=hi(),[n,i,c]=Tp([]),[s,l,u]=Mp([]),[d,f]=F.useState("dashboard"),[p,y]=F.useState(!1),[m,v]=F.useState(!1),[_,w]=F.useState(null),[C,x]=F.useState("Untitled Pipeline"),A=Rg(n,s);F.useEffect(()=>{l(g=>g.map(k=>({...k,type:"traffic",data:{...k.data,packets:A[k.id]||[]}})))},[A,l]),console.log("App render:",{sector:e,config:t,showSectorModal:a}),F.useEffect(()=>{C0()},[]);const D=F.useCallback(g=>l(k=>Is(g,k)),[l]),S=F.useCallback((g,k)=>{w(k)},[]),P=F.useCallback(g=>{const k=g.nodes.map((B,G)=>({id:`${B.type}-${G}`,type:B.type,position:{x:100+G*250,y:200},data:{label:B.type.replace("_"," ").toUpperCase(),config:B.config,metrics:{hitRate:0,latency:0,savings:0}}})),E=[];for(let B=0;B<k.length-1;B++)E.push({id:`e${B}`,source:k[B].id,target:k[B+1].id,animated:!0,style:{stroke:"#10b981"}});i(k),l(E),x(g.name||"Generated Pipeline"),y(!1)},[i,l]),I=F.useCallback(g=>{i(g.nodes),l(g.edges),x(g.name),v(!1),f("builder")},[i,l]);F.useCallback(g=>{i(g.nodes),l(g.edges),x(g.name),f("builder")},[i,l]);const j=F.useCallback(()=>{i([]),l([]),x("Untitled Pipeline"),f("builder")},[i,l]),H=F.useCallback(()=>{if(!C||C.trim()===""){alert("Please enter a pipeline name");return}if(n.length===0){alert("Pipeline must have at least one node");return}const g={name:C.trim(),sector:e,nodes:n,edges:s};try{const k=Pa.savePipeline(g);if(!k.success){k.error==="quota"?alert(`Storage quota exceeded: ${k.message}

Consider deleting old pipelines or upgrading your plan.`):k.error==="validation"?alert(`Validation error: ${k.message}

Field: ${k.field||"unknown"}`):alert(`Failed to save pipeline: ${k.message}`);return}const E=zn.getStorageStats(),B=E.percentUsed.toFixed(1),G=k.isNew?`Pipeline "${C}" saved!`:`Pipeline "${C}" updated!`;E.percentUsed>80?alert(`${G}

 Storage warning: ${B}% used. Consider deleting old pipelines.`):alert(G)}catch(k){console.error("Failed to save pipeline:",k),alert(`Error saving pipeline: ${k.message}`)}},[C,e,n,s]),T=F.useCallback(g=>{g.preventDefault(),g.dataTransfer.dropEffect="move"},[]),U=F.useCallback(g=>{g.preventDefault();const k=g.dataTransfer.getData("application/reactflow"),E={x:g.clientX-250,y:g.clientY-100},B={id:`${k}-${Date.now()}`,type:k,position:E,data:{label:k.replace("_"," ").toUpperCase(),config:{},metrics:{hitRate:0,latency:0,savings:0}}};i(G=>G.concat(B))},[i]);if(a)return h.jsx("div",{className:"app",children:h.jsx(a0,{onComplete:o,onSkip:o})});if(!e||!t)return h.jsx("div",{style:{padding:"20px",color:"white"},children:"Loading sector config..."});if(d==="dashboard"){const g=Pa.loadAllPipelines();return h.jsxs("div",{className:"app",children:[h.jsx(d0,{onOpenWizard:()=>y(!0),onNewPipeline:j,pipelines:g}),p&&h.jsx(Sa,{sector:e,config:t,onClose:()=>y(!1),onComplete:k=>{P(k),f("builder")}})]})}return d==="galaxy"?h.jsxs("div",{className:"app",children:[h.jsxs("header",{className:"header",style:{position:"absolute",top:0,left:0,right:0,zIndex:10,background:"transparent",border:"none"},children:[h.jsxs("div",{className:"header-left",children:[h.jsx("button",{className:"btn btn-icon",onClick:()=>f("dashboard"),title:"Back to Dashboard",style:{background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)"},children:" "}),h.jsx("div",{children:h.jsx("h1",{style:{textShadow:"0 0 10px rgba(0,243,255,0.5)"},children:"Neural Galaxy"})})]}),h.jsx("div",{className:"header-right",children:h.jsx("button",{className:"btn btn-secondary",onClick:()=>f("builder"),style:{background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)"},children:"Switch to Builder"})})]}),h.jsx(Dg,{})]}):h.jsxs("div",{className:"app",children:[h.jsxs("header",{className:"header",children:[h.jsxs("div",{className:"header-left",children:[h.jsx("button",{className:"btn btn-icon",onClick:()=>f("dashboard"),title:"Back to Dashboard",children:" "}),h.jsxs("div",{children:[h.jsx("h1",{children:"AgentCache Studio"}),h.jsxs("span",{className:"subtitle",children:["Visual Pipeline Builder  ",e.charAt(0).toUpperCase()+e.slice(1)]})]})]}),h.jsx("div",{className:"header-center",children:h.jsx("input",{type:"text",className:"pipeline-name-input",value:C,onChange:g=>x(g.target.value),placeholder:"Pipeline name..."})}),h.jsxs("div",{className:"header-right",children:[h.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!0),children:" Load Preset"}),h.jsx("button",{className:"btn btn-secondary",onClick:()=>y(!0),children:" AI Wizard"}),h.jsx("button",{className:"btn btn-success",onClick:H,children:" Save"}),h.jsx("button",{className:"btn btn-primary",children:" Deploy"}),h.jsx("button",{className:"btn btn-secondary",onClick:()=>f("galaxy"),children:" Galaxy View"})]})]}),h.jsxs("div",{className:"main-content",children:[h.jsx(n0,{sector:e,config:t}),h.jsx("div",{className:"canvas-container",children:h.jsxs(gc,{nodes:n,edges:s,onNodesChange:c,onEdgesChange:u,onConnect:D,onNodeClick:S,onDrop:U,onDragOver:T,nodeTypes:b0,edgeTypes:Ig,fitView:!0,children:[h.jsx(Xp,{}),h.jsx(zp,{nodeColor:g=>{switch(g.type){case"input":return"#3b82f6";case"cache_l1":case"cache_l2":case"cache_l3":return"#10b981";case"openai":case"anthropic":case"gemini":return"#8b5cf6";default:return"#6366f1"}},style:{background:"#1e293b"}}),h.jsx(Qp,{color:"#334155",gap:16})]})}),h.jsx(s0,{selectedNode:_})]}),p&&h.jsx(Sa,{sector:e,config:t,onClose:()=>y(!1),onComplete:P}),m&&h.jsx(u0,{onLoadPreset:I,onClose:()=>v(!1)})]})}ol.createRoot(document.getElementById("root")).render(h.jsx(X.StrictMode,{children:h.jsx(c0,{children:h.jsx(Ug,{})})}));
